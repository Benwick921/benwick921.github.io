<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <atom:link href="https://benwick921.github.io/feed.xml" rel="self" type="application/rss+xml" />
    <title>Your Site Name</title>
    <link>https://benwick921.github.io</link>
    <description>Latest content from Your Site Name</description>
    <language>en-us</language>
    <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate>
    <author>
      <name>Benwick</name>
    </author>

    
      <item>
        <title>404</title>
        <link href="https://benwick921.github.io/404" rel="alternate" type="text/html" title="404"/>
        <guid>https://benwick921.github.io/404</guid>
        <pubDate>Wed, 26 Feb 2025 18:40:55 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>cybersecurity-in-the-sea</title>
        <link href="https://benwick921.github.io/cyber/blog/cybersecurity-in-the-sea" rel="alternate" type="text/html" title="cybersecurity-in-the-sea"/>
        <guid>https://benwick921.github.io/cyber/blog/cybersecurity-in-the-sea</guid>
        <pubDate>Sun, 02 Mar 2025 11:53:59 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>i-hacked-my-wifi</title>
        <link href="https://benwick921.github.io/cyber/blog/i-hacked-my-wifi" rel="alternate" type="text/html" title="i-hacked-my-wifi"/>
        <guid>https://benwick921.github.io/cyber/blog/i-hacked-my-wifi</guid>
        <pubDate>Sun, 02 Mar 2025 12:02:57 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>malware-thesis</title>
        <link href="https://benwick921.github.io/cyber/blog/malware-thesis" rel="alternate" type="text/html" title="malware-thesis"/>
        <guid>https://benwick921.github.io/cyber/blog/malware-thesis</guid>
        <pubDate>Sun, 02 Mar 2025 12:24:46 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>manual-unpacking-upx-and-mpress</title>
        <link href="https://benwick921.github.io/cyber/blog/manual-unpacking-upx-and-mpress" rel="alternate" type="text/html" title="manual-unpacking-upx-and-mpress"/>
        <guid>https://benwick921.github.io/cyber/blog/manual-unpacking-upx-and-mpress</guid>
        <pubDate>Sun, 02 Mar 2025 12:28:01 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>blog</title>
        <link href="https://benwick921.github.io/cyber/blog" rel="alternate" type="text/html" title="blog"/>
        <guid>https://benwick921.github.io/cyber/blog</guid>
        <pubDate>Sun, 02 Mar 2025 11:50:32 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>run-and-debug-dll</title>
        <link href="https://benwick921.github.io/cyber/blog/run-and-debug-dll" rel="alternate" type="text/html" title="run-and-debug-dll"/>
        <guid>https://benwick921.github.io/cyber/blog/run-and-debug-dll</guid>
        <pubDate>Sun, 02 Mar 2025 12:28:41 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>vb-password-bypass</title>
        <link href="https://benwick921.github.io/cyber/blog/vb-password-bypass" rel="alternate" type="text/html" title="vb-password-bypass"/>
        <guid>https://benwick921.github.io/cyber/blog/vb-password-bypass</guid>
        <pubDate>Sun, 02 Mar 2025 12:30:55 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>tags</title>
        <link href="https://benwick921.github.io/cyber/tags" rel="alternate" type="text/html" title="tags"/>
        <guid>https://benwick921.github.io/cyber/tags</guid>
        <pubDate>Tue, 04 Mar 2025 12:53:28 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>archetype</title>
        <link href="https://benwick921.github.io/cyber/writeup/archetype" rel="alternate" type="text/html" title="archetype"/>
        <guid>https://benwick921.github.io/cyber/writeup/archetype</guid>
        <pubDate>Thu, 27 Feb 2025 15:23:27 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>buff</title>
        <link href="https://benwick921.github.io/cyber/writeup/buff" rel="alternate" type="text/html" title="buff"/>
        <guid>https://benwick921.github.io/cyber/writeup/buff</guid>
        <pubDate>Thu, 27 Feb 2025 15:40:02 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>cyber-lens</title>
        <link href="https://benwick921.github.io/cyber/writeup/cyber-lens" rel="alternate" type="text/html" title="cyber-lens"/>
        <guid>https://benwick921.github.io/cyber/writeup/cyber-lens</guid>
        <pubDate>Thu, 27 Feb 2025 15:37:37 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>ignite</title>
        <link href="https://benwick921.github.io/cyber/writeup/ignite" rel="alternate" type="text/html" title="ignite"/>
        <guid>https://benwick921.github.io/cyber/writeup/ignite</guid>
        <pubDate>Thu, 27 Feb 2025 15:36:18 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>lightroom</title>
        <link href="https://benwick921.github.io/cyber/writeup/lightroom" rel="alternate" type="text/html" title="lightroom"/>
        <guid>https://benwick921.github.io/cyber/writeup/lightroom</guid>
        <pubDate>Fri, 28 Feb 2025 22:33:54 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>lookup</title>
        <link href="https://benwick921.github.io/cyber/writeup/lookup" rel="alternate" type="text/html" title="lookup"/>
        <guid>https://benwick921.github.io/cyber/writeup/lookup</guid>
        <pubDate>Fri, 28 Feb 2025 22:34:22 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>writeup</title>
        <link href="https://benwick921.github.io/cyber/writeup" rel="alternate" type="text/html" title="writeup"/>
        <guid>https://benwick921.github.io/cyber/writeup</guid>
        <pubDate>Wed, 26 Feb 2025 18:24:02 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>pickle-rick</title>
        <link href="https://benwick921.github.io/cyber/writeup/pickle-rick" rel="alternate" type="text/html" title="pickle-rick"/>
        <guid>https://benwick921.github.io/cyber/writeup/pickle-rick</guid>
        <pubDate>Thu, 27 Feb 2025 15:37:39 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>thompson</title>
        <link href="https://benwick921.github.io/cyber/writeup/thompson" rel="alternate" type="text/html" title="thompson"/>
        <guid>https://benwick921.github.io/cyber/writeup/thompson</guid>
        <pubDate>Thu, 27 Feb 2025 15:38:24 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>threat-hunting-with-yara</title>
        <link href="https://benwick921.github.io/cyber/writeup/threat-hunting-with-yara" rel="alternate" type="text/html" title="threat-hunting-with-yara"/>
        <guid>https://benwick921.github.io/cyber/writeup/threat-hunting-with-yara</guid>
        <pubDate>Thu, 27 Feb 2025 15:37:40 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>tomcat</title>
        <link href="https://benwick921.github.io/cyber/writeup/tomcat" rel="alternate" type="text/html" title="tomcat"/>
        <guid>https://benwick921.github.io/cyber/writeup/tomcat</guid>
        <pubDate>Thu, 27 Feb 2025 15:37:41 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>tomghost</title>
        <link href="https://benwick921.github.io/cyber/writeup/tomghost" rel="alternate" type="text/html" title="tomghost"/>
        <guid>https://benwick921.github.io/cyber/writeup/tomghost</guid>
        <pubDate>Fri, 28 Feb 2025 22:39:45 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title>uni-ctf</title>
        <link href="https://benwick921.github.io/cyber/writeup/uni-ctf" rel="alternate" type="text/html" title="uni-ctf"/>
        <guid>https://benwick921.github.io/cyber/writeup/uni-ctf</guid>
        <pubDate>Thu, 27 Feb 2025 15:37:31 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
      <item>
        <title></title>
        <link href="https://benwick921.github.io" rel="alternate" type="text/html" title=""/>
        <guid>https://benwick921.github.io</guid>
        <pubDate>Fri, 07 Mar 2025 01:27:23 GMT</pubDate>
        <lastBuildDate>Mon, 10 Mar 2025 14:33:02 GMT</lastBuildDate> 
        <content type="html" xml:base="function toUTCString() { [native code] }">&lt;img src=&quot;/cyber/writeup/unictf/banner.webp&quot; alt=&quot;&quot;&gt;&lt;hr&gt;&lt;p&gt;This was my university CTF during my Masters&apos; degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.&lt;/p&gt;&lt;p&gt;This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL of the first level was given as the starting point:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.&lt;/p&gt;&lt;p&gt;Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image18.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we expected we received an error:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image28.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then, we tried to dig further inspecting the web page&amp;rsquo;s source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image63.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We observed  in the form above that on clicking Submit we actually call a function named &lt;em&gt;verify&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So, we started looking for a function called verify in the Console section (right click - inspect element).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image43.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image64.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;I was in plaintext in the &lt;code&gt;if&lt;/code&gt; condition highlighted in red, the password and the username needed in order to access the web page.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image86.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Once solved the Level 1, the URL of the second level was found:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This was how the Level 2 looked like:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image67.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this level there was only the possibility to insert a password, there was no username. So, let&amp;rsquo;s try to insert a random password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image72.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image70.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the &lt;code&gt;if&lt;/code&gt; condition.&lt;/p&gt;&lt;p&gt;After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &amp;ldquo;kitten.jpg&amp;rdquo; and the other one was a picture with a hidden parameter &amp;ldquo;srct.png&amp;rdquo;.&lt;/p&gt;&lt;p&gt;Putting the cursor on top of the reference &lt;em&gt;scrt.png&lt;/em&gt; a window popped up with a text.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image77.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The text on the picture was the right password to insert in order to solve the level.&lt;/p&gt;&lt;hr&gt;&lt;p&gt;As usual, in the previous level, we found the link to access the next one:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. &lt;em&gt;admin:admin&lt;/em&gt;).&lt;/p&gt;&lt;p&gt;As we expected, we received the following error message:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image73.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we analyzed the source code once again.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image75.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In the source code, we found a hidden parameter with a “False” value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image78.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image80.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL for the Level 4:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image82.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;This level consisted of verifying our browser in order to have access.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image84.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Only connections from &lt;em&gt;Kevin Browser Rocks&lt;/em&gt; were accepted.&lt;/p&gt;&lt;p&gt;What we had to do was to pretend to be using the browser “Kevin Browser Rocks” by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image87.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see we modified our browser &lt;code&gt;user-agent&lt;/code&gt; to &lt;em&gt;Kevin Browser Rocks&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image89.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;By applying this new change, we could finally get the URL to access the new level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image90.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;This was the URL obtained to access the fifth level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image47.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to analyze the source code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image49.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;“Never show secret.txt to the users”&lt;/em&gt;, this caught our attention so we searched for the file called: &lt;em&gt;secret.txt&lt;/em&gt;, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added &lt;em&gt;secret.txt&lt;/em&gt; to the urr to the URL in order to find it.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image51.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point, we needed to find the secret at &lt;em&gt;cgi-bin/getsecret.js&lt;/em&gt; and referred to ourselves as &lt;em&gt;di.uniroma1.it/supersecurepage&lt;/em&gt;, which could be done with the Firefox extension as done in the previous levels.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image53.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having done this, we were able to find the URL to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image55.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL for the level 6 obtained by solving the level 5:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image57.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image59.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field &lt;em&gt;uid&lt;/em&gt; exposed &lt;em&gt;userinfo.php?uid=0&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image60.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The field was set to 0 which was our current user’s ID, so we tried to change it with 1 and we were sent to another web page, Angelo&apos;s web page. Then we started to change the value of uid until we found the user with the secret at &lt;em&gt;uid=6&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image61.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL found by solving level 6:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55215/shieduekecometha/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image62.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As stated in the picture, in order to log in we need an e-mail and the username.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image24.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character &lt;em&gt;@&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image26.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We could try to insert any kind of random email for instance &lt;em&gt;admin@admin&lt;/em&gt; or even &lt;em&gt;teacher@something&lt;/em&gt; but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher’s email address.&lt;/p&gt;&lt;p&gt;Our first attempt was to try with course main teacher&amp;rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&amp;rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image29.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image31.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;Let’s start with the URL obtained from the previous levels:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image33.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Our first attempt was as usual the standard combination of &lt;em&gt;admin:admin&lt;/em&gt; as username and password.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And we noticed a code in the URL which should be the ID of the current user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image37.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string &lt;em&gt;admin&lt;/em&gt; and the string &lt;em&gt;nqzva&lt;/em&gt; had the same length, so we started to match the characters from the first string with the ones from the other string hence &lt;em&gt;a=n&lt;/em&gt;, &lt;em&gt;d=q&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string &lt;em&gt;admin&lt;/em&gt; and the result string was &lt;em&gt;nqzva&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;After many random tries, our attention was captured by the sentence &lt;em&gt;“Page created by MessyAdmin”&lt;/em&gt; present on the first page of the level.&lt;/p&gt;&lt;p&gt;So, we decide to ROT13 the string &lt;em&gt;messyadmin&lt;/em&gt; which resulted in &lt;em&gt;zrfflnqzva&lt;/em&gt; which has been copied and pasted to the URL instead of &lt;em&gt;nqzva&lt;/em&gt; and we ended up with the MessyAdmin’s page where we found the link to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image38.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image39.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;URL obtained from the 8th level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image40.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we do was to try the &lt;em&gt;admin@admin:admin&lt;/em&gt; username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said &lt;em&gt;“Never show the sessions.txt file”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we proceede to change the URL trying to open the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image4.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.&lt;/p&gt;&lt;p&gt;While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image6.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once in the page, we check if we received the cookie.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image8.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We notice that the value of this cookie was different from the value found in the &lt;em&gt;sessions.txt&lt;/em&gt; file.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image10.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So, we proceede to change it, and our new cookie was:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image12.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After reloading the page, we end up in the administrator’s page and logged as him, where we could find the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image14.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The link obtained from level 9:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image15.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usual, we tried the same combination (admin:admin) without any success.&lt;/p&gt;&lt;p&gt;Then we tried many random combinations of usernames and passwords, for instance, we used some teachers’ usernames just in case we could get it correct, but it failed every time.&lt;/p&gt;&lt;p&gt;The last attempt was to analyse the source code of the web page where we found the following script:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image16.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Inside the script, there was a variable called &lt;em&gt;password_hashes&lt;/em&gt; which contained the correspondent encrypted password for each user.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image17.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool &lt;em&gt;haskiller.co.uk&lt;/em&gt; (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.&lt;/p&gt;&lt;p&gt;In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image66.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Obviously, we took the hash of the user &lt;em&gt;admin&lt;/em&gt; and try to log in with the new credential &lt;em&gt;admin:qwertyuiop&lt;/em&gt; and we succeeded in proceeding to the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image68.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;But it did not end here because after decrypting the hash we notice that the function &lt;em&gt;checkPassword&lt;/em&gt; does not decrypt the user input in order to access the admin page.&lt;/p&gt;&lt;p&gt;So, we tried to reverse the function to understand its logic.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image69.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The function follows these steps:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Retrieve the values from the form and hash the given password.&lt;/li&gt;&lt;li&gt;It checks if the given user as input in the login form was in the dictionary “password_hashes”, if not it gives an error.&lt;/li&gt;&lt;li&gt;If the user exists, it checks the computed hash with the stored hash, if they don’t match it gives an error.&lt;/li&gt;&lt;li&gt;If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;We followed the script steps in order to solve the level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image71.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In fact, we can access the right page by adding &lt;em&gt;62aa4dcf.html&lt;/em&gt; as the script was doing.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image74.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;We started from the following URL:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image76.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first attempt was to use a few commonly used numbers such as &lt;em&gt;0000&lt;/em&gt;, &lt;em&gt;12345&lt;/em&gt;, &lt;em&gt;1337&lt;/em&gt; but without any success.&lt;/p&gt;&lt;p&gt;As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called &lt;em&gt;checkPassword&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image79.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As we can see the &lt;code&gt;if&lt;/code&gt; statement checks if the number was between 1 and 1000000 excluded, if it was &lt;em&gt;NaN&lt;/em&gt; (empty form) and if it hah at least six digits.&lt;/p&gt;&lt;p&gt;So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt &lt;em&gt;localsalt&lt;/em&gt; and checks if the result hashing was equal to &lt;em&gt;4d1ea4c067daa4dec768540bbcfe80b2&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: &lt;em&gt;“4d1ea4c067daa4dec768540bbcfe80b2”&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;In order to do it we wrote a Python script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image81.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And this was the result produced by the script.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image83.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As expected, the code worked fine.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image85.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The URL obtained from level 11:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55528/ithochexephizoof&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image65.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image44.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Here, we can see that the script creates a new link concatenating two strings to complete the URL.&lt;/p&gt;&lt;p&gt;These strings were: &lt;em&gt;“cgi-bin/users.php”&lt;/em&gt; and &lt;em&gt;“?filter=”&lt;/em&gt;, after which a value was concatenated, but we didn&amp;rsquo;t know which kind of value could follow the string.&lt;/p&gt;&lt;p&gt;We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image45.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).&lt;/p&gt;&lt;p&gt;Then we noticed what the home page was prompting: &lt;em&gt;daemon&lt;/em&gt;, &lt;em&gt;root&lt;/em&gt;, and &lt;em&gt;mysql&lt;/em&gt;, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image46.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once find the files in the directory we could try to open &lt;em&gt;secretusers.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;And the file contain the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image48.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image50.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image52.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function “getenv”.&lt;/p&gt;&lt;p&gt;In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image54.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image56.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The response was &lt;i&gt;“no variable found”&lt;/i&gt; and also when we put an input it prints a &lt;i&gt;“TESTENV”&lt;/i&gt; which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image58.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The first thing we found was something called “Shellshock”. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.&lt;/p&gt;&lt;p&gt;The string was: &lt;code&gt;() { :;}; echo “NS:” $(&amp;lt;/etc/passwd)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Digging more into the topic we found a &lt;a href=&quot;https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf&quot;&gt;PDF&lt;/a&gt; where the shellshock vulnerability was explained alongside its syntax.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image41.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;So again, we tried to remake the right link appending &lt;em&gt;cgi-bin/env.php?filter=&lt;/em&gt; and tried to copy and paste the string suggested but for some reason, no one of the strings were working.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image42.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;During the laboratory lessons, we were suggested by the teacher to use &lt;strong&gt;Burp&lt;/strong&gt; so we tried again with it.&lt;/p&gt;&lt;p&gt;The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image22.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with &lt;em&gt;+&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;So we encoded the “:” and “;” with “%3a” and “%3b” following the guide in this link, and our resulting payload was &lt;code&gt;()+{+%3a%3b}+/bin/ls&lt;/code&gt; but still did not work for some reason.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image23.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Then we remembered, after a lot of struggle, a file called &lt;em&gt;“user.php”&lt;/em&gt; on level 12 which has a particular comment.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image25.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image27.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Which works perfectly, and we succeeded in listing the directory content.&lt;/p&gt;&lt;p&gt;The next step was to read the &lt;em&gt;secret4uou0.txt&lt;/em&gt; with the command &lt;code&gt;cat&lt;/code&gt; and we sent the payload with a different command &lt;code&gt;/bin/cat+secret4uou0.txt&lt;/code&gt; where we found the link for the next level.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image30.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;The starting point was the URL obtained from the previous level:&lt;/p&gt;&lt;p&gt;&lt;code&gt;http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx&lt;/code&gt;&lt;/p&gt;&lt;p&gt;At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as &lt;em&gt;admin:admin&lt;/em&gt; but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.&lt;/p&gt;&lt;p&gt;Only after few days later we had a class on SQL Injection then we tried to do so.&lt;/p&gt;&lt;p&gt;First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.&lt;/p&gt;&lt;p&gt;We checked all the forms by writing inside the “ ’ ” character to see if we would get any query error, and we found it on the page “new user” on the field “username”.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image32.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Since the class material was not published yet we used a friend presentation about the JSQL Injection from &lt;a href=&quot;https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image34.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;And saw where were the leaks:&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image36.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image19.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The schema found did not help us.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image20.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image21.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;The “users” table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image3.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Due to a bad query without the “WHERE” statement it shows all the columns on the database but luckily, we managed to find the interested columns.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;At this point we have all the necessary information to try to retrieve the credentials of the users.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image7.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image9.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;After reading their blogs we found the link of the next level on Tsutomu’s blog.&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image11.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/cyber/writeup/unictf/image13.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;</content>
      
        <category term="medium"/>
      
      
        <category term="ctf"/>
      
      
        <category term="web"/>
      
      
        <category term="security"/>
      
      
        <category term="sqli"/>
      
      
        <category term="shellshock"/>
      
      
        <category term="http header"/>
      
      
        <category term="code injection"/>
      
      
        <category term="bruteforcing"/>
      
      
        <category term="rot13"/>
      
      
        <category term="login panel"/>
      
      
      </item>
    
    
  </channel>
</rss>